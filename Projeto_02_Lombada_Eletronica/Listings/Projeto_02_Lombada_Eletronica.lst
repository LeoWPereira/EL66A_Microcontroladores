A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_02_Lombada_Eletronica.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_02_Lombada_Eletronica.a51 SET(SMALL) DEBUG PRINT(.\Listings\Pro
                      jeto_02_Lombada_Eletronica.lst) OBJECT(.\Objects\Projeto_02_Lombada_Eletronica.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

                      17     

                      18     

                      19     

                      20     

0000                  21     org 000h  

0000 020040           22     ljmp __STARTUP__

                      23     

0003                  24     org 003h  

0003 0201F2           25     ljmp INT_EXT0

                      26     

000B                  27     org 00Bh  

000B 020202           28     ljmp INT_TIMER0

                      29     

0013                  30     org 013h  

0013 020203           31     ljmp INT_EXT1

                      32     

001B                  33     org 01Bh  

001B 020204           34     ljmp INT_TIMER1

                      35     

0023                  36     org 023h  

0023 020239           37     ljmp INT_SERIAL

                      38     

                      39     

                      40     

                      41     

                      42     

  0080                43     PORT_DISPLAY                            EQU     P0

                      44     

  0090                45     DISPLAY_UNIDADE                         EQU P1.0

  0091                46     DISPLAY_DEZENA                          EQU P1.1

                      47     

  0096                48     PINO_LED_VERMELHO                       EQU P1.6

                      49             

  0097                50     BUZZER                                          EQU P1.7

                      51             

                      52     

  00B6                53     LED_SEG                                         EQU     P3.6

  00B7                54     LED1                                            EQU     P3.7

                      55             

  0000                56     PWM_FLAG                                        EQU 0    

                      57     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     2

  0031                58     PWM_DUTY_CYCLE                          EQU 31h  

                      59     

  0032                60     PWM_COUNTER                                     EQU 32h

                      61     

                      62     

  0033                63     PWM_PERIODO_LSB                         EQU 33h

  0034                64     PWM_PERIODO_MED                         EQU 34h 

  0035                65     PWM_PERIODO_MSB                         EQU 35h

                      66             

  0036                67     PWM_QTDADE_PERIODOS                     EQU 36h

                      68             

  0037                69     FLAG_MEDIR_DISTANCIA_INIT       EQU 37h

  0038                70     FLAG_CALCULAR_VELOCIDADE        EQU 38h   

                      71             

                      72     

  0039                73     VELOCIDADE_VEICULO_UNIDADE      EQU     39h

  0040                74     VELOCIDADE_VEICULO_DEZENA       EQU     40h

  0041                75     VELOCIDADE_VEICULO                      EQU 41h 

                      76     

  0042                77     VELOCIDADE_LIMITE                       EQU 42h  

                      78             

  0043                79     TIMER_MEDICOES_LOW                      EQU     43h

                      80     

                      81     

                      82     

  0044                83     TIMER_MEDICOES_LSB                      EQU     44h

  0045                84     TIMER_MEDICOES_MSB                      EQU     45h

                      85             

  0046                86     DISTANCIA_ANTERIOR                      EQU     46h

  0047                87     DISTANCIA_ATUAL                         EQU     47h

                      88             

                      89     

                      90     

                      91     

                      92     

0030                  93     org 030h

0030                  94     TAB7SEG:

0030 3F065B4F         95             DB 3FH, 06H, 5BH, 4FH, 66H, 6DH, 7DH, 07H, 7FH, 6FH, 77H, 7CH, 39H, 5EH, 79H, 71H

0034 666D7D07                
0038 7F6F777C                
003C 395E7971                
                      96     

                      97     

                      98     

                      99     

                     100     

0040                 101     __STARTUP__:

0040 120073          102                     LCALL   SETA_VARIAVEIS_INICIAIS

0043 1201E3          103                     LCALL   INT_CONFIGURA_INTERRUPCOES

                     104                     

0046                 105     ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT:

0046 E537            106                     MOV             A, FLAG_MEDIR_DISTANCIA_INIT

0048 B401FB          107                     CJNE    A, #01h, ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT

                     108                     

004B 7946            109                     MOV             R1, #DISTANCIA_ANTERIOR

004D 12009A          110                     LCALL   MEDIR_DISTANCIA

                     111                     

                     112                     

0050 120122          113                     LCALL   TIMER_CONFIGURA_TIMER

0053 1201E3          114                     LCALL   INT_CONFIGURA_INTERRUPCOES

0056 12008D          115                     LCALL   RESETA_TIMER_MEDICOES

                     116                     

0059 D28E            117                     SETB    TR1

                     118                     

005B                 119     ESPERA_FLAG_MEDIR_DISTANCIA_2:

005B E538            120                     MOV             A, FLAG_CALCULAR_VELOCIDADE

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     3

005D B401FB          121                     CJNE    A, #01h, ESPERA_FLAG_MEDIR_DISTANCIA_2

                     122                     

0060 7947            123                     MOV             R1, #DISTANCIA_ATUAL

0062 12009A          124                     LCALL   MEDIR_DISTANCIA

                     125                     

                     126                     

0065 120122          127                     LCALL   TIMER_CONFIGURA_TIMER

0068 1201E3          128                     LCALL   INT_CONFIGURA_INTERRUPCOES

006B 12008D          129                     LCALL   RESETA_TIMER_MEDICOES

                     130                     

006E 1200C8          131                     LCALL   CALCULA_VELOCIDADE

                     132                     

0071 0140            133                     AJMP    __STARTUP__

                     134     

                     135     

                     136     

                     137     

                     138     

                     139     

                     140     

                     141     

0073                 142     SETA_VARIAVEIS_INICIAIS:

0073 D296            143                     SETB    PINO_LED_VERMELHO

0075 D297            144                     SETB    BUZZER

                     145                     

0077 75420A          146                     MOV             VELOCIDADE_LIMITE,                      #010d    

007A 753700          147                     MOV             FLAG_MEDIR_DISTANCIA_INIT,      #00h 

007D 753800          148                     MOV             FLAG_CALCULAR_VELOCIDADE,       #00h

0080 753900          149                     MOV             VELOCIDADE_VEICULO_UNIDADE, #00h

0083 754000          150                     MOV             VELOCIDADE_VEICULO_DEZENA,      #00h

0086 754600          151                     MOV             DISTANCIA_ANTERIOR,             #00h                    

0089 754700          152                     MOV             DISTANCIA_ATUAL,                        #00h               
                                          

                     153                     

008C 22              154                     RET

                     155                     

                     156     

                     157     

                     158     

                     159     

                     160     

                     161     

                     162     

008D                 163     RESETA_TIMER_MEDICOES:

008D 754300          164                     MOV             TIMER_MEDICOES_LOW,     #00h

0090 754400          165                     MOV             TIMER_MEDICOES_LSB,     #00h

0093 754500          166                     MOV             TIMER_MEDICOES_MSB,     #00h

                     167                     

0096 754100          168                     MOV             VELOCIDADE_VEICULO,     #00h

                     169                     

0099 22              170                     RET     

                     171                     

                     172     

                     173     

                     174     

                     175     

                     176     

                     177     

                     178     

009A                 179     MEDIR_DISTANCIA:

                     180                     

                     181     

009A C290            182                     CLR             DISPLAY_UNIDADE 

009C C291            183                     CLR     DISPLAY_DEZENA

                     184                     

009E 758000          185                     MOV     PORT_DISPLAY, #00h

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     4

                     186                     

00A1 C2B0            187                     CLR     P3.0                

00A3 D2B1            188                     SETB    P3.1               

                     189     

00A5 758920          190                     MOV     TMOD,#00100000B     

00A8 758B82          191                     MOV     TL1,#130D     

00AB 758D82          192                     MOV     TH1,#130D     

                     193                     

00AE 7400            194                     MOV     A,#00h  

                     195                     

00B0 D2B0            196                     SETB    P3.0         

                     197                     

00B2 3153            198                     ACALL   TIMER_DELAY_10_US      

                     199                     

00B4 C2B0            200                     CLR     P3.0          

                     201     

00B6                 202     HERE:   

00B6 30B1FD          203                     JNB     P3.1,HERE     

00B9                 204     BACK:   

00B9 D28E            205                     SETB    TR1          

00BB                 206     HERE1: 

00BB 308FFD          207                     JNB     TF1,HERE1    

                     208           

00BE C28E            209                     CLR     TR1           

00C0 C28F            210                     CLR     TF1           

                     211           

00C2 04              212                     INC     A             

                     213           

00C3 20B1F3          214                     JB              P3.1,BACK      

                     215           

00C6 F7              216                     MOV     @R1, A          

                     217               

00C7 22              218                     RET

                     219     

                     220     

                     221     

                     222     

                     223     

                     224     

                     225     

                     226     

00C8                 227     CALCULA_VELOCIDADE:

00C8 C3              228                     CLR             C  

                     229                     

00C9 E546            230                     MOV     A, DISTANCIA_ANTERIOR

00CB 8547F0          231                     MOV             B, DISTANCIA_ATUAL

                     232                     

00CE 95F0            233                     SUBB    A, B

                     234     

00D0 5008            235                     JNC             DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL      

                     236                     

00D2                 237     DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR:

00D2 E547            238                     MOV     A, DISTANCIA_ATUAL

00D4 9546            239                     SUBB    A, DISTANCIA_ANTERIOR

                     240                     

00D6 F541            241                     MOV             VELOCIDADE_VEICULO, A

                     242                     

00D8 8006            243                     JMP             DLOOP

                     244     

00DA                 245     DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL:

00DA E546            246                     MOV     A, DISTANCIA_ANTERIOR

00DC 9547            247                     SUBB    A, DISTANCIA_ATUAL

                     248                     

00DE F541            249                     MOV             VELOCIDADE_VEICULO, A

                     250                     

00E0                 251     DLOOP: 

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     5

                     252                

                     253                

                     254                

00E0 74FF            255                MOV          A, #0FFh

00E2 9542            256                SUBB         A, VELOCIDADE_LIMITE

                     257                     

00E4 3541            258                ADDC         A, VELOCIDADE_VEICULO

                     259                     

00E6 4027            260                JC           ACIMA_DO_LIMITE

                     261     

00E8                 262     CONTINUA_DLOOP:

00E8 7D64            263                     MOV     R5,#100D     

00EA 7E0F            264                     MOV             R6,#15D

00EC                 265     BACK1: 

00EC E541            266                     MOV     A,VELOCIDADE_VEICULO         

00EE 75F00A          267                     MOV     B,#10D      

                     268            

00F1 84              269                     DIV     AB           

                     270            

00F2 D290            271                     SETB    DISPLAY_UNIDADE        

00F4 311A            272            ACALL MOSTRA_VELOCIDADE_DISPLAY    

                     273                

00F6 3158            274                ACALL        TIMER_DELAY_1_MS     

                     275            

00F8 E5F0            276                MOV A,B          

00FA C290            277            CLR DISPLAY_UNIDADE         

00FC D291            278            SETB DISPLAY_DEZENA        

00FE 311A            279            ACALL MOSTRA_VELOCIDADE_DISPLAY

                     280            

0100 3158            281                ACALL        TIMER_DELAY_1_MS 

                     282            

0102 C291            283                CLR DISPLAY_DEZENA        

                     284                

0104 DEE6            285                DJNZ R6,BACK1

0106 7E15            286                MOV  R6,#15h

0108 DDE2            287            DJNZ R5,BACK1   

                     288                

010A D296            289                SETB         PINO_LED_VERMELHO

010C D297            290                SETB         BUZZER

                     291                

010E 22              292            RET

                     293     

010F                 294     ACIMA_DO_LIMITE:

010F 120115          295                     LCALL   VELOCIDADE_ACIMA_DO_LIMITE

                     296                     

0112 80D4            297                     JMP             CONTINUA_DLOOP

                     298                     

0114 22              299                     RET     

                     300     

                     301     

                     302     

                     303     

                     304     

                     305     

                     306     

                     307     

                     308     

0115                 309     VELOCIDADE_ACIMA_DO_LIMITE:

0115 C296            310                     CLR             PINO_LED_VERMELHO

0117 C297            311                     CLR             BUZZER

                     312     

                     313                     

                     314     

                     315     

                     316     

                     317     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     6

                     318     

                     319     

                     320     

                     321     

                     322     

                     323     

                     324     

                     325                     

0119 22              326                     RET

                     327     

                     328     

                     329     

                     330     

                     331     

                     332     

                     333     

                     334     

011A                 335     MOSTRA_VELOCIDADE_DISPLAY:

011A 900030          336                     MOV     DPTR, #TAB7SEG   

                     337                     

011D 93              338                     MOVC    A, @A + DPTR     

011E F4              339             CPL     A                

011F F580            340                     MOV     PORT_DISPLAY, A  

                     341                     

0121 22              342                     RET

                     343     

                     344     

                     345     

                     346     

                     347     

                     348     

                     349     

                     350     

                     351     

                     352     

                     353     

                     354     

0122                 355     TIMER_CONFIGURA_TIMER:

0122 758922          356                     MOV     TMOD, #00100010b  

                     357                     

0125 312E            358                     ACALL   TIMER_SETA_VALORES_TIMER_PADRAO

                     359                     

                     360                     

                     361                     

                     362                     

                     363                     

                     364                     

                     365                     

0127 758DFF          366                     MOV     TH1, #0FFh

012A 758B7A          367                     MOV             TL1, #122d

                     368                                     

012D 22              369                     RET

                     370                     

                     371     

                     372     

                     373     

                     374     

                     375     

                     376     

                     377     

012E                 378     TIMER_SETA_VALORES_TIMER_PADRAO:

                     379                     

                     380                     

012E 758CCF          381                     MOV     TH0, #207d

0131 758ACF          382                     MOV     TL0, #207d

                     383                                     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     7

0134 22              384                     RET

                     385                     

                     386     

                     387     

                     388     

                     389     

                     390     

                     391     

                     392     

0135                 393     TIMER_DELAY_20_MS:

0135 758901          394                     MOV     TMOD, #00000001b  

                     395                     

                     396                     

0138 758C56          397                     MOV     TH0, #HIGH(65535 - 43350)

013B 758AA9          398                     MOV     TL0, #LOW(65535 - 43350)

                     399     

013E C28D            400                     CLR     TF0

0140 D28C            401                     SETB    TR0

                     402             

0142 308DFD          403                     JNB     TF0, $

                     404                     

0145 C28D            405                     CLR     TF0

0147 C28C            406                     CLR     TR0

                     407             

0149 D8EA            408                     DJNZ R0, TIMER_DELAY_20_MS

                     409             

014B 22              410                     RET

                     411             

                     412     

                     413     

                     414     

                     415     

                     416     

                     417     

                     418     

014C                 419     TIMER_DELAY_1_S:

014C 7832            420                     MOV             R0, #50d

014E 3135            421                     CALL    TIMER_DELAY_20_MS

                     422                     

0150 D9FA            423                     DJNZ    R1, TIMER_DELAY_1_S

                     424             

0152 22              425                     RET

                     426     

                     427     

                     428     

                     429     

                     430     

                     431     

                     432     

                     433     

0153                 434     TIMER_DELAY_10_US: 

0153 7E02            435                     MOV     R6, #2D     

0155 DEFE            436                     DJNZ    R6, $

                     437                     

0157 22              438                     RET

                     439     

                     440     

                     441     

                     442     

                     443     

                     444     

                     445     

                     446     

0158                 447     TIMER_DELAY_1_MS: 

0158 7FFA            448                     MOV     R7, #250d        

015A DFFE            449                     DJNZ    R7, $

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     8

                     450             

015C 22              451                     RET

                     452                     

                     453     

                     454     

                     455     

                     456     

                     457     

                     458     

                     459     

                     460     

                     461     

                     462     

                     463     

                     464     

                     465     

                     466     

                     467     

                     468     

                     469     

                     470     

015D                 471     PWM_SQUARE_WAVE_SETUP_AND_START:

015D 8931            472                     MOV     PWM_DUTY_CYCLE, R1

                     473             

015F 120173          474                     LCALL   PWM_SQUARE_WAVE_CONFIG_PERIOD

                     475             

0162 D28C            476                     SETB    TR0

                     477     

0164                 478     CONTINUA_PWM:

0164 12018B          479                     LCALL   PWM_SQUARE_WAVE

                     480                     

0167 E532            481                     MOV     A, PWM_COUNTER

0169 B536F8          482                     CJNE    A, PWM_QTDADE_PERIODOS, CONTINUA_PWM

                     483     

016C                 484     PWM_PARAR:

016C 120188          485                     LCALL   PWM_STOP

                     486                     

016F 753200          487                     MOV             PWM_COUNTER, #00h

                     488                     

0172 22              489                     RET

                     490     

                     491     

                     492     

                     493     

                     494     

                     495     

                     496     

                     497     

                     498     

                     499     

                     500     

0173                 501     PWM_SQUARE_WAVE_CONFIG_PERIOD:

0173 8A35            502                     MOV             PWM_PERIODO_MSB, R2

0175 8B34            503                     MOV             PWM_PERIODO_MED, R3

0177 8C33            504                     MOV             PWM_PERIODO_LSB, R4

                     505                     

                     506                     

                     507                     

0179 E8              508                     MOV             A, R0

017A 28              509                     ADD             A, R0

017B F536            510                     MOV             PWM_QTDADE_PERIODOS, A

                     511                     

017D AE34            512                     MOV             R6, PWM_PERIODO_MED

017F AF35            513                     MOV             R7, PWM_PERIODO_MSB

                     514                     

0181 758CFF          515                     MOV     TH0, #0FFh

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE     9

0184 85338A          516                     MOV             TL0, PWM_PERIODO_LSB

                     517                     

0187 22              518                     RET

                     519     

                     520     

                     521     

                     522     

                     523     

                     524     

                     525     

                     526     

0188                 527     PWM_STOP:

0188 C28C            528                     CLR     TR0

                     529                     

018A 22              530                     RET

                     531             

                     532     

                     533     

                     534     

                     535     

                     536     

                     537     

                     538     

                     539     

                     540     

                     541     

018B                 542     PWM_SQUARE_WAVE:        

018B 308DFD          543                     JNB     TF0, $

                     544             

018E DE2B            545                     DJNZ    R6, CONTINUE_SQUARE

0190 AE34            546                     MOV             R6, PWM_PERIODO_MED

                     547                     

0192 DF27            548                     DJNZ    R7, CONTINUE_SQUARE

0194 AF35            549                     MOV             R7, PWM_PERIODO_MSB     

                     550     

                     551                     

0196 0532            552                     INC             PWM_COUNTER

                     553     

0198 20000E          554                     JB              PWM_FLAG, HIGH_DONE

                     555             

019B                 556     LOW_DONE:                       

019B D200            557                     SETB    PWM_FLAG

                     558                     

019D 1201D4          559                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     560                     

01A0 758CFF          561                     MOV             TH0, #0FFh

01A3 85318A          562                     MOV     TL0, PWM_DUTY_CYCLE             

                     563                     

01A6 C28D            564                     CLR     TF0

                     565                     

01A8 22              566                     RET

                     567                                     

01A9                 568     HIGH_DONE:

01A9 C200            569                     CLR     PWM_FLAG                         

                     570                             

01AB 1201D4          571                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     572                     

01AE 74FF            573                     MOV     A, #0FFh                 

01B0 C3              574                     CLR             C

01B1 9531            575                     SUBB    A, PWM_DUTY_CYCLE

                     576                     

01B3 758CFF          577                     MOV     TH0, #0FFh                       

01B6 F58A            578                     MOV             TL0, A

                     579                     

01B8 C28D            580                     CLR     TF0                                      

                     581                     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE    10

01BA 22              582                     RET

                     583     

01BB                 584     CONTINUE_SQUARE:

01BB 30000D          585                     JNB             PWM_FLAG, CONTINUE_SQUARE_LOW

                     586             

01BE                 587     CONTINUE_SQUARE_HIGH:

01BE 74FF            588                     MOV     A, #0FFh                 

01C0 C3              589                     CLR             C

01C1 9531            590                     SUBB    A, PWM_DUTY_CYCLE

                     591                     

01C3 758CFF          592                     MOV     TH0, #0FFh                       

01C6 F58A            593                     MOV             TL0, A

                     594                     

01C8 C28D            595                     CLR     TF0

                     596     

01CA 22              597                     RET

                     598                     

01CB                 599     CONTINUE_SQUARE_LOW:

01CB 758CFF          600                     MOV             TH0, #0FFh

01CE 85318A          601                     MOV     TL0, PWM_DUTY_CYCLE

                     602                     

01D1 C28D            603                     CLR     TF0

                     604                     

01D3 22              605                     RET

                     606     

                     607     

                     608     

                     609     

                     610     

                     611     

                     612     

                     613     

                     614     

                     615     

01D4                 616     DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS:

01D4 7401            617                     MOV             A, #01h

01D6 5D              618                     ANL             A, R5

01D7 6002            619                     JZ              NAO_ATIVA_BIT_0

                     620                     

01D9 B296            621                     CPL     PINO_LED_VERMELHO

                     622                     

01DB                 623     NAO_ATIVA_BIT_0:

01DB 7402            624                     MOV             A, #02h

01DD 5D              625                     ANL             A, R5

01DE 6002            626                     JZ              NAO_ATIVA_BIT_1

                     627                     

01E0 B297            628                     CPL     BUZZER

                     629     

01E2                 630     NAO_ATIVA_BIT_1:

01E2 22              631                     RET

                     632     

                     633     

                     634     

                     635     

                     636     

                     637     

                     638     

                     639     

                     640     

                     641     

                     642     

                     643     

                     644     

01E3                 645     INT_CONFIGURA_INTERRUPCOES:

                     646                     

01E3 D2AF            647                     SETB    EA

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE    11

01E5 D2A8            648                     SETB    EX0

01E7 D2AB            649                     SETB    ET1

                     650                     

                     651                     

01E9 C2B8            652                     CLR             PX0              

01EB D2BB            653                     SETB    PT1              

                     654                     

                     655                     

01ED C289            656                     CLR             IE0              

01EF C28A            657                     CLR             IT1              

                     658                     

01F1 22              659                     RET

                     660     

                     661     

                     662     

                     663     

                     664     

                     665     

                     666     

                     667     

01F2                 668     INT_EXT0:

01F2 C0E0            669                     PUSH    ACC

01F4 C0D0            670                     PUSH    PSW

                     671                     

01F6 753701          672                     MOV             FLAG_MEDIR_DISTANCIA_INIT, #01h

                     673                     

01F9 7805            674                     MOV     R0, #05h                 

01FB 3135            675                     ACALL   TIMER_DELAY_20_MS

                     676                     

01FD D0D0            677                     POP             PSW

01FF D0E0            678                     POP             ACC

                     679                     

0201 32              680                     RETI

                     681     

                     682     

                     683     

                     684     

                     685     

                     686     

                     687     

                     688     

0202                 689     INT_TIMER0:

0202 32              690                     RETI

                     691             

                     692     

                     693     

                     694     

                     695     

                     696     

                     697     

                     698     

0203                 699     INT_EXT1:

0203 32              700                     RETI

                     701     

                     702     

                     703     

                     704     

                     705     

                     706     

                     707     

                     708     

                     709     

                     710     

                     711     

0204                 712     INT_TIMER1:

0204 C0E0            713                     PUSH    ACC

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE    12

0206 C0D0            714                     PUSH    PSW

                     715                     

0208 758B7A          716                     MOV             TL1, #122d

020B C28F            717                     CLR             TF1

                     718                     

020D E543            719                     MOV             A, TIMER_MEDICOES_LOW

020F B41419          720                     CJNE    A, #020d, INCREMENTA_TIMER_MEDICOES_LOW       

                     721             

0212 E544            722                     MOV             A, TIMER_MEDICOES_LSB

0214 B4FA18          723                     CJNE    A, #0250d, INCREMENTA_TIMER_MEDICOES_LSB         

                     724                     

0217 754300          725                     MOV             TIMER_MEDICOES_LOW, #00h

021A 754400          726                     MOV             TIMER_MEDICOES_LSB, #00h

021D 0545            727                     INC             TIMER_MEDICOES_MSB

                     728                     

021F E545            729                     MOV             A, TIMER_MEDICOES_MSB

0221 B40210          730                     CJNE    A, #02d, FINALIZA_TIMER_1        

                     731                     

0224 C28E            732                     CLR             TR1

0226 753801          733                     MOV             FLAG_CALCULAR_VELOCIDADE, #01h

0229 4134            734                     AJMP    FINALIZA_TIMER_1

                     735             

022B                 736     INCREMENTA_TIMER_MEDICOES_LOW:

022B 0543            737                     INC             TIMER_MEDICOES_LOW

022D 4134            738                     AJMP    FINALIZA_TIMER_1

                     739                     

022F                 740     INCREMENTA_TIMER_MEDICOES_LSB:

022F 754300          741                     MOV             TIMER_MEDICOES_LOW, #00h

0232 0544            742                     INC             TIMER_MEDICOES_LSB

                     743     

0234                 744     FINALIZA_TIMER_1:

0234 D0D0            745                     POP             PSW

0236 D0E0            746                     POP             ACC

                     747                     

0238 32              748                     RETI

                     749             

                     750     

                     751     

                     752     

                     753     

                     754     

                     755     

                     756     

0239                 757     INT_SERIAL:

0239 32              758                     RETI

                     759             

023A                 760     FIM:

023A 80FE            761                     JMP $

                     762                     END

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE    13

SYMBOL TABLE LISTING
------ ----- -------


N A M E                                    T Y P E  V A L U E   ATTRIBUTES

ACC . . . . . . . . . . . . . . . . . .    D ADDR   00E0H   A   
ACIMA_DO_LIMITE . . . . . . . . . . . .    C ADDR   010FH   A   
B . . . . . . . . . . . . . . . . . . .    D ADDR   00F0H   A   
BACK. . . . . . . . . . . . . . . . . .    C ADDR   00B9H   A   
BACK1 . . . . . . . . . . . . . . . . .    C ADDR   00ECH   A   
BUZZER. . . . . . . . . . . . . . . . .    B ADDR   0090H.7 A   
CALCULA_VELOCIDADE. . . . . . . . . . .    C ADDR   00C8H   A   
CONTINUA_DLOOP. . . . . . . . . . . . .    C ADDR   00E8H   A   
CONTINUA_PWM. . . . . . . . . . . . . .    C ADDR   0164H   A   
CONTINUE_SQUARE . . . . . . . . . . . .    C ADDR   01BBH   A   
CONTINUE_SQUARE_HIGH. . . . . . . . . .    C ADDR   01BEH   A   
CONTINUE_SQUARE_LOW . . . . . . . . . .    C ADDR   01CBH   A   
DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS  C ADDR   01D4H   A   
DISPLAY_DEZENA. . . . . . . . . . . . .    B ADDR   0090H.1 A   
DISPLAY_UNIDADE . . . . . . . . . . . .    B ADDR   0090H.0 A   
DISTANCIA_ANTERIOR. . . . . . . . . . .    N NUMB   0046H   A   
DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL. . .    C ADDR   00DAH   A   
DISTANCIA_ATUAL . . . . . . . . . . . .    N NUMB   0047H   A   
DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR. . .    C ADDR   00D2H   A   
DLOOP . . . . . . . . . . . . . . . . .    C ADDR   00E0H   A   
EA. . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.7 A   
ESPERA_FLAG_MEDIR_DISTANCIA_2 . . . . .    C ADDR   005BH   A   
ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT.    C ADDR   0046H   A   
ET1 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.3 A   
EX0 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.0 A   
FIM . . . . . . . . . . . . . . . . . .    C ADDR   023AH   A   
FINALIZA_TIMER_1. . . . . . . . . . . .    C ADDR   0234H   A   
FLAG_CALCULAR_VELOCIDADE. . . . . . . .    N NUMB   0038H   A   
FLAG_MEDIR_DISTANCIA_INIT . . . . . . .    N NUMB   0037H   A   
HERE. . . . . . . . . . . . . . . . . .    C ADDR   00B6H   A   
HERE1 . . . . . . . . . . . . . . . . .    C ADDR   00BBH   A   
HIGH_DONE . . . . . . . . . . . . . . .    C ADDR   01A9H   A   
IE0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.1 A   
INCREMENTA_TIMER_MEDICOES_LOW . . . . .    C ADDR   022BH   A   
INCREMENTA_TIMER_MEDICOES_LSB . . . . .    C ADDR   022FH   A   
INT_CONFIGURA_INTERRUPCOES. . . . . . .    C ADDR   01E3H   A   
INT_EXT0. . . . . . . . . . . . . . . .    C ADDR   01F2H   A   
INT_EXT1. . . . . . . . . . . . . . . .    C ADDR   0203H   A   
INT_SERIAL. . . . . . . . . . . . . . .    C ADDR   0239H   A   
INT_TIMER0. . . . . . . . . . . . . . .    C ADDR   0202H   A   
INT_TIMER1. . . . . . . . . . . . . . .    C ADDR   0204H   A   
IT1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.2 A   
LED1. . . . . . . . . . . . . . . . . .    B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . . . . .    B ADDR   00B0H.6 A   
LOW_DONE. . . . . . . . . . . . . . . .    C ADDR   019BH   A   
MEDIR_DISTANCIA . . . . . . . . . . . .    C ADDR   009AH   A   
MOSTRA_VELOCIDADE_DISPLAY . . . . . . .    C ADDR   011AH   A   
NAO_ATIVA_BIT_0 . . . . . . . . . . . .    C ADDR   01DBH   A   
NAO_ATIVA_BIT_1 . . . . . . . . . . . .    C ADDR   01E2H   A   
P0. . . . . . . . . . . . . . . . . . .    D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . . . . .    D ADDR   0090H   A   
P3. . . . . . . . . . . . . . . . . . .    D ADDR   00B0H   A   
PINO_LED_VERMELHO . . . . . . . . . . .    B ADDR   0090H.6 A   
PORT_DISPLAY. . . . . . . . . . . . . .    D ADDR   0080H   A   
PSW . . . . . . . . . . . . . . . . . .    D ADDR   00D0H   A   
PT1 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.3 A   
PWM_COUNTER . . . . . . . . . . . . . .    N NUMB   0032H   A   
PWM_DUTY_CYCLE. . . . . . . . . . . . .    N NUMB   0031H   A   
PWM_FLAG. . . . . . . . . . . . . . . .    N NUMB   0000H   A   
PWM_PARAR . . . . . . . . . . . . . . .    C ADDR   016CH   A   
A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 19:28:04 PAGE    14

PWM_PERIODO_LSB . . . . . . . . . . . .    N NUMB   0033H   A   
PWM_PERIODO_MED . . . . . . . . . . . .    N NUMB   0034H   A   
PWM_PERIODO_MSB . . . . . . . . . . . .    N NUMB   0035H   A   
PWM_QTDADE_PERIODOS . . . . . . . . . .    N NUMB   0036H   A   
PWM_SQUARE_WAVE . . . . . . . . . . . .    C ADDR   018BH   A   
PWM_SQUARE_WAVE_CONFIG_PERIOD . . . . .    C ADDR   0173H   A   
PWM_SQUARE_WAVE_SETUP_AND_START . . . .    C ADDR   015DH   A   
PWM_STOP. . . . . . . . . . . . . . . .    C ADDR   0188H   A   
PX0 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.0 A   
RESETA_TIMER_MEDICOES . . . . . . . . .    C ADDR   008DH   A   
SETA_VARIAVEIS_INICIAIS . . . . . . . .    C ADDR   0073H   A   
TAB7SEG . . . . . . . . . . . . . . . .    C ADDR   0030H   A   
TF0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.5 A   
TF1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.7 A   
TH0 . . . . . . . . . . . . . . . . . .    D ADDR   008CH   A   
TH1 . . . . . . . . . . . . . . . . . .    D ADDR   008DH   A   
TIMER_CONFIGURA_TIMER . . . . . . . . .    C ADDR   0122H   A   
TIMER_DELAY_10_US . . . . . . . . . . .    C ADDR   0153H   A   
TIMER_DELAY_1_MS. . . . . . . . . . . .    C ADDR   0158H   A   
TIMER_DELAY_1_S . . . . . . . . . . . .    C ADDR   014CH   A   
TIMER_DELAY_20_MS . . . . . . . . . . .    C ADDR   0135H   A   
TIMER_MEDICOES_LOW. . . . . . . . . . .    N NUMB   0043H   A   
TIMER_MEDICOES_LSB. . . . . . . . . . .    N NUMB   0044H   A   
TIMER_MEDICOES_MSB. . . . . . . . . . .    N NUMB   0045H   A   
TIMER_SETA_VALORES_TIMER_PADRAO . . . .    C ADDR   012EH   A   
TL0 . . . . . . . . . . . . . . . . . .    D ADDR   008AH   A   
TL1 . . . . . . . . . . . . . . . . . .    D ADDR   008BH   A   
TMOD. . . . . . . . . . . . . . . . . .    D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.4 A   
TR1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.6 A   
VELOCIDADE_ACIMA_DO_LIMITE. . . . . . .    C ADDR   0115H   A   
VELOCIDADE_LIMITE . . . . . . . . . . .    N NUMB   0042H   A   
VELOCIDADE_VEICULO. . . . . . . . . . .    N NUMB   0041H   A   
VELOCIDADE_VEICULO_DEZENA . . . . . . .    N NUMB   0040H   A   
VELOCIDADE_VEICULO_UNIDADE. . . . . . .    N NUMB   0039H   A   
__STARTUP__ . . . . . . . . . . . . . .    C ADDR   0040H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
