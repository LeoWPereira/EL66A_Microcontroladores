A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_02_Lombada_Eletronica.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_02_Lombada_Eletronica.a51 SET(SMALL) DEBUG PRINT(.\Listings\Pro
                      jeto_02_Lombada_Eletronica.lst) OBJECT(.\Objects\Projeto_02_Lombada_Eletronica.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

                      17     

                      18     

                      19     

                      20     

0000                  21     org 000h  

0000 020040           22     ljmp __STARTUP__

                      23     

0003                  24     org 003h  

0003 0201F9           25     ljmp INT_EXT0

                      26     

000B                  27     org 00Bh  

000B 020209           28     ljmp INT_TIMER0

                      29     

0013                  30     org 013h  

0013 02020A           31     ljmp INT_EXT1

                      32     

001B                  33     org 01Bh  

001B 02020B           34     ljmp INT_TIMER1

                      35     

0023                  36     org 023h  

0023 020240           37     ljmp INT_SERIAL

                      38     

                      39     

                      40     

                      41     

                      42     

  0096                43     PINO_LED_VERMELHO                       EQU P1.6

                      44             

  0097                45     BUZZER                                          EQU P1.7

                      46             

                      47     

  00B6                48     LED_SEG                                         EQU     P3.6

  00B7                49     LED1                                            EQU     P3.7

                      50             

  0000                51     PWM_FLAG                                        EQU 0    

                      52     

  0031                53     PWM_DUTY_CYCLE                          EQU 31h  

                      54     

  0032                55     PWM_COUNTER                                     EQU 32h

                      56     

                      57     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     2

  0033                58     PWM_PERIODO_LSB                         EQU 33h

  0034                59     PWM_PERIODO_MED                         EQU 34h 

  0035                60     PWM_PERIODO_MSB                         EQU 35h

                      61             

  0036                62     PWM_QTDADE_PERIODOS                     EQU 36h

                      63             

  0037                64     FLAG_MEDIR_DISTANCIA_INIT       EQU 37h

  0038                65     FLAG_CALCULAR_VELOCIDADE        EQU 38h   

                      66             

                      67     

  0039                68     VELOCIDADE_VEICULO_UNIDADE      EQU     39h

  0040                69     VELOCIDADE_VEICULO_DEZENA       EQU     40h

  0041                70     VELOCIDADE_VEICULO                      EQU 41h 

                      71     

  0042                72     VELOCIDADE_LIMITE                       EQU 42h  

                      73             

  0043                74     TIMER_MEDICOES_LOW                      EQU     43h

                      75     

                      76     

                      77     

  0044                78     TIMER_MEDICOES_LSB                      EQU     44h

  0045                79     TIMER_MEDICOES_MSB                      EQU     45h

                      80             

  0046                81     DISTANCIA_ANTERIOR                      EQU     46h

  0047                82     DISTANCIA_ATUAL                         EQU     47h

                      83             

                      84     

                      85     

                      86     

                      87     

0030                  88     org 030h

0030                  89     TAB7SEG:

0030 3F065B4F         90             DB 3FH, 06H, 5BH, 4FH, 66H, 6DH, 7DH, 07H, 7FH, 6FH, 77H, 7CH, 39H, 5EH, 79H, 71H

0034 666D7D07                
0038 7F6F777C                
003C 395E7971                
                      91     

                      92     

                      93     

                      94     

                      95     

0040                  96     __STARTUP__:

0040 120073           97                     LCALL   SETA_VARIAVEIS_INICIAIS

0043 1201EA           98                     LCALL   INT_CONFIGURA_INTERRUPCOES

                      99                     

0046                 100     ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT:

0046 E537            101                     MOV             A, FLAG_MEDIR_DISTANCIA_INIT

0048 B401FB          102                     CJNE    A, #01h, ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT

                     103                     

004B 7946            104                     MOV             R1, #DISTANCIA_ANTERIOR

004D 12009A          105                     LCALL   MEDIR_DISTANCIA

                     106                     

                     107                     

0050 120133          108                     LCALL   TIMER_CONFIGURA_TIMER

0053 1201EA          109                     LCALL   INT_CONFIGURA_INTERRUPCOES

0056 12008D          110                     LCALL   RESETA_TIMER_MEDICOES

                     111                     

0059 D28E            112                     SETB    TR1

                     113                     

005B                 114     ESPERA_FLAG_MEDIR_DISTANCIA_2:

005B E538            115                     MOV             A, FLAG_CALCULAR_VELOCIDADE

005D B401FB          116                     CJNE    A, #01h, ESPERA_FLAG_MEDIR_DISTANCIA_2

                     117                     

0060 7947            118                     MOV             R1, #DISTANCIA_ATUAL

0062 12009A          119                     LCALL   MEDIR_DISTANCIA

                     120                     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     3

                     121                     

0065 120133          122                     LCALL   TIMER_CONFIGURA_TIMER

0068 1201EA          123                     LCALL   INT_CONFIGURA_INTERRUPCOES

006B 12008D          124                     LCALL   RESETA_TIMER_MEDICOES

                     125                     

006E 1200D5          126                     LCALL   CALCULA_VELOCIDADE

                     127                     

0071 0140            128                     AJMP    __STARTUP__

                     129     

                     130     

                     131     

                     132     

                     133     

                     134     

                     135     

                     136     

0073                 137     SETA_VARIAVEIS_INICIAIS:

0073 D296            138                     SETB    PINO_LED_VERMELHO

0075 D297            139                     SETB    BUZZER

                     140                     

0077 75420A          141                     MOV             VELOCIDADE_LIMITE,                      #010d    

007A 753700          142                     MOV             FLAG_MEDIR_DISTANCIA_INIT,      #00h 

007D 753800          143                     MOV             FLAG_CALCULAR_VELOCIDADE,       #00h

0080 753900          144                     MOV             VELOCIDADE_VEICULO_UNIDADE, #00h

0083 754000          145                     MOV             VELOCIDADE_VEICULO_DEZENA,      #00h

0086 754600          146                     MOV             DISTANCIA_ANTERIOR,             #00h                    

0089 754700          147                     MOV             DISTANCIA_ATUAL,                        #00h               
                                          

                     148                     

008C 22              149                     RET

                     150                     

                     151     

                     152     

                     153     

                     154     

                     155     

                     156     

                     157     

008D                 158     RESETA_TIMER_MEDICOES:

008D 754300          159                     MOV             TIMER_MEDICOES_LOW,     #00h

0090 754400          160                     MOV             TIMER_MEDICOES_LSB,     #00h

0093 754500          161                     MOV             TIMER_MEDICOES_MSB,     #00h

                     162                     

0096 754100          163                     MOV             VELOCIDADE_VEICULO,     #00h

                     164                     

0099 22              165                     RET     

                     166                     

                     167     

                     168     

                     169     

                     170     

                     171     

                     172     

                     173     

009A                 174     MEDIR_DISTANCIA:

009A C2AB            175                     CLR             ET1

                     176     

009C 900030          177                     MOV     DPTR,#TAB7SEG           

                     178                     

009F 7590C0          179                     MOV     P1,#11000000b       

00A2 758000          180                     MOV     P0,#00h       

                     181                     

00A5 C2B0            182                     CLR     P3.0                

00A7 D2B1            183                     SETB    P3.1               

                     184     

00A9 758920          185                     MOV     TMOD,#00100000B     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     4

00AC 758B82          186                     MOV     TL1,#130D     

00AF 758D82          187                     MOV     TH1,#130D     

                     188                     

00B2 7400            189                     MOV     A,#00h  

                     190                     

00B4 D2B0            191                     SETB    P3.0         

                     192                     

00B6 11CC            193                     ACALL   DELAY1      

                     194                     

00B8 C2B0            195                     CLR     P3.0          

                     196     

00BA                 197     HERE:   

00BA 30B1FD          198                     JNB     P3.1,HERE     

00BD                 199     BACK:   

00BD D28E            200                     SETB    TR1          

00BF                 201     HERE1: 

00BF 308FFD          202                     JNB     TF1,HERE1    

                     203           

00C2 C28E            204                     CLR     TR1           

00C4 C28F            205                     CLR     TF1           

                     206           

00C6 04              207                     INC     A             

                     208           

00C7 20B1F3          209                     JB              P3.1,BACK      

                     210           

00CA F7              211                     MOV     @R1, A          

                     212               

00CB 22              213                     RET

                     214     

                     215     

                     216     

00CC                 217     DELAY1: 

00CC 7E02            218                     MOV     R6,#2D      

00CE                 219     LABEL1: 

00CE DEFE            220                     DJNZ    R6,LABEL1

                     221               

00D0 7FFA            222     DELAY: MOV R7,#250D         

00D2 DFFE            223     LABEL2: DJNZ R7,LABEL2

00D4 22              224             RET

                     225     

                     226     

                     227     

                     228     

                     229     

                     230     

                     231     

                     232     

00D5                 233     CALCULA_VELOCIDADE:

00D5 C3              234                     CLR             C  

                     235                     

00D6 E546            236                     MOV     A, DISTANCIA_ANTERIOR

00D8 8547F0          237                     MOV             B, DISTANCIA_ATUAL

                     238                     

00DB 95F0            239                     SUBB    A, B

                     240     

00DD 5008            241                     JNC             DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL      

                     242                     

00DF                 243     DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR:

00DF E547            244                     MOV     A, DISTANCIA_ATUAL

00E1 9546            245                     SUBB    A, DISTANCIA_ANTERIOR

                     246                     

00E3 F541            247                     MOV             VELOCIDADE_VEICULO, A

                     248                     

00E5 8006            249                     JMP             DLOOP

                     250     

00E7                 251     DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL:

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     5

00E7 E546            252                     MOV     A, DISTANCIA_ANTERIOR

00E9 9547            253                     SUBB    A, DISTANCIA_ATUAL

                     254                     

00EB F541            255                     MOV             VELOCIDADE_VEICULO, A

                     256                     

00ED                 257     DLOOP: 

                     258                

                     259                

                     260                

00ED 74FF            261                MOV          A, #0FFh

00EF 9542            262                SUBB         A, VELOCIDADE_LIMITE

                     263                     

00F1 3541            264                ADDC         A, VELOCIDADE_VEICULO

                     265                     

00F3 402B            266                JC           ACIMA_DO_LIMITE

                     267     

00F5                 268     CONTINUA_DLOOP:

00F5 7D64            269                     MOV     R5,#100D     

00F7 7E0F            270                     MOV             R6,#15D

00F9                 271     BACK1: 

00F9 E541            272                     MOV     A,VELOCIDADE_VEICULO         

00FB 75F00A          273                     MOV     B,#10D      

                     274            

00FE 84              275                     DIV     AB           

                     276            

00FF D291            277                     SETB    P1.1        

0101 312B            278            ACALL MOSTRA_VELOCIDADE_DISPLAY    

0103 11D0            279            ACALL DELAY      

0105 11D0            280            ACALL DELAY

                     281            

0107 E5F0            282                MOV A,B          

0109 C291            283            CLR P1.1         

010B D292            284            SETB P1.2        

010D 312B            285            ACALL MOSTRA_VELOCIDADE_DISPLAY

010F 11D0            286            ACALL DELAY

0111 11D0            287            ACALL DELAY

                     288            

0113 C292            289                CLR P1.2        

                     290                

0115 DEE2            291                DJNZ R6,BACK1

0117 7E15            292                MOV  R6,#15h

0119 DDDE            293            DJNZ R5,BACK1   

                     294                

011B D296            295                SETB         PINO_LED_VERMELHO

011D D297            296                SETB         BUZZER

                     297                

011F 22              298            RET

                     299     

0120                 300     ACIMA_DO_LIMITE:

0120 120126          301                     LCALL   VELOCIDADE_ACIMA_DO_LIMITE

                     302                     

0123 80D0            303                     JMP             CONTINUA_DLOOP

                     304                     

0125 22              305                     RET     

                     306     

                     307     

                     308     

                     309     

                     310     

                     311     

                     312     

                     313     

                     314     

0126                 315     VELOCIDADE_ACIMA_DO_LIMITE:

0126 C296            316                     CLR             PINO_LED_VERMELHO

0128 C297            317                     CLR             BUZZER

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     6

                     318     

                     319                     

                     320     

                     321     

                     322     

                     323     

                     324     

                     325     

                     326     

                     327     

                     328     

                     329     

                     330     

                     331                     

012A 22              332                     RET

                     333     

                     334     

                     335     

                     336     

                     337     

                     338     

                     339     

                     340     

012B                 341     MOSTRA_VELOCIDADE_DISPLAY:

012B 900030          342                     MOV DPTR,#TAB7SEG           

                     343                     

012E 93              344                     MOVC    A,@A+DPTR    

012F F4              345             CPL     A            

0130 F580            346                     MOV     P0,A         

                     347                     

0132 22              348                     RET

                     349     

                     350     

                     351     

                     352     

                     353     

                     354     

                     355     

                     356     

                     357     

                     358     

                     359     

                     360     

0133                 361     TIMER_CONFIGURA_TIMER:

0133 758922          362                     MOV     TMOD, #00100010b  

                     363                     

0136 313F            364                     ACALL   TIMER_SETA_VALORES_TIMER_PADRAO

                     365                     

                     366                     

                     367                     

                     368                     

                     369                     

                     370                     

                     371                     

0138 758DFF          372                     MOV     TH1, #0FFh

013B 758B7A          373                     MOV             TL1, #122d

                     374                                     

013E 22              375                     RET

                     376                     

                     377     

                     378     

                     379     

                     380     

                     381     

                     382     

                     383     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     7

013F                 384     TIMER_SETA_VALORES_TIMER_PADRAO:

                     385                     

                     386                     

013F 758CCF          387                     MOV     TH0, #207d

0142 758ACF          388                     MOV     TL0, #207d

                     389                                     

0145 22              390                     RET

                     391                     

                     392     

                     393     

                     394     

                     395     

                     396     

                     397     

                     398     

0146                 399     TIMER_DELAY_20_MS:

0146 758901          400                     MOV     TMOD, #00000001b  

                     401                     

                     402                     

0149 758C56          403                     MOV     TH0, #HIGH(65535 - 43350)

014C 758AA9          404                     MOV     TL0, #LOW(65535 - 43350)

                     405     

014F C28D            406                     CLR     TF0

0151 D28C            407                     SETB    TR0

                     408             

0153 308DFD          409                     JNB     TF0, $

                     410                     

0156 C28D            411                     CLR     TF0

0158 C28C            412                     CLR     TR0

                     413             

015A D8EA            414                     DJNZ R0, TIMER_DELAY_20_MS

                     415             

015C 22              416                     RET

                     417             

                     418     

                     419     

                     420     

                     421     

                     422     

                     423     

                     424     

015D                 425     TIMER_DELAY_1_S:

015D 7832            426                     MOV             R0, #50d

015F 3146            427                     CALL    TIMER_DELAY_20_MS

                     428                     

0161 D9FA            429                     DJNZ    R1, TIMER_DELAY_1_S

                     430             

0163 22              431                     RET

                     432                     

                     433     

                     434     

                     435     

                     436     

                     437     

                     438     

                     439     

                     440     

                     441     

                     442     

                     443     

                     444     

                     445     

                     446     

                     447     

                     448     

                     449     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     8

                     450     

                     451     

                     452     

0164                 453     PWM_SQUARE_WAVE_SETUP_AND_START:

0164 8931            454                     MOV     PWM_DUTY_CYCLE, R1

                     455             

0166 12017A          456                     LCALL   PWM_SQUARE_WAVE_CONFIG_PERIOD

                     457             

0169 D28C            458                     SETB    TR0

                     459     

016B                 460     CONTINUA_PWM:

016B 120192          461                     LCALL   PWM_SQUARE_WAVE

                     462                     

016E E532            463                     MOV     A, PWM_COUNTER

0170 B536F8          464                     CJNE    A, PWM_QTDADE_PERIODOS, CONTINUA_PWM

                     465     

0173                 466     PWM_PARAR:

0173 12018F          467                     LCALL   PWM_STOP

                     468                     

0176 753200          469                     MOV             PWM_COUNTER, #00h

                     470                     

0179 22              471                     RET

                     472     

                     473     

                     474     

                     475     

                     476     

                     477     

                     478     

                     479     

                     480     

                     481     

                     482     

017A                 483     PWM_SQUARE_WAVE_CONFIG_PERIOD:

017A 8A35            484                     MOV             PWM_PERIODO_MSB, R2

017C 8B34            485                     MOV             PWM_PERIODO_MED, R3

017E 8C33            486                     MOV             PWM_PERIODO_LSB, R4

                     487                     

                     488                     

                     489                     

0180 E8              490                     MOV             A, R0

0181 28              491                     ADD             A, R0

0182 F536            492                     MOV             PWM_QTDADE_PERIODOS, A

                     493                     

0184 AE34            494                     MOV             R6, PWM_PERIODO_MED

0186 AF35            495                     MOV             R7, PWM_PERIODO_MSB

                     496                     

0188 758CFF          497                     MOV     TH0, #0FFh

018B 85338A          498                     MOV             TL0, PWM_PERIODO_LSB

                     499                     

018E 22              500                     RET

                     501     

                     502     

                     503     

                     504     

                     505     

                     506     

                     507     

                     508     

018F                 509     PWM_STOP:

018F C28C            510                     CLR     TR0

                     511                     

0191 22              512                     RET

                     513             

                     514     

                     515     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE     9

                     516     

                     517     

                     518     

                     519     

                     520     

                     521     

                     522     

                     523     

                     524     

                     525     

0192                 526     PWM_SQUARE_WAVE:        

0192 308DFD          527                     JNB     TF0, $

                     528             

0195 DE2B            529                     DJNZ    R6, CONTINUE_SQUARE

0197 AE34            530                     MOV             R6, PWM_PERIODO_MED

                     531                     

0199 DF27            532                     DJNZ    R7, CONTINUE_SQUARE

019B AF35            533                     MOV             R7, PWM_PERIODO_MSB     

                     534     

                     535                     

019D 0532            536                     INC             PWM_COUNTER

                     537     

019F 20000E          538                     JB              PWM_FLAG, HIGH_DONE

                     539             

01A2                 540     LOW_DONE:                       

01A2 D200            541                     SETB    PWM_FLAG

                     542                     

01A4 1201DB          543                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     544                     

01A7 758CFF          545                     MOV             TH0, #0FFh

01AA 85318A          546                     MOV     TL0, PWM_DUTY_CYCLE             

                     547                     

01AD C28D            548                     CLR     TF0

                     549                     

01AF 22              550                     RET

                     551                                     

01B0                 552     HIGH_DONE:

01B0 C200            553                     CLR     PWM_FLAG                         

                     554                             

01B2 1201DB          555                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     556                     

01B5 74FF            557                     MOV     A, #0FFh                 

01B7 C3              558                     CLR             C

01B8 9531            559                     SUBB    A, PWM_DUTY_CYCLE

                     560                     

01BA 758CFF          561                     MOV     TH0, #0FFh                       

01BD F58A            562                     MOV             TL0, A

                     563                     

01BF C28D            564                     CLR     TF0                                      

                     565                     

01C1 22              566                     RET

                     567     

01C2                 568     CONTINUE_SQUARE:

01C2 30000D          569                     JNB             PWM_FLAG, CONTINUE_SQUARE_LOW

                     570             

01C5                 571     CONTINUE_SQUARE_HIGH:

01C5 74FF            572                     MOV     A, #0FFh                 

01C7 C3              573                     CLR             C

01C8 9531            574                     SUBB    A, PWM_DUTY_CYCLE

                     575                     

01CA 758CFF          576                     MOV     TH0, #0FFh                       

01CD F58A            577                     MOV             TL0, A

                     578                     

01CF C28D            579                     CLR     TF0

                     580     

01D1 22              581                     RET

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE    10

                     582                     

01D2                 583     CONTINUE_SQUARE_LOW:

01D2 758CFF          584                     MOV             TH0, #0FFh

01D5 85318A          585                     MOV     TL0, PWM_DUTY_CYCLE

                     586                     

01D8 C28D            587                     CLR     TF0

                     588                     

01DA 22              589                     RET

                     590     

                     591     

                     592     

                     593     

                     594     

                     595     

                     596     

                     597     

                     598     

                     599     

01DB                 600     DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS:

01DB 7401            601                     MOV             A, #01h

01DD 5D              602                     ANL             A, R5

01DE 6002            603                     JZ              NAO_ATIVA_BIT_0

                     604                     

01E0 B296            605                     CPL     PINO_LED_VERMELHO

                     606                     

01E2                 607     NAO_ATIVA_BIT_0:

01E2 7402            608                     MOV             A, #02h

01E4 5D              609                     ANL             A, R5

01E5 6002            610                     JZ              NAO_ATIVA_BIT_1

                     611                     

01E7 B297            612                     CPL     BUZZER

                     613     

01E9                 614     NAO_ATIVA_BIT_1:

01E9 22              615                     RET

                     616     

                     617     

                     618     

                     619     

                     620     

                     621     

                     622     

                     623     

                     624     

                     625     

                     626     

                     627     

                     628     

01EA                 629     INT_CONFIGURA_INTERRUPCOES:

                     630                     

01EA D2AF            631                     SETB    EA

01EC D2A8            632                     SETB    EX0

                     633                     

01EE D2AB            634                     SETB    ET1

                     635                     

                     636                     

01F0 C2B8            637                     CLR             PX0              

                     638                     

01F2 D2BB            639                     SETB    PT1              

                     640                     

                     641                     

01F4 C289            642                     CLR             IE0              

                     643                     

01F6 C28A            644                     CLR             IT1              

                     645                     

01F8 22              646                     RET

                     647     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE    11

                     648     

                     649     

                     650     

                     651     

                     652     

                     653     

                     654     

01F9                 655     INT_EXT0:

01F9 C0E0            656                     PUSH    ACC

01FB C0D0            657                     PUSH    PSW

                     658                     

01FD 753701          659                     MOV             FLAG_MEDIR_DISTANCIA_INIT, #01h

                     660                     

0200 7805            661                     MOV     R0, #05h                 

0202 3146            662                     ACALL   TIMER_DELAY_20_MS

                     663                     

0204 D0D0            664                     POP             PSW

0206 D0E0            665                     POP             ACC

                     666                     

0208 32              667                     RETI

                     668     

                     669     

                     670     

                     671     

                     672     

                     673     

                     674     

                     675     

0209                 676     INT_TIMER0:

0209 32              677                     RETI

                     678             

                     679     

                     680     

                     681     

                     682     

                     683     

                     684     

                     685     

020A                 686     INT_EXT1:

                     687                     

                     688     

                     689     

                     690     

                     691     

                     692     

                     693     

                     694     

                     695     

                     696     

                     697     

                     698     

                     699     

                     700     

                     701     

                     702     

                     703                     

020A 32              704                     RETI

                     705     

                     706     

                     707     

                     708     

                     709     

                     710     

                     711     

                     712     

                     713     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE    12

                     714     

                     715     

020B                 716     INT_TIMER1:

020B C0E0            717                     PUSH    ACC

020D C0D0            718                     PUSH    PSW

                     719                     

020F 758B7A          720                     MOV             TL1, #122d

0212 C28F            721                     CLR             TF1

                     722                     

0214 E543            723                     MOV             A, TIMER_MEDICOES_LOW

0216 B41419          724                     CJNE    A, #020d, INCREMENTA_TIMER_MEDICOES_LOW       

                     725             

0219 E544            726                     MOV             A, TIMER_MEDICOES_LSB

021B B4FA18          727                     CJNE    A, #0250d, INCREMENTA_TIMER_MEDICOES_LSB         

                     728                     

021E 754300          729                     MOV             TIMER_MEDICOES_LOW, #00h

0221 754400          730                     MOV             TIMER_MEDICOES_LSB, #00h

0224 0545            731                     INC             TIMER_MEDICOES_MSB

                     732                     

0226 E545            733                     MOV             A, TIMER_MEDICOES_MSB

0228 B40210          734                     CJNE    A, #02d, FINALIZA_TIMER_1        

                     735                     

022B C28E            736                     CLR             TR1

022D 753801          737                     MOV             FLAG_CALCULAR_VELOCIDADE, #01h

0230 413B            738                     AJMP    FINALIZA_TIMER_1

                     739             

0232                 740     INCREMENTA_TIMER_MEDICOES_LOW:

0232 0543            741                     INC             TIMER_MEDICOES_LOW

0234 413B            742                     AJMP    FINALIZA_TIMER_1

                     743                     

0236                 744     INCREMENTA_TIMER_MEDICOES_LSB:

0236 754300          745                     MOV             TIMER_MEDICOES_LOW, #00h

0239 0544            746                     INC             TIMER_MEDICOES_LSB

                     747     

023B                 748     FINALIZA_TIMER_1:

023B D0D0            749                     POP             PSW

023D D0E0            750                     POP             ACC

                     751                     

023F 32              752                     RETI

                     753             

                     754     

                     755     

                     756     

                     757     

                     758     

                     759     

                     760     

0240                 761     INT_SERIAL:

0240 32              762                     RETI

                     763             

0241                 764     FIM:

0241 80FE            765                     JMP $

                     766                     END

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE    13

SYMBOL TABLE LISTING
------ ----- -------


N A M E                                    T Y P E  V A L U E   ATTRIBUTES

ACC . . . . . . . . . . . . . . . . . .    D ADDR   00E0H   A   
ACIMA_DO_LIMITE . . . . . . . . . . . .    C ADDR   0120H   A   
B . . . . . . . . . . . . . . . . . . .    D ADDR   00F0H   A   
BACK. . . . . . . . . . . . . . . . . .    C ADDR   00BDH   A   
BACK1 . . . . . . . . . . . . . . . . .    C ADDR   00F9H   A   
BUZZER. . . . . . . . . . . . . . . . .    B ADDR   0090H.7 A   
CALCULA_VELOCIDADE. . . . . . . . . . .    C ADDR   00D5H   A   
CONTINUA_DLOOP. . . . . . . . . . . . .    C ADDR   00F5H   A   
CONTINUA_PWM. . . . . . . . . . . . . .    C ADDR   016BH   A   
CONTINUE_SQUARE . . . . . . . . . . . .    C ADDR   01C2H   A   
CONTINUE_SQUARE_HIGH. . . . . . . . . .    C ADDR   01C5H   A   
CONTINUE_SQUARE_LOW . . . . . . . . . .    C ADDR   01D2H   A   
DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS  C ADDR   01DBH   A   
DELAY . . . . . . . . . . . . . . . . .    C ADDR   00D0H   A   
DELAY1. . . . . . . . . . . . . . . . .    C ADDR   00CCH   A   
DISTANCIA_ANTERIOR. . . . . . . . . . .    N NUMB   0046H   A   
DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL. . .    C ADDR   00E7H   A   
DISTANCIA_ATUAL . . . . . . . . . . . .    N NUMB   0047H   A   
DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR. . .    C ADDR   00DFH   A   
DLOOP . . . . . . . . . . . . . . . . .    C ADDR   00EDH   A   
EA. . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.7 A   
ESPERA_FLAG_MEDIR_DISTANCIA_2 . . . . .    C ADDR   005BH   A   
ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT.    C ADDR   0046H   A   
ET1 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.3 A   
EX0 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.0 A   
FIM . . . . . . . . . . . . . . . . . .    C ADDR   0241H   A   
FINALIZA_TIMER_1. . . . . . . . . . . .    C ADDR   023BH   A   
FLAG_CALCULAR_VELOCIDADE. . . . . . . .    N NUMB   0038H   A   
FLAG_MEDIR_DISTANCIA_INIT . . . . . . .    N NUMB   0037H   A   
HERE. . . . . . . . . . . . . . . . . .    C ADDR   00BAH   A   
HERE1 . . . . . . . . . . . . . . . . .    C ADDR   00BFH   A   
HIGH_DONE . . . . . . . . . . . . . . .    C ADDR   01B0H   A   
IE0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.1 A   
INCREMENTA_TIMER_MEDICOES_LOW . . . . .    C ADDR   0232H   A   
INCREMENTA_TIMER_MEDICOES_LSB . . . . .    C ADDR   0236H   A   
INT_CONFIGURA_INTERRUPCOES. . . . . . .    C ADDR   01EAH   A   
INT_EXT0. . . . . . . . . . . . . . . .    C ADDR   01F9H   A   
INT_EXT1. . . . . . . . . . . . . . . .    C ADDR   020AH   A   
INT_SERIAL. . . . . . . . . . . . . . .    C ADDR   0240H   A   
INT_TIMER0. . . . . . . . . . . . . . .    C ADDR   0209H   A   
INT_TIMER1. . . . . . . . . . . . . . .    C ADDR   020BH   A   
IT1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.2 A   
LABEL1. . . . . . . . . . . . . . . . .    C ADDR   00CEH   A   
LABEL2. . . . . . . . . . . . . . . . .    C ADDR   00D2H   A   
LED1. . . . . . . . . . . . . . . . . .    B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . . . . .    B ADDR   00B0H.6 A   
LOW_DONE. . . . . . . . . . . . . . . .    C ADDR   01A2H   A   
MEDIR_DISTANCIA . . . . . . . . . . . .    C ADDR   009AH   A   
MOSTRA_VELOCIDADE_DISPLAY . . . . . . .    C ADDR   012BH   A   
NAO_ATIVA_BIT_0 . . . . . . . . . . . .    C ADDR   01E2H   A   
NAO_ATIVA_BIT_1 . . . . . . . . . . . .    C ADDR   01E9H   A   
P0. . . . . . . . . . . . . . . . . . .    D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . . . . .    D ADDR   0090H   A   
P3. . . . . . . . . . . . . . . . . . .    D ADDR   00B0H   A   
PINO_LED_VERMELHO . . . . . . . . . . .    B ADDR   0090H.6 A   
PSW . . . . . . . . . . . . . . . . . .    D ADDR   00D0H   A   
PT1 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.3 A   
PWM_COUNTER . . . . . . . . . . . . . .    N NUMB   0032H   A   
PWM_DUTY_CYCLE. . . . . . . . . . . . .    N NUMB   0031H   A   
PWM_FLAG. . . . . . . . . . . . . . . .    N NUMB   0000H   A   
A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:53:04 PAGE    14

PWM_PARAR . . . . . . . . . . . . . . .    C ADDR   0173H   A   
PWM_PERIODO_LSB . . . . . . . . . . . .    N NUMB   0033H   A   
PWM_PERIODO_MED . . . . . . . . . . . .    N NUMB   0034H   A   
PWM_PERIODO_MSB . . . . . . . . . . . .    N NUMB   0035H   A   
PWM_QTDADE_PERIODOS . . . . . . . . . .    N NUMB   0036H   A   
PWM_SQUARE_WAVE . . . . . . . . . . . .    C ADDR   0192H   A   
PWM_SQUARE_WAVE_CONFIG_PERIOD . . . . .    C ADDR   017AH   A   
PWM_SQUARE_WAVE_SETUP_AND_START . . . .    C ADDR   0164H   A   
PWM_STOP. . . . . . . . . . . . . . . .    C ADDR   018FH   A   
PX0 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.0 A   
RESETA_TIMER_MEDICOES . . . . . . . . .    C ADDR   008DH   A   
SETA_VARIAVEIS_INICIAIS . . . . . . . .    C ADDR   0073H   A   
TAB7SEG . . . . . . . . . . . . . . . .    C ADDR   0030H   A   
TF0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.5 A   
TF1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.7 A   
TH0 . . . . . . . . . . . . . . . . . .    D ADDR   008CH   A   
TH1 . . . . . . . . . . . . . . . . . .    D ADDR   008DH   A   
TIMER_CONFIGURA_TIMER . . . . . . . . .    C ADDR   0133H   A   
TIMER_DELAY_1_S . . . . . . . . . . . .    C ADDR   015DH   A   
TIMER_DELAY_20_MS . . . . . . . . . . .    C ADDR   0146H   A   
TIMER_MEDICOES_LOW. . . . . . . . . . .    N NUMB   0043H   A   
TIMER_MEDICOES_LSB. . . . . . . . . . .    N NUMB   0044H   A   
TIMER_MEDICOES_MSB. . . . . . . . . . .    N NUMB   0045H   A   
TIMER_SETA_VALORES_TIMER_PADRAO . . . .    C ADDR   013FH   A   
TL0 . . . . . . . . . . . . . . . . . .    D ADDR   008AH   A   
TL1 . . . . . . . . . . . . . . . . . .    D ADDR   008BH   A   
TMOD. . . . . . . . . . . . . . . . . .    D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.4 A   
TR1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.6 A   
VELOCIDADE_ACIMA_DO_LIMITE. . . . . . .    C ADDR   0126H   A   
VELOCIDADE_LIMITE . . . . . . . . . . .    N NUMB   0042H   A   
VELOCIDADE_VEICULO. . . . . . . . . . .    N NUMB   0041H   A   
VELOCIDADE_VEICULO_DEZENA . . . . . . .    N NUMB   0040H   A   
VELOCIDADE_VEICULO_UNIDADE. . . . . . .    N NUMB   0039H   A   
__STARTUP__ . . . . . . . . . . . . . .    C ADDR   0040H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
