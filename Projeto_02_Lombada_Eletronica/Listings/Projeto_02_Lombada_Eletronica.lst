A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_02_Lombada_Eletronica.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_02_Lombada_Eletronica.a51 SET(SMALL) DEBUG PRINT(.\Listings\Pro
                      jeto_02_Lombada_Eletronica.lst) OBJECT(.\Objects\Projeto_02_Lombada_Eletronica.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

                      17     

                      18     

                      19     

                      20     

                      21     

                      22     

                      23     

                      24     

                      25     

                      26     

                      27     

0000                  28     org 00h 

0000 020026           29     ljmp __STARTUP__

                      30     

0003                  31     org 03h 

0003 02009F           32     ljmp INT_EXT0

                      33     

000B                  34     org 0Bh 

000B 0200A2           35     ljmp INT_TIMER0

                      36     

0013                  37     org 013h 

0013 0200A3           38     ljmp INT_EXT1

                      39     

001B                  40     org 01Bh 

001B 0200A9           41     ljmp INT_TIMER1

                      42     

0023                  43     org 023h 

0023 0200D4           44     ljmp INT_SERIAL

                      45     

                      46     

                      47     

                      48     

                      49     

                      50     

  00B0                51     BUZZER                                          EQU P3.0

                      52             

  00B2                53     SENSOR_EXTERNO_1                        EQU P3.2  

  00B3                54     SENSOR_EXTERNO_2                        EQU P3.3  

                      55     

                      56     

  00B6                57     LED_SEG                                         EQU     P3.6

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     2

  00B7                58     LED1                                            EQU     P3.7

                      59             

  0031                60     DISTANCIA_SENSORES                      EQU 31h   

                      61     

  0032                62     FLAG_CALCULAR_VELOCIDADE        EQU 32h   

                      63             

  0033                64     VELOCIDADE_VEICULO_UNIDADE      EQU     33h

  0034                65     VELOCIDADE_VEICULO_DEZENA       EQU     34h

                      66     

                      67     

                      68     

  0035                69     TIMER_MEDICOES_LOW                      EQU     35h

  0036                70     TIMER_MEDICOES_HIGH                     EQU     36h

  0037                71     TIMER_MEDICOES_X1S                      EQU     37h

                      72             

                      73     

                      74     

                      75     

                      76     

                      77     

                      78     

                      79     

                      80     

0026                  81     __STARTUP__:

0026 12003F           82                     LCALL   SETA_VARIAVEIS_INICIAIS

0029 120065           83                     LCALL   TIMER_CONFIGURA_TIMER

002C 12008A           84                     LCALL   INT_CONFIGURA_INTERRUPCOES

                      85     

002F                  86     INICIO:

002F 12004C           87                     LCALL   RESETA_TIMER_MEDICOES

                      88                     

0032                  89     ESPERA_SENSOR_2:

0032 E532             90                     MOV             A, FLAG_CALCULAR_VELOCIDADE

0034 B401FB           91                     CJNE    A, #01h, ESPERA_SENSOR_2

                      92                     

0037 120056           93                     LCALL   CALCULA_VELOCIDADE

                      94                     

003A 12003F           95                     LCALL   SETA_VARIAVEIS_INICIAIS

003D 012F             96                     AJMP    INICIO

                      97     

                      98     

                      99     

                     100     

                     101     

                     102     

                     103     

                     104     

003F                 105     SETA_VARIAVEIS_INICIAIS:

003F 753164          106                     MOV             DISTANCIA_SENSORES, #100d                

0042 753200          107                     MOV             FLAG_CALCULAR_VELOCIDADE, #00h

0045 753300          108                     MOV             VELOCIDADE_VEICULO_UNIDADE, #00h

0048 753400          109                     MOV             VELOCIDADE_VEICULO_DEZENA, #00h

                     110                     

004B 22              111                     RET

                     112                     

                     113     

                     114     

                     115     

                     116     

                     117     

                     118     

                     119     

004C                 120     RESETA_TIMER_MEDICOES:

004C 753500          121                     MOV             TIMER_MEDICOES_LOW, #00h

004F 753600          122                     MOV             TIMER_MEDICOES_HIGH, #00h

0052 753700          123                     MOV             TIMER_MEDICOES_X1S, #00h

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     3

                     124                     

0055 22              125                     RET

                     126     

                     127     

                     128     

                     129     

                     130     

                     131     

                     132     

                     133     

0056                 134     CALCULA_VELOCIDADE:

                     135                     

0056 22              136                     RET     

                     137     

                     138     

                     139     

                     140     

                     141     

                     142     

                     143     

                     144     

                     145     

                     146     

                     147     

                     148     

0057                 149     ACIONA_BUZZER_X20MS:

0057 D2B0            150                     SETB    BUZZER

0059 1175            151                     ACALL   TIMER_DELAY_20_MS

005B C2B0            152                     CLR     BUZZER

                     153                     

005D 22              154                     RET

                     155                     

                     156     

                     157     

                     158     

                     159     

                     160     

                     161     

                     162     

005E                 163     ACIONA_BUZZER_X1S:

005E D2B0            164                     SETB    BUZZER

0060 1183            165                     ACALL   TIMER_DELAY_1_S

0062 C2B0            166                     CLR     BUZZER

                     167                     

0064 22              168                     RET

                     169     

                     170     

                     171     

                     172     

                     173     

                     174     

                     175     

                     176     

                     177     

                     178     

                     179     

                     180     

0065                 181     TIMER_CONFIGURA_TIMER:

0065 758921          182                     MOV     TMOD, #00100001b  

                     183                     

                     184                     

0068 758C56          185                     MOV     TH0, #HIGH(65535 - 43350)

006B 758AA9          186                     MOV     TL0, #LOW(65535 - 43350)

                     187                     

                     188                     

                     189                     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     4

                     190                     

                     191                     

                     192                     

006E 758DFF          193                     MOV     TH1, #0FFh

0071 758B05          194                     MOV             TL1, #05h

                     195                                     

0074 22              196                     RET

                     197     

                     198     

                     199     

                     200     

                     201     

                     202     

                     203     

                     204     

0075                 205     TIMER_DELAY_20_MS:

0075 C28D            206                     CLR TF0

0077 D28C            207                     SETB TR0

                     208             

0079 308DFD          209                     JNB TF0, $

                     210                     

007C C28D            211                     CLR TF0

007E C28C            212                     CLR TR0

                     213             

0080 D8F3            214                     DJNZ R0, TIMER_DELAY_20_MS

                     215             

0082 22              216                     RET

                     217                     

                     218     

                     219     

                     220     

                     221     

                     222     

                     223     

                     224     

0083                 225     TIMER_DELAY_1_S:

0083 7832            226                     MOV             R0, #50d

0085 1175            227                     CALL    TIMER_DELAY_20_MS

                     228                     

0087 D9FA            229                     DJNZ    R1, TIMER_DELAY_1_S

                     230             

0089 22              231                     RET

                     232     

                     233     

                     234     

                     235     

                     236     

                     237     

                     238     

                     239     

                     240     

                     241     

                     242     

                     243     

                     244     

008A                 245     INT_CONFIGURA_INTERRUPCOES:

                     246                     

008A D2AF            247                     SETB    EA

008C D2A8            248                     SETB    EX0

008E D2AA            249                     SETB    EX1

0090 D2AB            250                     SETB    ET1

                     251                     

                     252                     

0092 D2B8            253                     SETB    PX0              

0094 D2BA            254                     SETB    PX1              

0096 C2BB            255                     CLR             PT1              

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     5

                     256                     

                     257                     

0098 D289            258                     SETB    IE0              

009A D28B            259                     SETB    IE1              

009C C28A            260                     CLR             IT1              

                     261                     

009E 22              262                     RET

                     263     

                     264     

                     265     

                     266     

                     267     

                     268     

                     269     

                     270     

009F                 271     INT_EXT0:

009F D28E            272                     SETB    TR1

                     273                     

00A1 32              274                     RETI

                     275     

                     276     

                     277     

                     278     

                     279     

                     280     

                     281     

                     282     

00A2                 283     INT_TIMER0:

00A2 32              284                     RETI

                     285             

                     286     

                     287     

                     288     

                     289     

                     290     

                     291     

                     292     

00A3                 293     INT_EXT1:

00A3 C28E            294                     CLR             TR1

                     295                     

00A5 753201          296                     MOV             FLAG_CALCULAR_VELOCIDADE, #01h

                     297                     

00A8 32              298                     RETI

                     299     

                     300     

                     301     

                     302     

                     303     

                     304     

                     305     

                     306     

                     307     

                     308     

                     309     

00A9                 310     INT_TIMER1:

00A9 C0E0            311                     PUSH    ACC

00AB C0D0            312                     PUSH    PSW

                     313                     

00AD 758B05          314                     MOV             TL1, #05h

00B0 C28F            315                     CLR             TF1

                     316                     

00B2 E535            317                     MOV             A, TIMER_MEDICOES_LOW

00B4 B4FF0F          318                     CJNE    A, #0FFh, INCREMENTA_TIMER_MEDICOES_LOW

                     319             

00B7 E536            320                     MOV             A, TIMER_MEDICOES_HIGH

00B9 B41E0E          321                     CJNE    A, #01Eh, INCREMENTA_TIMER_MEDICOES_HIGH

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     6

                     322                     

00BC 753500          323                     MOV             TIMER_MEDICOES_LOW, #00h

00BF 753600          324                     MOV             TIMER_MEDICOES_HIGH, #00h

00C2 0537            325                     INC             TIMER_MEDICOES_X1S

00C4 01CF            326                     AJMP    FINALIZA_TIMER_1

                     327             

00C6                 328     INCREMENTA_TIMER_MEDICOES_LOW:

00C6 0535            329                     INC             TIMER_MEDICOES_LOW

00C8 01CF            330                     AJMP    FINALIZA_TIMER_1

                     331                     

00CA                 332     INCREMENTA_TIMER_MEDICOES_HIGH:

00CA 753500          333                     MOV             TIMER_MEDICOES_LOW, #00h

00CD 0536            334                     INC             TIMER_MEDICOES_HIGH

                     335     

00CF                 336     FINALIZA_TIMER_1:

00CF D0D0            337                     POP             PSW

00D1 D0E0            338                     POP             ACC

                     339                     

00D3 32              340                     RETI

                     341             

                     342     

                     343     

                     344     

                     345     

                     346     

                     347     

                     348     

00D4                 349     INT_SERIAL:

00D4 32              350                     RETI

                     351             

00D5                 352     FIM:

00D5 80FE            353                     JMP $

                     354                     END

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     7

SYMBOL TABLE LISTING
------ ----- -------


N A M E                         T Y P E  V A L U E   ATTRIBUTES

ACC. . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER_X1S. . . . . . .  C ADDR   005EH   A   
ACIONA_BUZZER_X20MS. . . . . .  C ADDR   0057H   A   
BUZZER . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CALCULA_VELOCIDADE . . . . . .  C ADDR   0056H   A   
DISTANCIA_SENSORES . . . . . .  N NUMB   0031H   A   
EA . . . . . . . . . . . . . .  B ADDR   00A8H.7 A   
ESPERA_SENSOR_2. . . . . . . .  C ADDR   0032H   A   
ET1. . . . . . . . . . . . . .  B ADDR   00A8H.3 A   
EX0. . . . . . . . . . . . . .  B ADDR   00A8H.0 A   
EX1. . . . . . . . . . . . . .  B ADDR   00A8H.2 A   
FIM. . . . . . . . . . . . . .  C ADDR   00D5H   A   
FINALIZA_TIMER_1 . . . . . . .  C ADDR   00CFH   A   
FLAG_CALCULAR_VELOCIDADE . . .  N NUMB   0032H   A   
IE0. . . . . . . . . . . . . .  B ADDR   0088H.1 A   
IE1. . . . . . . . . . . . . .  B ADDR   0088H.3 A   
INCREMENTA_TIMER_MEDICOES_HIGH  C ADDR   00CAH   A   
INCREMENTA_TIMER_MEDICOES_LOW.  C ADDR   00C6H   A   
INICIO . . . . . . . . . . . .  C ADDR   002FH   A   
INT_CONFIGURA_INTERRUPCOES . .  C ADDR   008AH   A   
INT_EXT0 . . . . . . . . . . .  C ADDR   009FH   A   
INT_EXT1 . . . . . . . . . . .  C ADDR   00A3H   A   
INT_SERIAL . . . . . . . . . .  C ADDR   00D4H   A   
INT_TIMER0 . . . . . . . . . .  C ADDR   00A2H   A   
INT_TIMER1 . . . . . . . . . .  C ADDR   00A9H   A   
IT1. . . . . . . . . . . . . .  B ADDR   0088H.2 A   
LED1 . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG. . . . . . . . . . . .  B ADDR   00B0H.6 A   
P3 . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PSW. . . . . . . . . . . . . .  D ADDR   00D0H   A   
PT1. . . . . . . . . . . . . .  B ADDR   00B8H.3 A   
PX0. . . . . . . . . . . . . .  B ADDR   00B8H.0 A   
PX1. . . . . . . . . . . . . .  B ADDR   00B8H.2 A   
RESETA_TIMER_MEDICOES. . . . .  C ADDR   004CH   A   
SENSOR_EXTERNO_1 . . . . . . .  B ADDR   00B0H.2 A   
SENSOR_EXTERNO_2 . . . . . . .  B ADDR   00B0H.3 A   
SETA_VARIAVEIS_INICIAIS. . . .  C ADDR   003FH   A   
TF0. . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TF1. . . . . . . . . . . . . .  B ADDR   0088H.7 A   
TH0. . . . . . . . . . . . . .  D ADDR   008CH   A   
TH1. . . . . . . . . . . . . .  D ADDR   008DH   A   
TIMER_CONFIGURA_TIMER. . . . .  C ADDR   0065H   A   
TIMER_DELAY_1_S. . . . . . . .  C ADDR   0083H   A   
TIMER_DELAY_20_MS. . . . . . .  C ADDR   0075H   A   
TIMER_MEDICOES_HIGH. . . . . .  N NUMB   0036H   A   
TIMER_MEDICOES_LOW . . . . . .  N NUMB   0035H   A   
TIMER_MEDICOES_X1S . . . . . .  N NUMB   0037H   A   
TL0. . . . . . . . . . . . . .  D ADDR   008AH   A   
TL1. . . . . . . . . . . . . .  D ADDR   008BH   A   
TMOD . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0. . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TR1. . . . . . . . . . . . . .  B ADDR   0088H.6 A   
VELOCIDADE_VEICULO_DEZENA. . .  N NUMB   0034H   A   
VELOCIDADE_VEICULO_UNIDADE . .  N NUMB   0033H   A   
__STARTUP__. . . . . . . . . .  C ADDR   0026H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        04/13/2017 17:51:23 PAGE     8

