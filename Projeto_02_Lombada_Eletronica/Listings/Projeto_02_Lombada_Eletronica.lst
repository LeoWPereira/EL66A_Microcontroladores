A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_02_Lombada_Eletronica.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_02_Lombada_Eletronica.a51 SET(SMALL) DEBUG PRINT(.\Listings\Pro
                      jeto_02_Lombada_Eletronica.lst) OBJECT(.\Objects\Projeto_02_Lombada_Eletronica.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

                      17     

                      18     

                      19     

                      20     

                      21     

                      22     

                      23     

                      24     

                      25     

                      26     

                      27     

                      28     

                      29     

0000                  30     org 000h  

0000 020040           31     ljmp __STARTUP__

                      32     

0003                  33     org 003h  

0003 020204           34     ljmp INT_EXT0

                      35     

000B                  36     org 00Bh  

000B 020214           37     ljmp INT_TIMER0

                      38     

0013                  39     org 013h  

0013 020215           40     ljmp INT_EXT1

                      41     

001B                  42     org 01Bh  

001B 020216           43     ljmp INT_TIMER1

                      44     

0023                  45     org 023h  

0023 02024B           46     ljmp INT_SERIAL

                      47     

                      48     

                      49     

                      50     

                      51     

  0096                52     PINO_LED_VERMELHO                       EQU P1.6

                      53             

                      54     

  0097                55     BUZZER                                          EQU P1.7

                      56             

                      57     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     2

  00B6                58     LED_SEG                                         EQU     P3.6

  00B7                59     LED1                                            EQU     P3.7

                      60             

  0000                61     PWM_FLAG                                        EQU 0    

                      62     

  0031                63     PWM_DUTY_CYCLE                          EQU 31h  

                      64     

  0032                65     PWM_COUNTER                                     EQU 32h

                      66     

                      67     

  0033                68     PWM_PERIODO_LSB                         EQU 33h

  0034                69     PWM_PERIODO_MED                         EQU 34h 

  0035                70     PWM_PERIODO_MSB                         EQU 35h

                      71             

  0036                72     PWM_QTDADE_PERIODOS                     EQU 36h

                      73             

  0037                74     DISTANCIA_SENSORES                      EQU 37h   

                      75     

  0038                76     FLAG_MEDIR_DISTANCIA_INIT       EQU 38h

  0039                77     FLAG_CALCULAR_VELOCIDADE        EQU 39h   

                      78             

                      79     

  0040                80     VELOCIDADE_VEICULO_UNIDADE      EQU     40h

  0041                81     VELOCIDADE_VEICULO_DEZENA       EQU     41h

  0042                82     VELOCIDADE_VEICULO                      EQU 42h 

                      83     

  0043                84     VELOCIDADE_LIMITE                       EQU 43h  

                      85             

  0044                86     TIMER_MEDICOES_LOW                      EQU     44h

                      87     

                      88     

                      89     

  0045                90     TIMER_MEDICOES_LSB                      EQU     45h

  0046                91     TIMER_MEDICOES_MSB                      EQU     46h

                      92             

  0047                93     DISTANCIA_ANTERIOR                      EQU     47h

  0048                94     DISTANCIA_ATUAL                         EQU     48h

                      95             

                      96     

                      97     

                      98     

                      99     

0030                 100     org 030h

0030                 101     TAB7SEG:

0030 3F065B4F        102             DB 3FH, 06H, 5BH, 4FH, 66H, 6DH, 7DH, 07H, 7FH, 6FH, 77H, 7CH, 39H, 5EH, 79H, 71H

0034 666D7D07                
0038 7F6F777C                
003C 395E7971                
                     103     

                     104     

                     105     

                     106     

                     107     

0040                 108     __STARTUP__:

0040 120079          109                     LCALL   SETA_VARIAVEIS_INICIAIS

0043 12013E          110                     LCALL   TIMER_CONFIGURA_TIMER

0046 1201F5          111                     LCALL   INT_CONFIGURA_INTERRUPCOES

0049 120093          112                     LCALL   RESETA_TIMER_MEDICOES

                     113                     

004C                 114     ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT:

004C E538            115                     MOV             A, FLAG_MEDIR_DISTANCIA_INIT

004E B401FB          116                     CJNE    A, #01h, ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT

                     117                     

0051 7947            118                     MOV             R1, #DISTANCIA_ANTERIOR

0053 1200A0          119                     LCALL   MEDIR_DISTANCIA

                     120                     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     3

                     121                     

0056 12013E          122                     LCALL   TIMER_CONFIGURA_TIMER

0059 1201F5          123                     LCALL   INT_CONFIGURA_INTERRUPCOES

005C 120093          124                     LCALL   RESETA_TIMER_MEDICOES

                     125                     

005F D28E            126                     SETB    TR1

                     127                     

0061                 128     ESPERA_FLAG_MEDIR_DISTANCIA_2:

0061 E539            129                     MOV             A, FLAG_CALCULAR_VELOCIDADE

0063 B401FB          130                     CJNE    A, #01h, ESPERA_FLAG_MEDIR_DISTANCIA_2

                     131                     

0066 7948            132                     MOV             R1, #DISTANCIA_ATUAL

0068 1200A0          133                     LCALL   MEDIR_DISTANCIA

                     134                     

                     135                     

006B 12013E          136                     LCALL   TIMER_CONFIGURA_TIMER

006E 1201F5          137                     LCALL   INT_CONFIGURA_INTERRUPCOES

0071 120093          138                     LCALL   RESETA_TIMER_MEDICOES

                     139                     

0074 1200DB          140                     LCALL   CALCULA_VELOCIDADE

                     141                     

0077 0140            142                     AJMP    __STARTUP__

                     143     

                     144     

                     145     

                     146     

                     147     

                     148     

                     149     

                     150     

0079                 151     SETA_VARIAVEIS_INICIAIS:

0079 C296            152                     CLR             PINO_LED_VERMELHO

007B C297            153                     CLR             BUZZER

                     154                     

007D 75430A          155                     MOV             VELOCIDADE_LIMITE,                      #010d    

0080 753800          156                     MOV             FLAG_MEDIR_DISTANCIA_INIT,      #00h 

0083 753900          157                     MOV             FLAG_CALCULAR_VELOCIDADE,       #00h

0086 754000          158                     MOV             VELOCIDADE_VEICULO_UNIDADE, #00h

0089 754100          159                     MOV             VELOCIDADE_VEICULO_DEZENA,      #00h

008C 754700          160                     MOV             DISTANCIA_ANTERIOR,             #00h                    

008F 754800          161                     MOV             DISTANCIA_ATUAL,                        #00h               
                                          

                     162                     

0092 22              163                     RET

                     164                     

                     165     

                     166     

                     167     

                     168     

                     169     

                     170     

                     171     

0093                 172     RESETA_TIMER_MEDICOES:

0093 754400          173                     MOV             TIMER_MEDICOES_LOW,     #00h

0096 754500          174                     MOV             TIMER_MEDICOES_LSB,     #00h

0099 754600          175                     MOV             TIMER_MEDICOES_MSB,     #00h

                     176                     

009C 754200          177                     MOV             VELOCIDADE_VEICULO,     #00h

                     178                     

009F 22              179                     RET     

                     180                     

                     181     

                     182     

                     183     

                     184     

                     185     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     4

                     186     

                     187     

00A0                 188     MEDIR_DISTANCIA:

00A0 C2AB            189                     CLR             ET1

                     190     

00A2 900030          191                     MOV     DPTR,#TAB7SEG           

                     192                     

00A5 759000          193                     MOV     P1,#00h       

00A8 758000          194                     MOV     P0,#00h       

                     195                     

00AB C2B0            196                     CLR     P3.0                

00AD D2B1            197                     SETB    P3.1               

                     198     

00AF 758920          199                     MOV     TMOD,#00100000B     

00B2 758B82          200                     MOV     TL1,#130D     

00B5 758D82          201                     MOV     TH1,#130D     

                     202                     

00B8 7400            203                     MOV     A,#00h  

                     204                     

00BA D2B0            205                     SETB    P3.0         

                     206                     

00BC 11D2            207                     ACALL   DELAY1      

                     208                     

00BE C2B0            209                     CLR     P3.0          

                     210     

00C0                 211     HERE:   

00C0 30B1FD          212                     JNB     P3.1,HERE     

00C3                 213     BACK:   

00C3 D28E            214                     SETB    TR1          

00C5                 215     HERE1: 

00C5 308FFD          216                     JNB     TF1,HERE1    

                     217           

00C8 C28E            218                     CLR     TR1           

00CA C28F            219                     CLR     TF1           

                     220           

00CC 04              221                     INC     A             

                     222           

00CD 20B1F3          223                     JB              P3.1,BACK      

                     224           

00D0 F7              225                     MOV     @R1, A          

                     226               

00D1 22              227                     RET

                     228     

                     229     

                     230     

00D2                 231     DELAY1: 

00D2 7E02            232                     MOV     R6,#2D      

00D4                 233     LABEL1: 

00D4 DEFE            234                     DJNZ    R6,LABEL1

                     235               

00D6 7FFA            236     DELAY: MOV R7,#250D         

00D8 DFFE            237     LABEL2: DJNZ R7,LABEL2

00DA 22              238             RET

                     239     

                     240     

                     241     

                     242     

                     243     

                     244     

                     245     

                     246     

00DB                 247     CALCULA_VELOCIDADE:

00DB C3              248                     CLR             C  

                     249                     

00DC E547            250                     MOV     A, DISTANCIA_ANTERIOR

00DE 8548F0          251                     MOV             B, DISTANCIA_ATUAL

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     5

                     252                     

00E1 95F0            253                     SUBB    A, B

                     254     

00E3 5008            255                     JNC             DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL      

                     256                     

00E5                 257     DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR:

00E5 E548            258                     MOV     A, DISTANCIA_ATUAL

00E7 9547            259                     SUBB    A, DISTANCIA_ANTERIOR

                     260                     

00E9 F542            261                     MOV             VELOCIDADE_VEICULO, A

                     262                     

00EB 8006            263                     JMP             DLOOP

                     264     

00ED                 265     DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL:

00ED E547            266                     MOV     A, DISTANCIA_ANTERIOR

00EF 9548            267                     SUBB    A, DISTANCIA_ATUAL

                     268                     

00F1 F542            269                     MOV             VELOCIDADE_VEICULO, A

                     270                     

00F3                 271     DLOOP: 

00F3 7D64            272                     MOV     R5,#100D     

00F5 7E0F            273                     MOV             R6,#15D

00F7                 274     BACK1: 

00F7 E542            275                     MOV     A,VELOCIDADE_VEICULO         

00F9 75F00A          276                     MOV     B,#10D      

                     277            

00FC 84              278                     DIV     AB           

                     279            

00FD D291            280                     SETB    P1.1        

00FF 3136            281            ACALL MOSTRA_VELOCIDADE_DISPLAY    

0101 11D6            282            ACALL DELAY      

0103 11D6            283            ACALL DELAY

                     284            

0105 E5F0            285                MOV A,B          

0107 C291            286            CLR P1.1         

0109 D292            287            SETB P1.2        

010B 3136            288            ACALL MOSTRA_VELOCIDADE_DISPLAY

010D 11D6            289            ACALL DELAY

010F 11D6            290            ACALL DELAY

                     291            

0111 C292            292                CLR P1.2        

                     293                

0113 DEE2            294                DJNZ R6,BACK1

0115 7E15            295                MOV  R6,#15h

0117 DDDE            296            DJNZ R5,BACK1   

                     297                

                     298                

                     299                

                     300                

0119 74FF            301                MOV          A, #0FFh

011B 9543            302                SUBB         A, VELOCIDADE_LIMITE

                     303                     

011D 3542            304                ADDC         A, VELOCIDADE_VEICULO

                     305                     

011F 4001            306                JC           ACIMA_DO_LIMITE

                     307                

0121 22              308            RET

                     309     

0122                 310     ACIMA_DO_LIMITE:

0122 120126          311                     LCALL   VELOCIDADE_ACIMA_DO_LIMITE

                     312                     

0125 22              313                     RET     

                     314     

                     315     

                     316     

                     317     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     6

                     318     

                     319     

                     320     

                     321     

                     322     

0126                 323     VELOCIDADE_ACIMA_DO_LIMITE:

0126 7802            324                     MOV             R0, #02h  

0128 7980            325                     MOV             R1, #128d  

                     326                     

                     327                     

                     328                     

                     329                     

012A 7A29            330                     MOV             R2, #029h

012C 7BFF            331                     MOV             R3, #0FFh

012E 7CFF            332                     MOV             R4, #0FFh

0130 7D05            333                     MOV             R5, #00000101b  

                     334                     

0132 12016F          335                     LCALL   PWM_SQUARE_WAVE_SETUP_AND_START

                     336                     

0135 22              337                     RET

                     338     

                     339     

                     340     

                     341     

                     342     

                     343     

                     344     

                     345     

0136                 346     MOSTRA_VELOCIDADE_DISPLAY:

0136 900030          347                     MOV DPTR,#TAB7SEG           

                     348                     

0139 93              349                     MOVC    A,@A+DPTR    

013A F4              350             CPL     A            

013B F580            351                     MOV     P0,A         

                     352                     

013D 22              353                     RET

                     354     

                     355     

                     356     

                     357     

                     358     

                     359     

                     360     

                     361     

                     362     

                     363     

                     364     

                     365     

013E                 366     TIMER_CONFIGURA_TIMER:

013E 758922          367                     MOV     TMOD, #00100010b  

                     368                     

0141 314A            369                     ACALL   TIMER_SETA_VALORES_TIMER_PADRAO

                     370                     

                     371                     

                     372                     

                     373                     

                     374                     

                     375                     

                     376                     

0143 758DFF          377                     MOV     TH1, #0FFh

0146 758B7A          378                     MOV             TL1, #122d

                     379                                     

0149 22              380                     RET

                     381                     

                     382     

                     383     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     7

                     384     

                     385     

                     386     

                     387     

                     388     

014A                 389     TIMER_SETA_VALORES_TIMER_PADRAO:

                     390                     

                     391                     

014A 758CCF          392                     MOV     TH0, #207d

014D 758ACF          393                     MOV     TL0, #207d

                     394                                     

0150 22              395                     RET

                     396                     

                     397     

                     398     

                     399     

                     400     

                     401     

                     402     

                     403     

0151                 404     TIMER_DELAY_20_MS:

0151 758901          405                     MOV     TMOD, #00000001b  

                     406                     

                     407                     

0154 758C56          408                     MOV     TH0, #HIGH(65535 - 43350)

0157 758AA9          409                     MOV     TL0, #LOW(65535 - 43350)

                     410     

015A C28D            411                     CLR     TF0

015C D28C            412                     SETB    TR0

                     413             

015E 308DFD          414                     JNB     TF0, $

                     415                     

0161 C28D            416                     CLR     TF0

0163 C28C            417                     CLR     TR0

                     418             

0165 D8EA            419                     DJNZ R0, TIMER_DELAY_20_MS

                     420             

0167 22              421                     RET

                     422             

                     423     

                     424     

                     425     

                     426     

                     427     

                     428     

                     429     

0168                 430     TIMER_DELAY_1_S:

0168 7832            431                     MOV             R0, #50d

016A 3151            432                     CALL    TIMER_DELAY_20_MS

                     433                     

016C D9FA            434                     DJNZ    R1, TIMER_DELAY_1_S

                     435             

016E 22              436                     RET

                     437                     

                     438     

                     439     

                     440     

                     441     

                     442     

                     443     

                     444     

                     445     

                     446     

                     447     

                     448     

                     449     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     8

                     450     

                     451     

                     452     

                     453     

                     454     

                     455     

                     456     

                     457     

016F                 458     PWM_SQUARE_WAVE_SETUP_AND_START:

016F 8931            459                     MOV     PWM_DUTY_CYCLE, R1

                     460             

0171 120185          461                     LCALL   PWM_SQUARE_WAVE_CONFIG_PERIOD

                     462             

0174 D28C            463                     SETB    TR0

                     464     

0176                 465     CONTINUA_PWM:

0176 12019D          466                     LCALL   PWM_SQUARE_WAVE

                     467                     

0179 E532            468                     MOV     A, PWM_COUNTER

017B B536F8          469                     CJNE    A, PWM_QTDADE_PERIODOS, CONTINUA_PWM

                     470     

017E                 471     PWM_PARAR:

017E 12019A          472                     LCALL   PWM_STOP

                     473                     

0181 753200          474                     MOV             PWM_COUNTER, #00h

                     475                     

0184 22              476                     RET

                     477     

                     478     

                     479     

                     480     

                     481     

                     482     

                     483     

                     484     

                     485     

                     486     

                     487     

0185                 488     PWM_SQUARE_WAVE_CONFIG_PERIOD:

0185 8A35            489                     MOV             PWM_PERIODO_MSB, R2

0187 8B34            490                     MOV             PWM_PERIODO_MED, R3

0189 8C33            491                     MOV             PWM_PERIODO_LSB, R4

                     492                     

                     493                     

                     494                     

018B E8              495                     MOV             A, R0

018C 28              496                     ADD             A, R0

018D F536            497                     MOV             PWM_QTDADE_PERIODOS, A

                     498                     

018F AE34            499                     MOV             R6, PWM_PERIODO_MED

0191 AF35            500                     MOV             R7, PWM_PERIODO_MSB

                     501                     

0193 758CFF          502                     MOV     TH0, #0FFh

0196 85338A          503                     MOV             TL0, PWM_PERIODO_LSB

                     504                     

0199 22              505                     RET

                     506     

                     507     

                     508     

                     509     

                     510     

                     511     

                     512     

                     513     

019A                 514     PWM_STOP:

019A C28C            515                     CLR     TR0

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE     9

                     516                     

019C 22              517                     RET

                     518             

                     519     

                     520     

                     521     

                     522     

                     523     

                     524     

                     525     

                     526     

                     527     

                     528     

                     529     

                     530     

019D                 531     PWM_SQUARE_WAVE:        

019D 308DFD          532                     JNB     TF0, $

                     533             

01A0 DE2B            534                     DJNZ    R6, CONTINUE_SQUARE

01A2 AE34            535                     MOV             R6, PWM_PERIODO_MED

                     536                     

01A4 DF27            537                     DJNZ    R7, CONTINUE_SQUARE

01A6 AF35            538                     MOV             R7, PWM_PERIODO_MSB     

                     539     

                     540                     

01A8 0532            541                     INC             PWM_COUNTER

                     542     

01AA 20000E          543                     JB              PWM_FLAG, HIGH_DONE

                     544             

01AD                 545     LOW_DONE:                       

01AD D200            546                     SETB    PWM_FLAG

                     547                     

01AF 1201E6          548                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     549                     

01B2 758CFF          550                     MOV             TH0, #0FFh

01B5 85318A          551                     MOV     TL0, PWM_DUTY_CYCLE             

                     552                     

01B8 C28D            553                     CLR     TF0

                     554                     

01BA 22              555                     RET

                     556                                     

01BB                 557     HIGH_DONE:

01BB C200            558                     CLR     PWM_FLAG                         

                     559                             

01BD 1201E6          560                     LCALL   DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS

                     561                     

01C0 74FF            562                     MOV     A, #0FFh                 

01C2 C3              563                     CLR             C

01C3 9531            564                     SUBB    A, PWM_DUTY_CYCLE

                     565                     

01C5 758CFF          566                     MOV     TH0, #0FFh                       

01C8 F58A            567                     MOV             TL0, A

                     568                     

01CA C28D            569                     CLR     TF0                                      

                     570                     

01CC 22              571                     RET

                     572     

01CD                 573     CONTINUE_SQUARE:

01CD 30000D          574                     JNB             PWM_FLAG, CONTINUE_SQUARE_LOW

                     575             

01D0                 576     CONTINUE_SQUARE_HIGH:

01D0 74FF            577                     MOV     A, #0FFh                 

01D2 C3              578                     CLR             C

01D3 9531            579                     SUBB    A, PWM_DUTY_CYCLE

                     580                     

01D5 758CFF          581                     MOV     TH0, #0FFh                       

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE    10

01D8 F58A            582                     MOV             TL0, A

                     583                     

01DA C28D            584                     CLR     TF0

                     585     

01DC 22              586                     RET

                     587                     

01DD                 588     CONTINUE_SQUARE_LOW:

01DD 758CFF          589                     MOV             TH0, #0FFh

01E0 85318A          590                     MOV     TL0, PWM_DUTY_CYCLE

                     591                     

01E3 C28D            592                     CLR     TF0

                     593                     

01E5 22              594                     RET

                     595     

                     596     

                     597     

                     598     

                     599     

                     600     

                     601     

                     602     

                     603     

                     604     

01E6                 605     DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS:

01E6 7401            606                     MOV             A, #01h

01E8 5D              607                     ANL             A, R5

01E9 6002            608                     JZ              NAO_ATIVA_BIT_0

                     609                     

01EB B296            610                     CPL     PINO_LED_VERMELHO

                     611                     

01ED                 612     NAO_ATIVA_BIT_0:

01ED 7402            613                     MOV             A, #02h

01EF 5D              614                     ANL             A, R5

01F0 6002            615                     JZ              NAO_ATIVA_BIT_1

                     616                     

01F2 B297            617                     CPL     BUZZER

                     618     

01F4                 619     NAO_ATIVA_BIT_1:

01F4 22              620                     RET

                     621     

                     622     

                     623     

                     624     

                     625     

                     626     

                     627     

                     628     

                     629     

                     630     

                     631     

                     632     

                     633     

01F5                 634     INT_CONFIGURA_INTERRUPCOES:

                     635                     

01F5 D2AF            636                     SETB    EA

01F7 D2A8            637                     SETB    EX0

                     638                     

01F9 D2AB            639                     SETB    ET1

                     640                     

                     641                     

01FB C2B8            642                     CLR             PX0              

                     643                     

01FD D2BB            644                     SETB    PT1              

                     645                     

                     646                     

01FF C289            647                     CLR     IE0              

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE    11

                     648                     

0201 C28A            649                     CLR             IT1              

                     650                     

0203 22              651                     RET

                     652     

                     653     

                     654     

                     655     

                     656     

                     657     

                     658     

                     659     

0204                 660     INT_EXT0:

0204 C0E0            661                     PUSH    ACC

0206 C0D0            662                     PUSH    PSW

                     663                     

0208 753801          664                     MOV             FLAG_MEDIR_DISTANCIA_INIT, #01h

                     665                     

020B 7805            666                     MOV     R0, #05h                 

020D 3151            667                     ACALL   TIMER_DELAY_20_MS

                     668                     

020F D0D0            669                     POP             PSW

0211 D0E0            670                     POP             ACC

                     671                     

0213 32              672                     RETI

                     673     

                     674     

                     675     

                     676     

                     677     

                     678     

                     679     

                     680     

0214                 681     INT_TIMER0:

0214 32              682                     RETI

                     683             

                     684     

                     685     

                     686     

                     687     

                     688     

                     689     

                     690     

0215                 691     INT_EXT1:

                     692                     

                     693     

                     694     

                     695     

                     696     

                     697     

                     698     

                     699     

                     700     

                     701     

                     702     

                     703     

                     704     

                     705     

                     706     

                     707     

                     708                     

0215 32              709                     RETI

                     710     

                     711     

                     712     

                     713     

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE    12

                     714     

                     715     

                     716     

                     717     

                     718     

                     719     

                     720     

0216                 721     INT_TIMER1:

0216 C0E0            722                     PUSH    ACC

0218 C0D0            723                     PUSH    PSW

                     724                     

021A 758B7A          725                     MOV             TL1, #122d

021D C28F            726                     CLR             TF1

                     727                     

021F E544            728                     MOV             A, TIMER_MEDICOES_LOW

0221 B41419          729                     CJNE    A, #020d, INCREMENTA_TIMER_MEDICOES_LOW       

                     730             

0224 E545            731                     MOV             A, TIMER_MEDICOES_LSB

0226 B4FA18          732                     CJNE    A, #0250d, INCREMENTA_TIMER_MEDICOES_LSB         

                     733                     

0229 754400          734                     MOV             TIMER_MEDICOES_LOW, #00h

022C 754500          735                     MOV             TIMER_MEDICOES_LSB, #00h

022F 0546            736                     INC             TIMER_MEDICOES_MSB

                     737                     

0231 E546            738                     MOV             A, TIMER_MEDICOES_MSB

0233 B40210          739                     CJNE    A, #02d, FINALIZA_TIMER_1        

                     740                     

0236 C28E            741                     CLR             TR1

0238 753901          742                     MOV             FLAG_CALCULAR_VELOCIDADE, #01h

023B 4146            743                     AJMP    FINALIZA_TIMER_1

                     744             

023D                 745     INCREMENTA_TIMER_MEDICOES_LOW:

023D 0544            746                     INC             TIMER_MEDICOES_LOW

023F 4146            747                     AJMP    FINALIZA_TIMER_1

                     748                     

0241                 749     INCREMENTA_TIMER_MEDICOES_LSB:

0241 754400          750                     MOV             TIMER_MEDICOES_LOW, #00h

0244 0545            751                     INC             TIMER_MEDICOES_LSB

                     752     

0246                 753     FINALIZA_TIMER_1:

0246 D0D0            754                     POP             PSW

0248 D0E0            755                     POP             ACC

                     756                     

024A 32              757                     RETI

                     758             

                     759     

                     760     

                     761     

                     762     

                     763     

                     764     

                     765     

024B                 766     INT_SERIAL:

024B 32              767                     RETI

                     768             

024C                 769     FIM:

024C 80FE            770                     JMP $

                     771                     END

A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE    13

SYMBOL TABLE LISTING
------ ----- -------


N A M E                                    T Y P E  V A L U E   ATTRIBUTES

ACC . . . . . . . . . . . . . . . . . .    D ADDR   00E0H   A   
ACIMA_DO_LIMITE . . . . . . . . . . . .    C ADDR   0122H   A   
B . . . . . . . . . . . . . . . . . . .    D ADDR   00F0H   A   
BACK. . . . . . . . . . . . . . . . . .    C ADDR   00C3H   A   
BACK1 . . . . . . . . . . . . . . . . .    C ADDR   00F7H   A   
BUZZER. . . . . . . . . . . . . . . . .    B ADDR   0090H.7 A   
CALCULA_VELOCIDADE. . . . . . . . . . .    C ADDR   00DBH   A   
CONTINUA_PWM. . . . . . . . . . . . . .    C ADDR   0176H   A   
CONTINUE_SQUARE . . . . . . . . . . . .    C ADDR   01CDH   A   
CONTINUE_SQUARE_HIGH. . . . . . . . . .    C ADDR   01D0H   A   
CONTINUE_SQUARE_LOW . . . . . . . . . .    C ADDR   01DDH   A   
DEFINE_PINOS_A_SEREM_ATIVADOS_DESATIVADOS  C ADDR   01E6H   A   
DELAY . . . . . . . . . . . . . . . . .    C ADDR   00D6H   A   
DELAY1. . . . . . . . . . . . . . . . .    C ADDR   00D2H   A   
DISTANCIA_ANTERIOR. . . . . . . . . . .    N NUMB   0047H   A   
DISTANCIA_ANTERIOR_MAIOR_QUE_ATUAL. . .    C ADDR   00EDH   A   
DISTANCIA_ATUAL . . . . . . . . . . . .    N NUMB   0048H   A   
DISTANCIA_ATUAL_MAIOR_QUE_ANTERIOR. . .    C ADDR   00E5H   A   
DISTANCIA_SENSORES. . . . . . . . . . .    N NUMB   0037H   A   
DLOOP . . . . . . . . . . . . . . . . .    C ADDR   00F3H   A   
EA. . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.7 A   
ESPERA_FLAG_MEDIR_DISTANCIA_2 . . . . .    C ADDR   0061H   A   
ESPERA_TRIGGER_CALCULAR_DISTANCIA_INIT.    C ADDR   004CH   A   
ET1 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.3 A   
EX0 . . . . . . . . . . . . . . . . . .    B ADDR   00A8H.0 A   
FIM . . . . . . . . . . . . . . . . . .    C ADDR   024CH   A   
FINALIZA_TIMER_1. . . . . . . . . . . .    C ADDR   0246H   A   
FLAG_CALCULAR_VELOCIDADE. . . . . . . .    N NUMB   0039H   A   
FLAG_MEDIR_DISTANCIA_INIT . . . . . . .    N NUMB   0038H   A   
HERE. . . . . . . . . . . . . . . . . .    C ADDR   00C0H   A   
HERE1 . . . . . . . . . . . . . . . . .    C ADDR   00C5H   A   
HIGH_DONE . . . . . . . . . . . . . . .    C ADDR   01BBH   A   
IE0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.1 A   
INCREMENTA_TIMER_MEDICOES_LOW . . . . .    C ADDR   023DH   A   
INCREMENTA_TIMER_MEDICOES_LSB . . . . .    C ADDR   0241H   A   
INT_CONFIGURA_INTERRUPCOES. . . . . . .    C ADDR   01F5H   A   
INT_EXT0. . . . . . . . . . . . . . . .    C ADDR   0204H   A   
INT_EXT1. . . . . . . . . . . . . . . .    C ADDR   0215H   A   
INT_SERIAL. . . . . . . . . . . . . . .    C ADDR   024BH   A   
INT_TIMER0. . . . . . . . . . . . . . .    C ADDR   0214H   A   
INT_TIMER1. . . . . . . . . . . . . . .    C ADDR   0216H   A   
IT1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.2 A   
LABEL1. . . . . . . . . . . . . . . . .    C ADDR   00D4H   A   
LABEL2. . . . . . . . . . . . . . . . .    C ADDR   00D8H   A   
LED1. . . . . . . . . . . . . . . . . .    B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . . . . .    B ADDR   00B0H.6 A   
LOW_DONE. . . . . . . . . . . . . . . .    C ADDR   01ADH   A   
MEDIR_DISTANCIA . . . . . . . . . . . .    C ADDR   00A0H   A   
MOSTRA_VELOCIDADE_DISPLAY . . . . . . .    C ADDR   0136H   A   
NAO_ATIVA_BIT_0 . . . . . . . . . . . .    C ADDR   01EDH   A   
NAO_ATIVA_BIT_1 . . . . . . . . . . . .    C ADDR   01F4H   A   
P0. . . . . . . . . . . . . . . . . . .    D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . . . . .    D ADDR   0090H   A   
P3. . . . . . . . . . . . . . . . . . .    D ADDR   00B0H   A   
PINO_LED_VERMELHO . . . . . . . . . . .    B ADDR   0090H.6 A   
PSW . . . . . . . . . . . . . . . . . .    D ADDR   00D0H   A   
PT1 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.3 A   
PWM_COUNTER . . . . . . . . . . . . . .    N NUMB   0032H   A   
PWM_DUTY_CYCLE. . . . . . . . . . . . .    N NUMB   0031H   A   
PWM_FLAG. . . . . . . . . . . . . . . .    N NUMB   0000H   A   
A51 MACRO ASSEMBLER  PROJETO_02_LOMBADA_ELETRONICA                                        05/03/2017 18:08:53 PAGE    14

PWM_PARAR . . . . . . . . . . . . . . .    C ADDR   017EH   A   
PWM_PERIODO_LSB . . . . . . . . . . . .    N NUMB   0033H   A   
PWM_PERIODO_MED . . . . . . . . . . . .    N NUMB   0034H   A   
PWM_PERIODO_MSB . . . . . . . . . . . .    N NUMB   0035H   A   
PWM_QTDADE_PERIODOS . . . . . . . . . .    N NUMB   0036H   A   
PWM_SQUARE_WAVE . . . . . . . . . . . .    C ADDR   019DH   A   
PWM_SQUARE_WAVE_CONFIG_PERIOD . . . . .    C ADDR   0185H   A   
PWM_SQUARE_WAVE_SETUP_AND_START . . . .    C ADDR   016FH   A   
PWM_STOP. . . . . . . . . . . . . . . .    C ADDR   019AH   A   
PX0 . . . . . . . . . . . . . . . . . .    B ADDR   00B8H.0 A   
RESETA_TIMER_MEDICOES . . . . . . . . .    C ADDR   0093H   A   
SETA_VARIAVEIS_INICIAIS . . . . . . . .    C ADDR   0079H   A   
TAB7SEG . . . . . . . . . . . . . . . .    C ADDR   0030H   A   
TF0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.5 A   
TF1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.7 A   
TH0 . . . . . . . . . . . . . . . . . .    D ADDR   008CH   A   
TH1 . . . . . . . . . . . . . . . . . .    D ADDR   008DH   A   
TIMER_CONFIGURA_TIMER . . . . . . . . .    C ADDR   013EH   A   
TIMER_DELAY_1_S . . . . . . . . . . . .    C ADDR   0168H   A   
TIMER_DELAY_20_MS . . . . . . . . . . .    C ADDR   0151H   A   
TIMER_MEDICOES_LOW. . . . . . . . . . .    N NUMB   0044H   A   
TIMER_MEDICOES_LSB. . . . . . . . . . .    N NUMB   0045H   A   
TIMER_MEDICOES_MSB. . . . . . . . . . .    N NUMB   0046H   A   
TIMER_SETA_VALORES_TIMER_PADRAO . . . .    C ADDR   014AH   A   
TL0 . . . . . . . . . . . . . . . . . .    D ADDR   008AH   A   
TL1 . . . . . . . . . . . . . . . . . .    D ADDR   008BH   A   
TMOD. . . . . . . . . . . . . . . . . .    D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.4 A   
TR1 . . . . . . . . . . . . . . . . . .    B ADDR   0088H.6 A   
VELOCIDADE_ACIMA_DO_LIMITE. . . . . . .    C ADDR   0126H   A   
VELOCIDADE_LIMITE . . . . . . . . . . .    N NUMB   0043H   A   
VELOCIDADE_VEICULO. . . . . . . . . . .    N NUMB   0042H   A   
VELOCIDADE_VEICULO_DEZENA . . . . . . .    N NUMB   0041H   A   
VELOCIDADE_VEICULO_UNIDADE. . . . . . .    N NUMB   0040H   A   
__STARTUP__ . . . . . . . . . . . . . .    C ADDR   0040H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
