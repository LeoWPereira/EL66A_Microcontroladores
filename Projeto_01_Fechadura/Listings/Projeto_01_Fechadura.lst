A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220CA           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223A2           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223A3           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223A4           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223A5           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223A6           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     COL1                    EQU P1.0

  0091                52     COL2                    EQU P1.1

  0092                53     COL3                    EQU P1.2

  0093                54     COL4                    EQU P1.3

                      55     

  0094                56     LIN1                    EQU P1.4

  0095                57     LIN2                    EQU P1.5

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     2

  0096                58     LIN3                    EQU P1.6

  0097                59     LIN4                    EQU P1.7

                      60             

                      61     

  00B0                62     BUZZER                  EQU P3.0        

                      63     

                      64     

  00B1                65     ESTADO_UM               EQU P3.1

  00B2                66     ESTADO_DOIS     EQU P3.2

  00B3                67     ESTADO_TRES     EQU P3.3

  00B4                68     ESTADO_QUATRO   EQU P3.4

                      69             

                      70     

  0031                71     TECLADO_1               EQU 31h

  0032                72     TECLADO_2               EQU 32h

  0033                73     TECLADO_3               EQU 33h

  0034                74     TECLADO_4               EQU 34h

                      75     

                      76     

  0035                77     SENHA1_1                EQU 35h

  0036                78     SENHA1_2                EQU 36h

  0037                79     SENHA1_3                EQU 37h

  0038                80     SENHA1_4                EQU 38h

                      81     

  0045                82     SENHA2_1                EQU 45h

  0046                83     SENHA2_2                EQU 46h

  0047                84     SENHA2_3                EQU 47h

  0048                85     SENHA2_4                EQU 48h

                      86     

  0050                87     TENTATIVAS      EQU 50h

                      88                     

                      89     

                      90     

                      91     

                      92     

2030                  93     org 2030h

2030                  94     SENHA_PADRAO_1:

2030 32383132         95                     db      '2812', 00H

2034 00                      
2035                  96     SENHA_PADRAO_2:

2035 30393132         97                     db      '0912', 00H

2039 00                      
203A                  98     STR_LOGO:

203A 2050524F         99             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 100     STR_LEONARDO_PEREIRA:

204B 4C656F6E        101             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 102     STR_RODRIGO_ENDO:

205C 2020526F        103             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 104     STR_SENHA:

206D 53454E48        105             DB      'SENHA: ',00H

2071 413A2000                
2075                 106     STR_SENHA_VALIDA:

2075 20205345        107             DB      '  SENHA VALIDA  ',00H

2079 4E484120                
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     3

207D 56414C49                
2081 44412020                
2085 00                      
2086                 108     STR_SENHA_INVALIDA:

2086 2053454E        109             DB      ' SENHA INVALIDA ',00H

208A 48412049                
208E 4E56414C                
2092 49444120                
2096 00                      
2097                 110     STR_LIBERANDO_PORTA:

2097 4C494245        111             DB      'LIBERANDO PORTA ',00H

209B 52414E44                
209F 4F20504F                
20A3 52544120                
20A7 00                      
20A8                 112     STR_TRANCANDO_PORTA:

20A8 5452414E        113             DB      'TRANCANDO PORTA ',00H          

20AC 43414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 114     STR_SISTEMA_BLOQUEADO:

20B9 504F5254        115             DB      'PORTA BLOQUEADA ',00H          

20BD 4120424C                
20C1 4F515545                
20C5 41444120                
20C9 00                      
                     116                     

                     117     

                     118     

                     119     

                     120     

20CA                 121     __STARTUP__:

20CA 7183            122                     CALL    TIMER_CONFIGURA_TIMER

                     123     

20CC 780F            124                     MOV     R0, #0Fh                 

20CE 122252          125                     LCALL   ACIONA_BUZZER

                     126     

20D1 902030          127                     MOV     DPTR, #2030h     

20D4 7800            128                     MOV     R0, #00h             

20D6 7935            129                     MOV     R1, #SENHA1_1    

20D8 7A04            130                     MOV     R2, #04h                 

20DA 312E            131                     CALL    LE_SENHA

                     132             

20DC 902035          133                     MOV     DPTR, #2035h     

20DF 7800            134                     MOV     R0, #00h                 

20E1 7945            135                     MOV     R1, #SENHA2_1    

20E3 7A04            136                     MOV     R2, #04h                 

20E5 312E            137                     CALL    LE_SENHA

                     138             

20E7 755003          139                     MOV     TENTATIVAS, #3h  

                     140             

20EA                 141     MAIN:

20EA 51BF            142                     CALL    INIDISP                  

20EC 90203A          143                     MOV     DPTR,#STR_LOGO   

20EF 7167            144                     CALL    ESC_STR1                 

                     145                     

                     146                     

20F1 7901            147                     MOV             R1, #01h

20F3 719B            148                     CALL    TIMER_DELAY_1_S

                     149                     

20F5 7107            150                     CALL    CLR1L    

                     151                     

20F7 90204B          152                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

20FA 7167            153                     CALL    ESC_STR1                                         

                     154                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     4

20FC 90205C          155                     MOV     DPTR, #STR_RODRIGO_ENDO          

20FF 716D            156                     CALL    ESC_STR2                                         

                     157                     

                     158                     

2101 7901            159                     MOV             R1, #01h

2103 719B            160                     CALL    TIMER_DELAY_1_S

                     161     

2105                 162     LIMPA_LCD_E_INICIA_SISTEMA:

                     163                     

2105 7107            164                     CALL    CLR1L

2107 7120            165                     CALL    CLR2L

                     166                     

2109 90206D          167                     MOV     DPTR,#STR_SENHA  

210C 7167            168                     CALL    ESC_STR1                 

                     169                     

                     170                     

210E 7800            171                     MOV     R0, #00h         

2110 7907            172                     MOV     R1, #07h         

2112 51F5            173                     CALL    GOTOXY

                     174                     

2114 7931            175                     MOV     R1, #TECLADO_1   

2116 7B01            176                     MOV     R3, #1h                  

2118 7F04            177                     MOV     R7, #04h                 

211A                 178     LE_4_DIGITOS:

211A 780A            179                     MOV     R0, #0Ah                 

211C 7187            180                     ACALL   TIMER_DELAY_20_MS

                     181                     

211E 3165            182                     ACALL   VARREDURA_TECLADO        

2120 3140            183                     CALL    ESCREVE_ASTERISCO        

                     184                     

2122 09              185                     INC R1   

2123 0B              186                     INC R3  

                     187                     

2124 DFF4            188                     DJNZ R7, LE_4_DIGITOS

                     189                     

                     190                     

2126 780A            191                     MOV     R0, #0Ah                 

2128 7187            192                     ACALL   TIMER_DELAY_20_MS

                     193                     

212A 314A            194                     ACALL   PRESS_ENT                

                     195                     

212C 80D7            196                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     197     

                     198     

                     199     

                     200     

                     201     

                     202     

                     203     

                     204     

                     205     

                     206     

                     207     

212E                 208     LE_SENHA:

212E 3134            209             call LE_SENHA_ROM

                     210             

2130 09              211             INC R1

                     212             

2131 DAFB            213             djnz R2, LE_SENHA

                     214             

2133 22              215             RET

                     216     

2134                 217     LE_SENHA_ROM:

2134 E8              218             mov A, R0

2135 93              219             movc A, @A + DPTR

2136 F7              220             mov @R1, A

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     5

                     221             

2137 08              222             inc R0

                     223             

2138 313B            224             call CONV_ASCII_TO_NUMBER

                     225             

213A 22              226             RET

                     227             

                     228     

                     229     

                     230     

                     231     

                     232     

                     233     

                     234     

                     235     

213B                 236     CONV_ASCII_TO_NUMBER:

213B E7              237                     MOV     A, @R1

                     238             

213C 24D0            239                     ADD     A, #-30h

                     240             

213E F7              241                     MOV     @R1, A

                     242             

213F 22              243                     RET

                     244             

                     245     

                     246     

                     247     

                     248     

                     249     

                     250     

                     251     

2140                 252     ESCREVE_ASTERISCO:              

2140 7805            253                     MOV     R0, #05h

2142 122252          254                     LCALL   ACIONA_BUZZER

                     255                     

2145 742A            256                     MOV     A, #2Ah

2147 7139            257                     CALL    ESCDADO

                     258             

2149 22              259                     RET

                     260                     

                     261     

                     262     

                     263     

                     264     

                     265     

                     266     

                     267     

                     268     

214A                 269     PRESS_ENT:

214A D294            270                     SETB    LIN1

214C D295            271                     SETB    LIN2

214E D296            272                     SETB    LIN3

2150 C297            273                     CLR     LIN4

2152 309105          274                     JNB     COL2, CLEAR                      

2155 309372          275                     JNB     COL4, TESTA_SENHA1       

2158 80F0            276                     JMP     PRESS_ENT

                     277     

                     278     

                     279     

                     280     

                     281     

                     282     

                     283     

                     284     

                     285     

                     286     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     6

215A                 287     CLEAR: 

215A 7805            288                     MOV     R0, #05h

215C 122252          289                     LCALL   ACIONA_BUZZER

                     290                     

215F D0E0            291                     POP             ACC

2161 D0E0            292                     POP             ACC

2163 80A0            293                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     294                     

                     295     

                     296     

                     297     

                     298     

                     299     

                     300     

                     301     

2165                 302     VARREDURA_TECLADO:

2165 C294            303                     CLR  LIN1

2167 D295            304                     SETB LIN2

2169 D296            305                     SETB LIN3

216B D297            306                     SETB LIN4

216D 30912D          307                     JNB  COL2, DIGITO1

2170 30922E          308                     JNB  COL3, DIGITO2

2173 30932F          309                     JNB  COL4, DIGITO3

                     310                     

2176 C295            311                     CLR  LIN2

2178 D294            312                     SETB LIN1

217A 30912C          313                     JNB  COL2, DIGITO4

217D 30922D          314                     JNB  COL3, DIGITO5

2180 30932E          315                     JNB  COL4, DIGITO6

                     316                     

2183 C296            317                     CLR  LIN3

2185 D295            318                     SETB LIN2

2187 30912B          319                     JNB  COL2, DIGITO7

218A 30922C          320                     JNB  COL3, DIGITO8

218D 30932D          321                     JNB  COL4, DIGITO9

                     322                     

2190 C297            323                     CLR  LIN4

2192 D296            324                     SETB LIN3

2194 3091C3          325                     JNB  COL2, CLEAR

2197 309227          326                     JNB  COL3, DIGITO0

219A 80C9            327                     JMP  VARREDURA_TECLADO

                     328                     

219C 22              329                     RET

                     330                     

                     331     

                     332     

                     333     

                     334     

                     335     

                     336     

                     337     

                     338     

219D 7401            339     DIGITO1: MOV A, #1h

219F 21C5            340                      AJMP GRAVA_DIGITO

21A1 7402            341     DIGITO2: MOV A, #2h

21A3 21C5            342                      AJMP GRAVA_DIGITO

21A5 7403            343     DIGITO3: MOV A, #3h

21A7 21C5            344                      AJMP GRAVA_DIGITO

21A9 7404            345     DIGITO4: MOV A, #4h

21AB 21C5            346                      AJMP GRAVA_DIGITO

21AD 7405            347     DIGITO5: MOV A, #5h

21AF 21C5            348                      AJMP GRAVA_DIGITO

21B1 7406            349     DIGITO6: MOV A, #6h

21B3 21C5            350                      AJMP GRAVA_DIGITO

21B5 7407            351     DIGITO7: MOV A, #7h

21B7 21C5            352                      AJMP GRAVA_DIGITO

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     7

21B9 7408            353     DIGITO8: MOV A, #8h

21BB 21C5            354                      AJMP GRAVA_DIGITO

21BD 7409            355     DIGITO9: MOV A, #9h

21BF 21C5            356                      AJMP GRAVA_DIGITO

21C1 7400            357     DIGITO0: MOV A, #0h

21C3 21C5            358                      AJMP GRAVA_DIGITO

                     359                      

21C5                 360     GRAVA_DIGITO:

21C5 BB017C          361                     CJNE R3, #1h, GRAVA_TECLADO_2

21C8 F7              362                     MOV @R1, A

                     363             

21C9 22              364                     RET

                     365     

                     366     

                     367     

                     368     

                     369     

                     370     

                     371     

                     372     

                     373     

21CA                 374     TESTA_SENHA1:

21CA 7805            375                     MOV     R0, #05h

21CC 122252          376                     LCALL   ACIONA_BUZZER

                     377                     

21CF E535            378                     MOV             A, SENHA1_1

21D1 B53111          379                     CJNE    A, TECLADO_1, TESTA_SENHA2

21D4 E536            380                     MOV             A, SENHA1_2

21D6 B5320C          381                     CJNE    A, TECLADO_2, TESTA_SENHA2

21D9 E537            382                     MOV             A, SENHA1_3

21DB B53307          383                     CJNE    A, TECLADO_3, TESTA_SENHA2

21DE E538            384                     MOV             A, SENHA1_4

21E0 B53402          385                     CJNE    A, TECLADO_4, TESTA_SENHA2

21E3 8035            386                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     387             

21E5                 388     TESTA_SENHA2:

21E5 E545            389                     MOV             A, SENHA2_1

21E7 B53111          390                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

21EA E546            391                     MOV             A, SENHA2_2

21EC B5320C          392                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

21EF E547            393                     MOV             A, SENHA2_3

21F1 B53307          394                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

21F4 E548            395                     MOV             A, SENHA2_4

21F6 B53402          396                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

21F9 801F            397                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     398                     

21FB                 399     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     400                     

21FB 7107            401                     CALL    CLR1L

21FD 7120            402                     CALL    CLR2L

                     403                     

21FF 902086          404                     MOV     DPTR,#STR_SENHA_INVALIDA         

2202 7167            405                     CALL    ESC_STR1                                         

                     406                     

                     407                     

2204 7864            408                     MOV     R0, #064h

2206 122252          409                     LCALL   ACIONA_BUZZER

                     410                     

                     411                     

2209 7901            412                     MOV             R1, #01h

220B 719B            413                     CALL    TIMER_DELAY_1_S

                     414                     

220D D55009          415                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     416                     

2210 7107            417                     CALL    CLR1L

2212 9020B9          418                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     8

2215 7167            419                     CALL    ESC_STR1                                         

                     420                     

2217 61A7            421                     JMP     FIM

                     422     

2219                 423     REINICIA_SISTEMA:

2219 22              424                     RET

                     425                     

221A                 426     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

221A 755003          427                     MOV     TENTATIVAS, #3h  

                     428                     

                     429                     

221D 7107            430                     CALL    CLR1L

221F 7120            431                     CALL    CLR2L

                     432                     

2221 902075          433                     MOV     DPTR,#STR_SENHA_VALIDA   

2224 7167            434                     CALL    ESC_STR1                                 

                     435                     

                     436                     

2226 7832            437                     MOV     R0, #032h

2228 122252          438                     LCALL   ACIONA_BUZZER

                     439                     

222B 902097          440                     MOV     DPTR, #STR_LIBERANDO_PORTA       

222E 716D            441                     CALL    ESC_STR2                                         

                     442                     

2230 7D1A            443                     MOV     R5, #1Ah

2232 122259          444                     LCALL   ABRE_FECHADURA

                     445                     

                     446                     

2235 7903            447                     MOV             R1, #03h

2237 719B            448                     CALL    TIMER_DELAY_1_S

                     449                     

2239 9020A8          450                     MOV     DPTR, #STR_TRANCANDO_PORTA       

223C 716D            451                     CALL    ESC_STR2                                         

                     452                     

223E 7D1A            453                     MOV     R5, #1Ah

2240 12228C          454                     LCALL   TRANCA_FECHADURA

                     455                     

2243 22              456                     RET

                     457                      

                     458     

                     459     

                     460     

                     461     

                     462     

                     463     

                     464     

2244 BB0202          465     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

2247 4150            466                                      AJMP GRAVA_TECLADO_X

2249 BB0302          467     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

224C 4150            468                                      AJMP GRAVA_TECLADO_X           

224E 4150            469     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X

                     470     

2250                 471     GRAVA_TECLADO_X:

2250 F7              472                      MOV @R1, A

                     473                      

2251 22              474                      RET

                     475                      

                     476     

                     477     

                     478     

                     479     

2252                 480     ACIONA_BUZZER:

2252 D2B0            481                     SETB    BUZZER

2254 7187            482                     ACALL   TIMER_DELAY_20_MS

2256 C2B0            483                     CLR     BUZZER

                     484                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE     9

2258 22              485                     RET

                     486                     

                     487     

                     488     

                     489     

2259                 490     ABRE_FECHADURA:

2259 C2B2            491                     CLR             ESTADO_DOIS

225B C2B3            492                     CLR             ESTADO_TRES

225D C2B4            493                     CLR             ESTADO_QUATRO

225F D2B1            494                     SETB    ESTADO_UM

                     495                     

2261 7805            496                     MOV     R0, #05h

2263 7187            497                     ACALL   TIMER_DELAY_20_MS

                     498                     

2265 D2B2            499                     SETB    ESTADO_DOIS

2267 C2B3            500                     CLR             ESTADO_TRES

2269 C2B4            501                     CLR             ESTADO_QUATRO

226B C2B1            502                     CLR             ESTADO_UM

                     503                     

226D 7805            504                     MOV     R0, #05h

226F 7187            505                     ACALL   TIMER_DELAY_20_MS

                     506                     

2271 C2B2            507                     CLR             ESTADO_DOIS

2273 D2B3            508                     SETB    ESTADO_TRES

2275 C2B4            509                     CLR             ESTADO_QUATRO

2277 C2B1            510                     CLR             ESTADO_UM

                     511                     

2279 7805            512                     MOV     R0, #05h

227B 7187            513                     ACALL   TIMER_DELAY_20_MS

                     514                     

227D C2B2            515                     CLR             ESTADO_DOIS

227F C2B3            516                     CLR             ESTADO_TRES

2281 D2B4            517                     SETB    ESTADO_QUATRO

2283 C2B1            518                     CLR             ESTADO_UM

                     519                     

2285 7805            520                     MOV     R0, #05h

2287 7187            521                     ACALL   TIMER_DELAY_20_MS

                     522                     

2289 DDCE            523                     DJNZ    R5, ABRE_FECHADURA

                     524                     

228B 22              525                     RET

                     526                     

228C                 527     TRANCA_FECHADURA:

228C C2B2            528                     CLR             ESTADO_DOIS

228E C2B3            529                     CLR             ESTADO_TRES

2290 D2B4            530                     SETB    ESTADO_QUATRO

2292 C2B1            531                     CLR             ESTADO_UM

                     532                     

2294 7805            533                     MOV     R0, #05h

2296 7187            534                     ACALL   TIMER_DELAY_20_MS

                     535                     

2298 C2B2            536                     CLR             ESTADO_DOIS

229A D2B3            537                     SETB    ESTADO_TRES

229C C2B4            538                     CLR             ESTADO_QUATRO

229E C2B1            539                     CLR             ESTADO_UM

                     540                     

22A0 7805            541                     MOV     R0, #05h

22A2 7187            542                     ACALL   TIMER_DELAY_20_MS

                     543                     

22A4 D2B2            544                     SETB    ESTADO_DOIS

22A6 C2B3            545                     CLR             ESTADO_TRES

22A8 C2B4            546                     CLR             ESTADO_QUATRO

22AA C2B1            547                     CLR             ESTADO_UM

                     548                     

22AC 7805            549                     MOV     R0, #05h

22AE 7187            550                     ACALL   TIMER_DELAY_20_MS

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    10

                     551                     

22B0 C2B2            552                     CLR             ESTADO_DOIS

22B2 C2B3            553                     CLR             ESTADO_TRES

22B4 C2B4            554                     CLR             ESTADO_QUATRO

22B6 D2B1            555                     SETB    ESTADO_UM

                     556                     

22B8 7805            557                     MOV     R0, #05h

22BA 7187            558                     ACALL   TIMER_DELAY_20_MS

                     559                     

22BC DDCE            560                     DJNZ    R5, TRANCA_FECHADURA

                     561     

22BE 22              562                     RET

                     563     

                     564     

                     565     

                     566             

                     567     

                     568     

                     569     

                     570     

                     571     

                     572     

                     573     

                     574     

                     575     

22BF                 576     INIDISP:                       

22BF 7838            577             MOV     R0,#38H          

22C1 7A05            578             MOV     R2,#05           

22C3 51DE            579             CALL    ESCINST          

                     580             

22C5 7838            581                     MOV     R0,#38H          

22C7 7A01            582             MOV     R2,#01           

22C9 51DE            583             CALL    ESCINST          

                     584             

22CB 7806            585                     MOV     R0,#06H          

22CD 7A01            586             MOV     R2,#01           

22CF 51DE            587             CALL    ESCINST          

                     588             

22D1 780C            589                     MOV     R0,#0CH          

22D3 7A01            590             MOV     R2,#01           

22D5 51DE            591             CALL    ESCINST          

                     592             

22D7 7801            593                     MOV     R0,#01H          

22D9 7A02            594             MOV     R2,#02           

22DB 51DE            595             CALL    ESCINST          

                     596             

22DD 22              597                     RET

                     598                     

                     599     

                     600     

                     601     

                     602     

                     603     

                     604     

                     605     

                     606     

                     607     

22DE                 608     ESCINST:  

22DE C2A6            609                     CLR             RW                               

22E0 C2A5            610                     CLR     RS               

22E2 D2A7            611                     SETB    E_LCD            

                     612                     

22E4 8880            613                     MOV     P0,R0            

                     614                     

22E6 C2A7            615                     CLR     E_LCD            

                     616                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    11

22E8 7580FF          617                     MOV             P0,#0xFF                 

                     618                     

22EB D2A6            619                     SETB    RW                               

22ED D2A7            620                     SETB    E_LCD            

                     621     

22EF 2087FD          622     ESCI1:  JB      BUSYF,ESCI1                      

                     623                     

22F2 C2A7            624                     CLR     E_LCD            

                     625             

22F4 22              626                     RET

                     627                     

                     628     

                     629     

                     630     

                     631     

                     632     

                     633     

                     634     

                     635     

22F5                 636     GOTOXY: 

22F5 C0E0            637                     PUSH    ACC

                     638             

22F7 7480            639                     MOV     A,#80H

22F9 B80102          640             CJNE    R0,#01,GT1       

                     641             

22FC 74C0            642                     MOV     A,#0C0H

                     643                     

22FE 49              644     GT1:    ORL     A,R1             

22FF F8              645             MOV     R0,A

2300 7A01            646             MOV     R2,#01           

                     647             

2302 51DE            648                     CALL    ESCINST          

                     649             

2304 D0E0            650                     POP     ACC

                     651             

2306 22              652                     RET

                     653             

                     654     

                     655     

                     656     

                     657     

                     658     

                     659     

                     660     

                     661     

2307                 662     CLR1L:    

2307 C0E0            663             PUSH   ACC

                     664             

2309 7800            665                     MOV    R0,#00               

230B 7900            666             MOV    R1,#00

                     667             

230D 51F5            668                     CALL   GOTOXY

                     669             

230F 7910            670                     MOV    R1,#16               

                     671     

2311 7420            672     CLR1L1: MOV    A,#' '               

                     673             

2313 7139            674                     CALL   ESCDADO

                     675             

2315 D9FA            676                     DJNZ   R1,CLR1L1

2317 7800            677             MOV    R0,#00               

2319 7900            678             MOV    R1,#00

                     679             

231B 51F5            680                     CALL   GOTOXY

                     681             

231D D0E0            682                     POP    ACC

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    12

                     683             

231F 22              684                     RET

                     685                     

                     686     

                     687     

                     688     

                     689     

                     690     

                     691     

                     692     

                     693     

2320                 694     CLR2L:    

2320 C0E0            695             PUSH   ACC

                     696             

2322 7801            697                     MOV    R0,#01               

2324 7900            698             MOV    R1,#00

                     699             

2326 51F5            700                     CALL   GOTOXY

                     701             

2328 7910            702                     MOV    R1,#16               

                     703     

232A 7420            704     CLR2L1: MOV    A,#' '               

                     705             

232C 7139            706                     CALL   ESCDADO

                     707             

232E D9FA            708                     DJNZ   R1,CLR2L1

2330 7801            709             MOV    R0,#01               

2332 7900            710             MOV    R1,#00

                     711             

2334 51F5            712                     CALL   GOTOXY

                     713             

2336 D0E0            714                     POP    ACC

                     715             

2338 22              716                     RET

                     717                

                     718     

                     719     

                     720     

                     721     

                     722     

                     723     

                     724     

2339                 725     ESCDADO:  

2339 C2A6            726                     CLR             RW                               

233B D2A5            727             SETB    RS               

233D D2A7            728             SETB    E_LCD            

                     729                     

233F F580            730             MOV     P0,A             

                     731             

2341 C2A7            732                     CLR     E_LCD            

                     733                     

2343 7580FF          734                     MOV             P0,#0xFF                 

                     735                     

2346 D2A6            736                     SETB    RW                               

2348 C2A5            737                     CLR             RS                               

234A D2A7            738                     SETB    E_LCD            

                     739     

234C 2087FD          740     ESCD1:  JB              BUSYF,ESCD1              

                     741     

234F C2A7            742                     CLR     E_LCD            

                     743     

2351 22              744             RET

                     745                     

                     746     

                     747     

                     748     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    13

                     749     

                     750     

                     751     

                     752     

                     753     

                     754     

2352                 755     MSTRING:  

2352 E4              756                       CLR    A

2353 93              757               MOVC   A,@A+DPTR       

                     758               

2354 6006            759                       JZ     MSTR1

                     760               

2356 122339          761                       LCALL  ESCDADO         

                     762               

2359 A3              763                       INC    DPTR

                     764               

235A 80F6            765                       SJMP   MSTRING

                     766                       

235C 22              767     MSTR1:    RET

                     768                

                     769     

                     770     

                     771     

                     772     

                     773     

                     774     

                     775     

                     776     

                     777     

235D                 778     MSTRINGX: 

235D E0              779                       MOVX   A,@DPTR         

                     780               

235E 6006            781                       JZ     MSTR21

                     782               

2360 122339          783                       LCALL  ESCDADO         

                     784               

2363 A3              785                       INC    DPTR

                     786               

2364 80F7            787                       SJMP   MSTRINGX

                     788     

2366 22              789     MSTR21:   RET

                     790     

                     791     

                     792     

                     793     

                     794     

                     795     

                     796     

                     797     

                     798     

                     799     

2367                 800     ESC_STR1: 

                     801                       

2367 7800            802                       MOV    R0,#00         

2369 7900            803               MOV    R1,#00

                     804               

236B 8004            805                       JMP    ESC_S

                     806               

                     807     

                     808     

                     809     

                     810     

                     811     

                     812     

                     813     

                     814     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    14

                     815     

236D                 816     ESC_STR2: 

                     817                       

236D 7801            818                       MOV    R0,#01         

236F 7900            819               MOV    R1,#00

                     820                       

2371 1222F5          821     ESC_S:    LCALL  GOTOXY          

                     822               

2374 122352          823                       LCALL  MSTRING

                     824               

2377 22              825                       RET

                     826     

                     827     

                     828     

                     829     

                     830     

                     831     

                     832     

                     833     ; DESTROI: R0,R2                                                                        //

                     834     

2378                 835     CUR_ON:   

2378 780F            836                       MOV    R0,#0FH               

237A 8002            837               SJMP   CUR1

                     838                       

237C                 839     CUR_OFF:  

237C 780C            840                       MOV    R0,#0CH               

                     841                       

237E 7A01            842     CUR1:     MOV    R2,#01

                     843               

2380 51DE            844                       CALL   ESCINST               

                     845               

2382 22              846                       RET

                     847                       

                     848     

                     849     

                     850     

                     851                       

2383                 852     TIMER_CONFIGURA_TIMER:

2383 758901          853                     MOV TMOD, #01h  

                     854             

2386 22              855                     RET

                     856             

                     857     

                     858     

                     859     

                     860     

                     861     

                     862     

                     863     

2387                 864     TIMER_DELAY_20_MS:

2387 758C56          865                     MOV TH0, #HIGH(65535 - 43350)

238A 758AA9          866                     MOV TL0, #LOW(65535 - 43350)

                     867             

238D C28D            868                     CLR TF0

238F D28C            869                     SETB TR0

                     870             

2391 308DFD          871                     JNB TF0, $

                     872                     

2394 C28D            873                     CLR TF0

2396 C28C            874                     CLR TR0

                     875             

2398 D8ED            876                     DJNZ R0, TIMER_DELAY_20_MS

                     877             

239A 22              878                     RET

                     879             

                     880     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    15

                     881     

                     882     

                     883     

                     884     

                     885     

                     886     

239B                 887     TIMER_DELAY_1_S:

239B 7832            888                     MOV             R0, #50d

239D 7187            889                     CALL    TIMER_DELAY_20_MS

                     890                     

239F D9FA            891                     DJNZ    R1, TIMER_DELAY_1_S

                     892             

23A1 22              893                     RET

                     894     

                     895     

                     896     

                     897     

                     898     

                     899     

                     900     

                     901     

23A2                 902     INT_INT0:

23A2 32              903                     RETI

                     904     

                     905     

                     906     

                     907     

23A3                 908     INT_TIMER0:

23A3 32              909                     RETI

                     910             

                     911     

                     912     

                     913     

23A4                 914     INT_INT1:

23A4 32              915                     RETI

                     916     

                     917     

                     918     

                     919     

23A5                 920     INT_TIMER1:

23A5 32              921                     RETI

                     922             

                     923     

                     924     

                     925     

23A6                 926     INT_SERIAL:

23A6 32              927                     RETI

                     928             

23A7                 929     FIM:

                     930                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    16

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   2259H   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   2252H   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   215AH   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   2307H   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   2311H   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   2320H   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   232AH   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   213BH   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   237EH   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   237CH   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   2378H   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21C1H   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   219DH   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21A1H   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21A5H   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21A9H   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21ADH   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21B1H   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21B5H   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21B9H   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21BDH   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   234CH   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   2339H   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   22EFH   A   
ESCINST . . . . . . . . . . . . .  C ADDR   22DEH   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   2140H   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   2371H   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   2367H   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   236DH   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23A7H   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   22F5H   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21C5H   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   2244H   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   2249H   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   224EH   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   2250H   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   22FEH   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22BFH   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23A2H   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23A4H   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23A6H   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23A3H   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23A5H   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   211AH   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   212EH   A   
LE_SENHA_ROM. . . . . . . . . . .  C ADDR   2134H   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/03/2017 21:47:32 PAGE    17

LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2105H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   21FBH   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   221AH   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   20EAH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   235CH   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   2366H   A   
MSTRING . . . . . . . . . . . . .  C ADDR   2352H   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   235DH   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   214AH   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   2219H   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   2097H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2086H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2075H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20B9H   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21CAH   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   21E5H   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   2383H   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   239BH   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   2387H   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   228CH   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   2165H   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20CAH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
