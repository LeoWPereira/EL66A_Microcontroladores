A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220EC           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223C8           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223C9           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223CA           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223CB           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223CC           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     TECLADO                 EQU     P1

                      52     

  0090                53     COL1                    EQU P1.0

  0091                54     COL2                    EQU P1.1

  0092                55     COL3                    EQU P1.2

  0093                56     COL4                    EQU P1.3

                      57     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     2

  0094                58     LIN1                    EQU P1.4

  0095                59     LIN2                    EQU P1.5

  0096                60     LIN3                    EQU P1.6

  0097                61     LIN4                    EQU P1.7

                      62             

                      63     

  00B0                64     BUZZER                  EQU P3.0        

                      65     

                      66     

  00B1                67     ESTADO_UM               EQU P3.1

  00B2                68     ESTADO_DOIS     EQU P3.2

  00B3                69     ESTADO_TRES     EQU P3.3

  00B4                70     ESTADO_QUATRO   EQU P3.4

                      71             

                      72     

  0031                73     TECLADO_1               EQU 31h

  0032                74     TECLADO_2               EQU 32h

  0033                75     TECLADO_3               EQU 33h

  0034                76     TECLADO_4               EQU 34h

                      77     

                      78     

  0035                79     SENHA1_1                EQU 35h

  0036                80     SENHA1_2                EQU 36h

  0037                81     SENHA1_3                EQU 37h

  0038                82     SENHA1_4                EQU 38h

                      83     

  0045                84     SENHA2_1                EQU 45h

  0046                85     SENHA2_2                EQU 46h

  0047                86     SENHA2_3                EQU 47h

  0048                87     SENHA2_4                EQU 48h

                      88     

  0050                89     TENTATIVAS      EQU 50h

                      90                     

                      91     

                      92     

                      93     

                      94     

2030                  95     org 2030h

2030                  96     SENHA_PADRAO_1:

2030 32383132         97                     db      '2812', 00H

2034 00                      
2035                  98     SENHA_PADRAO_2:

2035 30393132         99                     db      '0912', 00H

2039 00                      
203A                 100     STR_LOGO:

203A 2050524F        101             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 102     STR_LEONARDO_PEREIRA:

204B 4C656F6E        103             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 104     STR_RODRIGO_ENDO:

205C 2020526F        105             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 106     STR_SENHA:

206D 53454E48        107             DB      'SENHA: ',00H

2071 413A2000                
2075                 108     STR_PRESSIONE_ENTER:

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     3

2075 50524553        109             DB      'PRESSIONE ENTER ',00H

2079 53494F4E                
207D 4520454E                
2081 54455220                
2085 00                      
2086                 110     STR_SENHA_VALIDA:

2086 20205345        111             DB      '  SENHA VALIDA  ',00H

208A 4E484120                
208E 56414C49                
2092 44412020                
2096 00                      
2097                 112     STR_SENHA_INVALIDA:

2097 2053454E        113             DB      ' SENHA INVALIDA ',00H

209B 48412049                
209F 4E56414C                
20A3 49444120                
20A7 00                      
20A8                 114     STR_LIBERANDO_PORTA:

20A8 4C494245        115             DB      'LIBERANDO PORTA ',00H

20AC 52414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 116     STR_TRANCANDO_PORTA:

20B9 5452414E        117             DB      'TRANCANDO PORTA ',00H          

20BD 43414E44                
20C1 4F20504F                
20C5 52544120                
20C9 00                      
20CA                 118     STR_SISTEMA_BLOQUEADO:

20CA 504F5254        119             DB      'PORTA BLOQUEADA ',00H

20CE 4120424C                
20D2 4F515545                
20D6 41444120                
20DA 00                      
20DB                 120     STR_TIMEOUT:

20DB 20202020        121             DB      '    TIMEOUT     ',00H                  

20DF 54494D45                
20E3 4F555420                
20E7 20202020                
20EB 00                      
                     122                     

                     123     

                     124     

                     125     

                     126     

20EC                 127     __STARTUP__:

20EC 71A9            128                     CALL    TIMER_CONFIGURA_TIMER

                     129     

20EE 780F            130                     MOV     R0, #0Fh                 

20F0 122278          131                     LCALL   ACIONA_BUZZER

                     132     

20F3 902030          133                     MOV     DPTR, #2030h     

20F6 7800            134                     MOV     R0, #00h             

20F8 7935            135                     MOV     R1, #SENHA1_1    

20FA 7A04            136                     MOV     R2, #04h                 

20FC 3159            137                     CALL    LE_SENHA

                     138             

20FE 902035          139                     MOV     DPTR, #2035h     

2101 7800            140                     MOV     R0, #00h                 

2103 7945            141                     MOV     R1, #SENHA2_1    

2105 7A04            142                     MOV     R2, #04h                 

2107 3159            143                     CALL    LE_SENHA

                     144             

2109 755003          145                     MOV     TENTATIVAS, #3h  

                     146             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     4

210C                 147     MAIN:

210C 51E5            148                     CALL    INIDISP                  

210E 90203A          149                     MOV     DPTR,#STR_LOGO   

2111 718D            150                     CALL    ESC_STR1                 

                     151                     

                     152                     

2113 7901            153                     MOV             R1, #01h

2115 71C1            154                     CALL    TIMER_DELAY_1_S

                     155                     

2117 712D            156                     CALL    CLR1L    

                     157                     

2119 90204B          158                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

211C 718D            159                     CALL    ESC_STR1                                         

                     160                     

211E 90205C          161                     MOV     DPTR, #STR_RODRIGO_ENDO          

2121 7193            162                     CALL    ESC_STR2                                         

                     163                     

                     164                     

2123 7901            165                     MOV             R1, #01h

2125 71C1            166                     CALL    TIMER_DELAY_1_S

                     167     

2127                 168     LIMPA_LCD_E_INICIA_SISTEMA:

                     169                     

2127 712D            170                     CALL    CLR1L

2129 7146            171                     CALL    CLR2L

                     172                     

                     173                     

212B 902075          174                     MOV     DPTR,#STR_PRESSIONE_ENTER        

212E 718D            175                     CALL    ESC_STR1                                         

                     176                     

2130 3175            177                     ACALL   PRESS_ENT                

                     178                     

2132 712D            179                     CALL    CLR1L

                     180                     

                     181                     

2134 90206D          182                     MOV     DPTR,#STR_SENHA  

2137 718D            183                     CALL    ESC_STR1                 

                     184                     

                     185                     

2139 7800            186                     MOV     R0, #00h         

213B 7907            187                     MOV     R1, #07h         

213D 711B            188                     CALL    GOTOXY

                     189                     

213F 7931            190                     MOV     R1, #TECLADO_1   

2141 7B01            191                     MOV     R3, #1h                  

2143 7F04            192                     MOV     R7, #04h                 

2145                 193     LE_4_DIGITOS:

2145 780A            194                     MOV     R0, #0Ah                 

2147 71AD            195                     ACALL   TIMER_DELAY_20_MS

                     196                     

2149 318B            197                     ACALL   VARREDURA_TECLADO        

214B 316B            198                     CALL    ESCREVE_ASTERISCO        

                     199                     

214D 09              200                     INC R1   

214E 0B              201                     INC R3  

                     202                     

214F DFF4            203                     DJNZ R7, LE_4_DIGITOS  

                     204                     

                     205                     

2151 780A            206                     MOV     R0, #0Ah                 

2153 71AD            207                     ACALL   TIMER_DELAY_20_MS

                     208                     

2155 3175            209                     ACALL   PRESS_ENT                

                     210                     

2157 80CE            211                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     212     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     5

                     213     

                     214     

                     215     

                     216     

                     217     

                     218     

                     219     

                     220     

                     221     

                     222     

2159                 223     LE_SENHA:

2159 315F            224                     CALL    LE_SENHA_ROM

                     225             

215B 09              226                     INC     R1

                     227             

215C DAFB            228                     DJNZ    R2, LE_SENHA

                     229             

215E 22              230                     RET

                     231     

215F                 232     LE_SENHA_ROM:

215F E8              233                     MOV     A, R0

2160 93              234                     MOVC    A, @A + DPTR

2161 F7              235                     MOV             @R1, A

                     236             

2162 08              237                     INC             R0

                     238             

2163 3166            239                     CALL    CONV_ASCII_TO_NUMBER

                     240             

2165 22              241                     RET

                     242             

                     243     

                     244     

                     245     

                     246     

                     247     

                     248     

                     249     

                     250     

2166                 251     CONV_ASCII_TO_NUMBER:

2166 E7              252                     MOV     A, @R1

                     253             

2167 24D0            254                     ADD     A, #-30h

                     255             

2169 F7              256                     MOV     @R1, A

                     257             

216A 22              258                     RET

                     259             

                     260     

                     261     

                     262     

                     263     

                     264     

                     265     

                     266     

216B                 267     ESCREVE_ASTERISCO:              

216B 7805            268                     MOV     R0, #05h

216D 122278          269                     LCALL   ACIONA_BUZZER

                     270                     

2170 742A            271                     MOV     A, #2Ah  

2172 715F            272                     CALL    ESCDADO

                     273             

2174 22              274                     RET

                     275                     

                     276     

                     277     

                     278     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     6

                     279     

                     280     

                     281     

                     282     

                     283     

2175                 284     PRESS_ENT:

2175 75907F          285                     MOV             TECLADO, #01111111b      

                     286                     

2178 309105          287                     JNB     COL2, CLEAR                      

217B 309372          288                     JNB     COL4, TESTA_SENHA1       

                     289                     

217E 80F5            290                     JMP     PRESS_ENT

                     291     

                     292     

                     293     

                     294     

                     295     

                     296     

                     297     

                     298     

                     299     

                     300     

2180                 301     CLEAR: 

2180 7805            302                     MOV     R0, #05h

2182 122278          303                     LCALL   ACIONA_BUZZER

                     304                     

2185 D0E0            305                     POP             ACC

2187 D0E0            306                     POP             ACC

2189 809C            307                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     308                     

                     309     

                     310     

                     311     

                     312     

                     313     

                     314     

                     315     

218B                 316     VARREDURA_TECLADO:

218B C294            317                     CLR  LIN1

218D D295            318                     SETB LIN2

218F D296            319                     SETB LIN3

2191 D297            320                     SETB LIN4

2193 30912D          321                     JNB  COL2, DIGITO1

2196 30922E          322                     JNB  COL3, DIGITO2

2199 30932F          323                     JNB  COL4, DIGITO3

                     324                     

219C C295            325                     CLR  LIN2

219E D294            326                     SETB LIN1

21A0 30912C          327                     JNB  COL2, DIGITO4

21A3 30922D          328                     JNB  COL3, DIGITO5

21A6 30932E          329                     JNB  COL4, DIGITO6

                     330                     

21A9 C296            331                     CLR  LIN3

21AB D295            332                     SETB LIN2

21AD 30912B          333                     JNB  COL2, DIGITO7

21B0 30922C          334                     JNB  COL3, DIGITO8

21B3 30932D          335                     JNB  COL4, DIGITO9

                     336                     

21B6 C297            337                     CLR  LIN4

21B8 D296            338                     SETB LIN3

21BA 3091C3          339                     JNB  COL2, CLEAR

21BD 309227          340                     JNB  COL3, DIGITO0

21C0 80C9            341                     JMP  VARREDURA_TECLADO

                     342                     

21C2 22              343                     RET

                     344                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     7

                     345     

                     346     

                     347     

                     348     

                     349     

                     350     

                     351     

                     352     

21C3 7401            353     DIGITO1: MOV A, #1h

21C5 21EB            354                      AJMP GRAVA_DIGITO

21C7 7402            355     DIGITO2: MOV A, #2h

21C9 21EB            356                      AJMP GRAVA_DIGITO

21CB 7403            357     DIGITO3: MOV A, #3h

21CD 21EB            358                      AJMP GRAVA_DIGITO

21CF 7404            359     DIGITO4: MOV A, #4h

21D1 21EB            360                      AJMP GRAVA_DIGITO

21D3 7405            361     DIGITO5: MOV A, #5h

21D5 21EB            362                      AJMP GRAVA_DIGITO

21D7 7406            363     DIGITO6: MOV A, #6h

21D9 21EB            364                      AJMP GRAVA_DIGITO

21DB 7407            365     DIGITO7: MOV A, #7h

21DD 21EB            366                      AJMP GRAVA_DIGITO

21DF 7408            367     DIGITO8: MOV A, #8h

21E1 21EB            368                      AJMP GRAVA_DIGITO

21E3 7409            369     DIGITO9: MOV A, #9h

21E5 21EB            370                      AJMP GRAVA_DIGITO

21E7 7400            371     DIGITO0: MOV A, #0h

21E9 21EB            372                      AJMP GRAVA_DIGITO

                     373                      

21EB                 374     GRAVA_DIGITO:

21EB BB017C          375                     CJNE R3, #1h, GRAVA_TECLADO_2

21EE F7              376                     MOV @R1, A

                     377             

21EF 22              378                     RET

                     379     

                     380     

                     381     

                     382     

                     383     

                     384     

                     385     

                     386     

                     387     

21F0                 388     TESTA_SENHA1:

21F0 7805            389                     MOV     R0, #05h

21F2 122278          390                     LCALL   ACIONA_BUZZER

                     391                     

21F5 E535            392                     MOV             A, SENHA1_1

21F7 B53111          393                     CJNE    A, TECLADO_1, TESTA_SENHA2

21FA E536            394                     MOV             A, SENHA1_2

21FC B5320C          395                     CJNE    A, TECLADO_2, TESTA_SENHA2

21FF E537            396                     MOV             A, SENHA1_3

2201 B53307          397                     CJNE    A, TECLADO_3, TESTA_SENHA2

2204 E538            398                     MOV             A, SENHA1_4

2206 B53402          399                     CJNE    A, TECLADO_4, TESTA_SENHA2

2209 8035            400                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     401             

220B                 402     TESTA_SENHA2:

220B E545            403                     MOV             A, SENHA2_1

220D B53111          404                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2210 E546            405                     MOV             A, SENHA2_2

2212 B5320C          406                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2215 E547            407                     MOV             A, SENHA2_3

2217 B53307          408                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221A E548            409                     MOV             A, SENHA2_4

221C B53402          410                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     8

221F 801F            411                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     412                     

2221                 413     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     414                     

2221 712D            415                     CALL    CLR1L

2223 7146            416                     CALL    CLR2L

                     417                     

2225 902097          418                     MOV     DPTR,#STR_SENHA_INVALIDA         

2228 718D            419                     CALL    ESC_STR1                                         

                     420                     

                     421                     

222A 7864            422                     MOV     R0, #064h

222C 122278          423                     LCALL   ACIONA_BUZZER

                     424                     

                     425                     

222F 7901            426                     MOV             R1, #01h

2231 71C1            427                     CALL    TIMER_DELAY_1_S

                     428                     

2233 D55009          429                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     430                     

2236 712D            431                     CALL    CLR1L

2238 9020CA          432                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

223B 718D            433                     CALL    ESC_STR1                                         

                     434                     

223D 61CD            435                     JMP     FIM

                     436     

223F                 437     REINICIA_SISTEMA:

223F 22              438                     RET

                     439                     

2240                 440     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

2240 755003          441                     MOV     TENTATIVAS, #3h  

                     442                     

                     443                     

2243 712D            444                     CALL    CLR1L

2245 7146            445                     CALL    CLR2L

                     446                     

2247 902086          447                     MOV     DPTR,#STR_SENHA_VALIDA   

224A 718D            448                     CALL    ESC_STR1                                 

                     449                     

                     450                     

224C 7832            451                     MOV     R0, #032h

224E 122278          452                     LCALL   ACIONA_BUZZER

                     453                     

2251 9020A8          454                     MOV     DPTR, #STR_LIBERANDO_PORTA       

2254 7193            455                     CALL    ESC_STR2                                         

                     456                     

2256 7D1A            457                     MOV     R5, #1Ah

2258 12227F          458                     LCALL   ABRE_FECHADURA

                     459                     

                     460                     

225B 7903            461                     MOV             R1, #03h

225D 71C1            462                     CALL    TIMER_DELAY_1_S

                     463                     

225F 9020B9          464                     MOV     DPTR, #STR_TRANCANDO_PORTA       

2262 7193            465                     CALL    ESC_STR2                                         

                     466                     

2264 7D1A            467                     MOV     R5, #1Ah

2266 1222B2          468                     LCALL   TRANCA_FECHADURA

                     469                     

2269 22              470                     RET

                     471                      

                     472     

                     473     

                     474     

                     475     

                     476     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE     9

                     477     

                     478     

226A BB0202          479     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

226D 4176            480                                      AJMP GRAVA_TECLADO_X

226F BB0302          481     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

2272 4176            482                                      AJMP GRAVA_TECLADO_X           

2274 4176            483     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X

                     484     

2276                 485     GRAVA_TECLADO_X:

2276 F7              486                      MOV @R1, A

                     487                      

2277 22              488                      RET

                     489                      

                     490     

                     491     

                     492     

                     493     

2278                 494     ACIONA_BUZZER:

2278 D2B0            495                     SETB    BUZZER

227A 71AD            496                     ACALL   TIMER_DELAY_20_MS

227C C2B0            497                     CLR     BUZZER

                     498                     

227E 22              499                     RET

                     500                     

                     501     

                     502     

                     503     

227F                 504     ABRE_FECHADURA:

227F C2B2            505                     CLR             ESTADO_DOIS

2281 C2B3            506                     CLR             ESTADO_TRES

2283 C2B4            507                     CLR             ESTADO_QUATRO

2285 D2B1            508                     SETB    ESTADO_UM

                     509                     

2287 7805            510                     MOV     R0, #05h

2289 71AD            511                     ACALL   TIMER_DELAY_20_MS

                     512                     

228B D2B2            513                     SETB    ESTADO_DOIS

228D C2B3            514                     CLR             ESTADO_TRES

228F C2B4            515                     CLR             ESTADO_QUATRO

2291 C2B1            516                     CLR             ESTADO_UM

                     517                     

2293 7805            518                     MOV     R0, #05h

2295 71AD            519                     ACALL   TIMER_DELAY_20_MS

                     520                     

2297 C2B2            521                     CLR             ESTADO_DOIS

2299 D2B3            522                     SETB    ESTADO_TRES

229B C2B4            523                     CLR             ESTADO_QUATRO

229D C2B1            524                     CLR             ESTADO_UM

                     525                     

229F 7805            526                     MOV     R0, #05h

22A1 71AD            527                     ACALL   TIMER_DELAY_20_MS

                     528                     

22A3 C2B2            529                     CLR             ESTADO_DOIS

22A5 C2B3            530                     CLR             ESTADO_TRES

22A7 D2B4            531                     SETB    ESTADO_QUATRO

22A9 C2B1            532                     CLR             ESTADO_UM

                     533                     

22AB 7805            534                     MOV     R0, #05h

22AD 71AD            535                     ACALL   TIMER_DELAY_20_MS

                     536                     

22AF DDCE            537                     DJNZ    R5, ABRE_FECHADURA

                     538                     

22B1 22              539                     RET

                     540                     

22B2                 541     TRANCA_FECHADURA:

22B2 C2B2            542                     CLR             ESTADO_DOIS

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    10

22B4 C2B3            543                     CLR             ESTADO_TRES

22B6 D2B4            544                     SETB    ESTADO_QUATRO

22B8 C2B1            545                     CLR             ESTADO_UM

                     546                     

22BA 7805            547                     MOV     R0, #05h

22BC 71AD            548                     ACALL   TIMER_DELAY_20_MS

                     549                     

22BE C2B2            550                     CLR             ESTADO_DOIS

22C0 D2B3            551                     SETB    ESTADO_TRES

22C2 C2B4            552                     CLR             ESTADO_QUATRO

22C4 C2B1            553                     CLR             ESTADO_UM

                     554                     

22C6 7805            555                     MOV     R0, #05h

22C8 71AD            556                     ACALL   TIMER_DELAY_20_MS

                     557                     

22CA D2B2            558                     SETB    ESTADO_DOIS

22CC C2B3            559                     CLR             ESTADO_TRES

22CE C2B4            560                     CLR             ESTADO_QUATRO

22D0 C2B1            561                     CLR             ESTADO_UM

                     562                     

22D2 7805            563                     MOV     R0, #05h

22D4 71AD            564                     ACALL   TIMER_DELAY_20_MS

                     565                     

22D6 C2B2            566                     CLR             ESTADO_DOIS

22D8 C2B3            567                     CLR             ESTADO_TRES

22DA C2B4            568                     CLR             ESTADO_QUATRO

22DC D2B1            569                     SETB    ESTADO_UM

                     570                     

22DE 7805            571                     MOV     R0, #05h

22E0 71AD            572                     ACALL   TIMER_DELAY_20_MS

                     573                     

22E2 DDCE            574                     DJNZ    R5, TRANCA_FECHADURA

                     575     

22E4 22              576                     RET

                     577     

                     578     

                     579     

                     580             

                     581     

                     582     

                     583     

                     584     

                     585     

                     586     

                     587     

                     588     

                     589     

22E5                 590     INIDISP:                       

22E5 7838            591             MOV     R0,#38H          

22E7 7A05            592             MOV     R2,#05           

22E9 7104            593             CALL    ESCINST          

                     594             

22EB 7838            595                     MOV     R0,#38H          

22ED 7A01            596             MOV     R2,#01           

22EF 7104            597             CALL    ESCINST          

                     598             

22F1 7806            599                     MOV     R0,#06H          

22F3 7A01            600             MOV     R2,#01           

22F5 7104            601             CALL    ESCINST          

                     602             

22F7 780C            603                     MOV     R0,#0CH          

22F9 7A01            604             MOV     R2,#01           

22FB 7104            605             CALL    ESCINST          

                     606             

22FD 7801            607                     MOV     R0,#01H          

22FF 7A02            608             MOV     R2,#02           

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    11

2301 7104            609             CALL    ESCINST          

                     610             

2303 22              611                     RET

                     612                     

                     613     

                     614     

                     615     

                     616     

                     617     

                     618     

                     619     

                     620     

                     621     

2304                 622     ESCINST:  

2304 C2A6            623                     CLR             RW                               

2306 C2A5            624                     CLR     RS               

2308 D2A7            625                     SETB    E_LCD            

                     626                     

230A 8880            627                     MOV     P0,R0            

                     628                     

230C C2A7            629                     CLR     E_LCD            

                     630                     

230E 7580FF          631                     MOV             P0,#0xFF                 

                     632                     

2311 D2A6            633                     SETB    RW                               

2313 D2A7            634                     SETB    E_LCD            

                     635     

2315 2087FD          636     ESCI1:  JB      BUSYF,ESCI1                      

                     637                     

2318 C2A7            638                     CLR     E_LCD            

                     639             

231A 22              640                     RET

                     641                     

                     642     

                     643     

                     644     

                     645     

                     646     

                     647     

                     648     

                     649     

231B                 650     GOTOXY: 

231B C0E0            651                     PUSH    ACC

                     652             

231D 7480            653                     MOV     A,#80H

231F B80102          654             CJNE    R0,#01,GT1       

                     655             

2322 74C0            656                     MOV     A,#0C0H

                     657                     

2324 49              658     GT1:    ORL     A,R1             

2325 F8              659             MOV     R0,A

2326 7A01            660             MOV     R2,#01           

                     661             

2328 7104            662                     CALL    ESCINST          

                     663             

232A D0E0            664                     POP     ACC

                     665             

232C 22              666                     RET

                     667             

                     668     

                     669     

                     670     

                     671     

                     672     

                     673     

                     674     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    12

                     675     

232D                 676     CLR1L:    

232D C0E0            677             PUSH   ACC

                     678             

232F 7800            679                     MOV    R0,#00               

2331 7900            680             MOV    R1,#00

                     681             

2333 711B            682                     CALL   GOTOXY

                     683             

2335 7910            684                     MOV    R1,#16               

                     685     

2337 7420            686     CLR1L1: MOV    A,#' '               

                     687             

2339 715F            688                     CALL   ESCDADO

                     689             

233B D9FA            690                     DJNZ   R1,CLR1L1

233D 7800            691             MOV    R0,#00               

233F 7900            692             MOV    R1,#00

                     693             

2341 711B            694                     CALL   GOTOXY

                     695             

2343 D0E0            696                     POP    ACC

                     697             

2345 22              698                     RET

                     699                     

                     700     

                     701     

                     702     

                     703     

                     704     

                     705     

                     706     

                     707     

2346                 708     CLR2L:    

2346 C0E0            709             PUSH   ACC

                     710             

2348 7801            711                     MOV    R0,#01               

234A 7900            712             MOV    R1,#00

                     713             

234C 711B            714                     CALL   GOTOXY

                     715             

234E 7910            716                     MOV    R1,#16               

                     717     

2350 7420            718     CLR2L1: MOV    A,#' '               

                     719             

2352 715F            720                     CALL   ESCDADO

                     721             

2354 D9FA            722                     DJNZ   R1,CLR2L1

2356 7801            723             MOV    R0,#01               

2358 7900            724             MOV    R1,#00

                     725             

235A 711B            726                     CALL   GOTOXY

                     727             

235C D0E0            728                     POP    ACC

                     729             

235E 22              730                     RET

                     731                

                     732     

                     733     

                     734     

                     735     

                     736     

                     737     

                     738     

235F                 739     ESCDADO:  

235F C2A6            740                     CLR             RW                               

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    13

2361 D2A5            741             SETB    RS               

2363 D2A7            742             SETB    E_LCD            

                     743                     

2365 F580            744             MOV     P0,A             

                     745             

2367 C2A7            746                     CLR     E_LCD            

                     747                     

2369 7580FF          748                     MOV             P0,#0xFF                 

                     749                     

236C D2A6            750                     SETB    RW                               

236E C2A5            751                     CLR             RS                               

2370 D2A7            752                     SETB    E_LCD            

                     753     

2372 2087FD          754     ESCD1:  JB              BUSYF,ESCD1              

                     755     

2375 C2A7            756                     CLR     E_LCD            

                     757     

2377 22              758             RET

                     759                     

                     760     

                     761     

                     762     

                     763     

                     764     

                     765     

                     766     

                     767     

                     768     

2378                 769     MSTRING:  

2378 E4              770                       CLR    A

2379 93              771               MOVC   A,@A+DPTR       

                     772               

237A 6006            773                       JZ     MSTR1

                     774               

237C 12235F          775                       LCALL  ESCDADO         

                     776               

237F A3              777                       INC    DPTR

                     778               

2380 80F6            779                       SJMP   MSTRING

                     780                       

2382 22              781     MSTR1:    RET

                     782                

                     783     

                     784     

                     785     

                     786     

                     787     

                     788     

                     789     

                     790     

                     791     

2383                 792     MSTRINGX: 

2383 E0              793                       MOVX   A,@DPTR         

                     794               

2384 6006            795                       JZ     MSTR21

                     796               

2386 12235F          797                       LCALL  ESCDADO         

                     798               

2389 A3              799                       INC    DPTR

                     800               

238A 80F7            801                       SJMP   MSTRINGX

                     802     

238C 22              803     MSTR21:   RET

                     804     

                     805     

                     806     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    14

                     807     

                     808     

                     809     

                     810     

                     811     

                     812     

                     813     

238D                 814     ESC_STR1: 

                     815                       

238D 7800            816                       MOV    R0,#00         

238F 7900            817               MOV    R1,#00

                     818               

2391 8004            819                       JMP    ESC_S

                     820               

                     821     

                     822     

                     823     

                     824     

                     825     

                     826     

                     827     

                     828     

                     829     

2393                 830     ESC_STR2: 

                     831                       

2393 7801            832                       MOV    R0,#01         

2395 7900            833               MOV    R1,#00

                     834                       

2397 12231B          835     ESC_S:    LCALL  GOTOXY          

                     836               

239A 122378          837                       LCALL  MSTRING

                     838               

239D 22              839                       RET

                     840     

                     841     

                     842     

                     843     

                     844     

                     845     

                     846     

                     847     ; DESTROI: R0,R2                                                                        //

                     848     

239E                 849     CUR_ON:   

239E 780F            850                       MOV    R0,#0FH               

23A0 8002            851               SJMP   CUR1

                     852                       

23A2                 853     CUR_OFF:  

23A2 780C            854                       MOV    R0,#0CH               

                     855                       

23A4 7A01            856     CUR1:     MOV    R2,#01

                     857               

23A6 7104            858                       CALL   ESCINST               

                     859               

23A8 22              860                       RET

                     861                       

                     862     

                     863     

                     864     

                     865                       

23A9                 866     TIMER_CONFIGURA_TIMER:

23A9 758901          867                     MOV TMOD, #01h  

                     868             

23AC 22              869                     RET

                     870             

                     871     

                     872     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    15

                     873     

                     874     

                     875     

                     876     

                     877     

23AD                 878     TIMER_DELAY_20_MS:

23AD 758C56          879                     MOV TH0, #HIGH(65535 - 43350)

23B0 758AA9          880                     MOV TL0, #LOW(65535 - 43350)

                     881             

23B3 C28D            882                     CLR TF0

23B5 D28C            883                     SETB TR0

                     884             

23B7 308DFD          885                     JNB TF0, $

                     886                     

23BA C28D            887                     CLR TF0

23BC C28C            888                     CLR TR0

                     889             

23BE D8ED            890                     DJNZ R0, TIMER_DELAY_20_MS

                     891             

23C0 22              892                     RET

                     893             

                     894     

                     895     

                     896     

                     897     

                     898     

                     899     

                     900     

23C1                 901     TIMER_DELAY_1_S:

23C1 7832            902                     MOV             R0, #50d

23C3 71AD            903                     CALL    TIMER_DELAY_20_MS

                     904                     

23C5 D9FA            905                     DJNZ    R1, TIMER_DELAY_1_S

                     906             

23C7 22              907                     RET

                     908     

                     909     

                     910     

                     911     

                     912     

                     913     

                     914     

                     915     

23C8                 916     INT_INT0:

23C8 32              917                     RETI

                     918     

                     919     

                     920     

                     921     

23C9                 922     INT_TIMER0:

23C9 32              923                     RETI

                     924             

                     925     

                     926     

                     927     

23CA                 928     INT_INT1:

23CA 32              929                     RETI

                     930     

                     931     

                     932     

                     933     

23CB                 934     INT_TIMER1:

23CB 32              935                     RETI

                     936             

                     937     

                     938     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    16

                     939     

23CC                 940     INT_SERIAL:

23CC 32              941                     RETI

                     942             

23CD                 943     FIM:

                     944                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    17

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   227FH   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   2278H   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   2180H   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   232DH   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   2337H   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   2346H   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   2350H   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   2166H   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   23A4H   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   23A2H   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   239EH   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21E7H   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   21C3H   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21C7H   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21CBH   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21CFH   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21D3H   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21D7H   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21DBH   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21DFH   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21E3H   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   2372H   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   235FH   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   2315H   A   
ESCINST . . . . . . . . . . . . .  C ADDR   2304H   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   216BH   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   2397H   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   238DH   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   2393H   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23CDH   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   231BH   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21EBH   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   226AH   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   226FH   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   2274H   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   2276H   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   2324H   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22E5H   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23C8H   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23CAH   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23CCH   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23C9H   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23CBH   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   2145H   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   2159H   A   
LE_SENHA_ROM. . . . . . . . . . .  C ADDR   215FH   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:04:02 PAGE    18

LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2127H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   2221H   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   2240H   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   210CH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   2382H   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   238CH   A   
MSTRING . . . . . . . . . . . . .  C ADDR   2378H   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   2383H   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   2175H   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   223FH   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_PRESSIONE_ENTER . . . . . . .  C ADDR   2075H   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2097H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2086H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20CAH   A   
STR_TIMEOUT . . . . . . . . . . .  C ADDR   20DBH   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20B9H   A   
TECLADO . . . . . . . . . . . . .  D ADDR   0090H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21F0H   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   220BH   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   23A9H   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   23C1H   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   23ADH   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   22B2H   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   218BH   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20ECH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
