A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 022097           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 022274           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 022275           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 022276           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 022277           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 022278           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                      EQU     P2.5                     

  00A7                41     E_LCD           EQU     P2.7                     

  00A6                42     RW                      EQU     P2.6                     

  0087                43     BUSYF           EQU     P0.7                     

                      44     

                      45     

  00B7                46     LED1            EQU     P3.7

  00B6                47     LED_SEG         EQU     P3.6

                      48             

                      49     

  00B0                50     COL1            EQU P3.0

  00B1                51     COL2            EQU P3.1

  00B2                52     COL3            EQU P3.2

  00B3                53     COL4            EQU P3.3

                      54     

  00B4                55     LIN1            EQU P3.4

  00B5                56     LIN2            EQU P3.5

  00B6                57     LIN3            EQU P3.6

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     2

  00B7                58     LIN4            EQU P3.7

                      59             

                      60     

  0031                61     TECLADO_1       EQU 31h

  0032                62     TECLADO_2       EQU 32h

  0033                63     TECLADO_3       EQU 33h

  0034                64     TECLADO_4       EQU 34h

                      65             

                      66     

  0037                67     COUNTER         EQU 37h

                      68     

                      69     

  0041                70     SENHA1_1        EQU 41h

  0042                71     SENHA1_2        EQU 42h

  0043                72     SENHA1_3        EQU 43h

  0044                73     SENHA1_4        EQU 44h

                      74     

  0045                75     SENHA2_1        EQU 45h

  0046                76     SENHA2_2        EQU 46h

  0047                77     SENHA2_3        EQU 47h

  0048                78     SENHA2_4        EQU 48h

                      79     

  0049                80     TENTATIVAS  EQU 49h

  0050                81     ASTERISCO   EQU 50h

                      82                     

                      83     

                      84     

                      85     

                      86     

2030                  87     org 2030h

2030                  88     SENHA_PADRAO_1:

2030 32383132         89                     db      '2812', 00H

2034 00                      
2035                  90     SENHA_PADRAO_2:

2035 30393132         91                     db      '0912', 00H

2039 00                      
203A                  92     STR_LOGO:

203A 2050524F         93             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                  94     STR_ENTER:

204B 50524553         95             DB      'PRESSIONE  ENTER',00H

204F 53494F4E                
2053 45202045                
2057 4E544552                
205B 00                      
205C                  96     STR_SENHA:

205C 53454E48         97             DB      'SENHA: ',00H

2060 413A2000                
2064                  98     STR_LIBERA:

2064 20504F52         99             DB      ' PORTA LIBERADA ',00H

2068 5441204C                
206C 49424552                
2070 41444120                
2074 00                      
2075                 100     STR_TRANCA:

2075 20504F52        101             DB      ' PORTA TRANCADA ',00H          

2079 54412054                
207D 52414E43                
2081 41444120                
2085 00                      
                     102     

2086                 103     STR_ERRO:

2086 53454E48        104             DB      'SENHA NECESSARIA',00H

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     3

208A 41204E45                
208E 43455353                
2092 41524941                
2096 00                      
                     105                     

                     106     

                     107     

                     108     

                     109     

2097                 110     __STARTUP__:

2097 902030          111             mov DPTR, #2030h         

209A 7800            112             mov R0, #00h         

209C 7941            113             mov R1, #SENHA1_1        

209E 7A04            114             mov R2, #04h             

20A0 11E3            115             CALL LE_SENHA

                     116             

20A2 902035          117             mov DPTR, #2035h         

20A5 7800            118             mov R0, #00h             

20A7 7945            119             mov R1, #SENHA2_1        

20A9 7A04            120             mov R2, #04h             

20AB 11E3            121             CALL LE_SENHA

                     122             

20AD 754903          123             MOV TENTATIVAS, #3h

20B0 75502A          124             MOV ASTERISCO,  #2Ah

                     125             

                     126             

                     127             

                     128     

20B3                 129     MAIN:

20B3 3187            130                     CALL    INIDISP  

20B5 90203A          131                     MOV     DPTR,#STR_LOGO   

20B8 512F            132                     CALL    ESC_STR1                 

                     133                     

20BA 7908            134                     MOV     R1, #08d

20BC                 135     ATRASO_2_S:             

20BC AAFA            136                     MOV     R2, 250d

20BE 5169            137                     ACALL   ATRASO_MS

20C0 D9FA            138                     djnz    R1, ATRASO_2_S

                     139                     

20C2 31CF            140                     CALL CLR1L

                     141                     

20C4 90205C          142                     MOV     DPTR,#STR_SENHA  

20C7 512F            143                     CALL    ESC_STR1                 

                     144                     

20C9 7800            145                     MOV     R0, #00h         

20CB 7907            146                     MOV     R1, #07h         

20CD 31BD            147                     CALL    GOTOXY

                     148                     

20CF 7931            149                     MOV     R1, #TECLADO_1

20D1 7B01            150                     MOV     R3, #1h

20D3 7F04            151                     MOV     R7, #04h

20D5                 152     LE_4_DIGITOS:

20D5 A864            153                     MOV     R0, 100

20D7 5169            154                     ACALL   ATRASO_MS

20D9 11FA            155                     ACALL   VARREDURA_TECLADO

20DB 11F5            156                     CALL    ESCREVE_ASTERISCO

                     157                     

20DD 09              158                     INC R1

20DE 0B              159                     INC R3

                     160                     

20DF DFF4            161                     DJNZ R7, LE_4_DIGITOS

                     162                     

20E1 4179            163                     JMP             FIM

                     164             

                     165     

                     166     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     4

                     167     

                     168     

                     169     

                     170     

                     171     

                     172     

                     173     

                     174     

20E3                 175     LE_SENHA:

20E3 11E9            176             call LE_SENHA_ROM

                     177             

20E5 09              178             INC R1

                     179             

20E6 DAFB            180             djnz R2, LE_SENHA

                     181             

20E8 22              182             RET

                     183     

20E9                 184     LE_SENHA_ROM:

20E9 E8              185             mov A, R0

20EA 93              186             movc A, @A + DPTR

20EB F7              187             mov @R1, A

                     188             

20EC 08              189             inc R0

                     190             

20ED 11F0            191             call CONV_ASCII_TO_NUMBER

                     192             

20EF 22              193             RET

                     194             

                     195     

                     196     

                     197     

                     198     

                     199     

                     200     

                     201     

                     202     

20F0                 203     CONV_ASCII_TO_NUMBER:

20F0 E7              204             mov A, @R1

                     205             

20F1 24D0            206             ADD A, #-30h

                     207             

20F3 F7              208             mov @R1, A

                     209             

20F4 22              210             RET

                     211             

                     212     

                     213     

                     214     

                     215     

                     216     

                     217     

                     218     

20F5                 219     ESCREVE_ASTERISCO:              

20F5 E550            220             MOV     A, ASTERISCO

20F7 5101            221             CALL    ESCDADO

                     222             

20F9 22              223             RET

                     224     

                     225     ;Varredura de teclado para as senhas normais

20FA                 226     VARREDURA_TECLADO:

20FA C2B4            227                     CLR  LIN1

20FC D2B5            228                     SETB LIN2

20FE D2B6            229                     SETB LIN3

2100 D2B7            230                     SETB LIN4

2102 30B0F0          231                     JNB      COL1, ESCREVE_ASTERISCO

2105 30B12D          232                     JNB  COL2, DIGITO1

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     5

2108 30B231          233                     JNB  COL3, DIGITO2

210B 30B335          234                     JNB  COL4, DIGITO3

                     235                     

210E C2B5            236                     CLR  LIN2

2110 D2B4            237                     SETB LIN1

2112 30B135          238                     JNB  COL2, DIGITO4

2115 30B239          239                     JNB  COL3, DIGITO5

2118 30B33D          240                     JNB  COL4, DIGITO6

                     241                     

211B C2B6            242                     CLR  LIN3

211D D2B5            243                     SETB LIN2

211F 30B13D          244                     JNB  COL2, DIGITO7

2122 30B241          245                     JNB  COL3, DIGITO8

2125 30B345          246                     JNB  COL4, DIGITO9

                     247                     

2128 C2B7            248                     CLR  LIN4

212A D2B6            249                     SETB LIN3

212C 30B1C6          250                     JNB  COL2, ESCREVE_ASTERISCO

212F 30B242          251                     JNB  COL3, DIGITO0

2132 80C6            252                     JMP  VARREDURA_TECLADO

                     253                     

2134 22              254                     RET

                     255                     

                     256     ;***************************************************************************

                     257     ;NOME: DIGITO1

                     258     ;DESCRICAO: Coloca o valor 1 em R1 e grava no dígito correspondente ao valor atual de R2

                     259     ;ENTRADA:

                     260     ;SAIDA:

                     261     ;DESTROI: 

2135 7401            262     DIGITO1: MOV A, #1h

2137 BB0141          263                      CJNE R3, #1h, GRAVA_TECLADO_2

213A F7              264                      MOV @R1, A

                     265                      

213B 22              266                      RET

                     267     ;***************************************************************************

                     268     ;NOME: DIGITO2

                     269     ;DESCRICAO: Coloca o valor 2 em R1 e grava no dígito correspondente ao valor atual de R2

                     270     ;ENTRADA:

                     271     ;SAIDA:

                     272     ;DESTROI: 

213C 7402            273     DIGITO2: MOV A, #2h

213E BB013A          274                      CJNE R3, #1h, GRAVA_TECLADO_2

2141 F7              275                      MOV @R1, A

2142 22              276                      RET

                     277     ;***************************************************************************

                     278     ;NOME: DIGITO3

                     279     ;DESCRICAO: Coloca o valor 3 em R1 e grava no dígito correspondente ao valor atual de R2

                     280     ;ENTRADA:

                     281     ;SAIDA:

                     282     ;DESTROI: 

2143 7403            283     DIGITO3: MOV A, #3h

2145 BB0133          284                      CJNE R3, #1h, GRAVA_TECLADO_2

2148 F7              285                      MOV @R1, A

2149 22              286                      RET

                     287     ;***************************************************************************

                     288     ;NOME: DIGITO4

                     289     ;DESCRICAO: Coloca o valor 4 em R1 e grava no dígito correspondente ao valor atual de R2

                     290     ;ENTRADA:

                     291     ;SAIDA:

                     292     ;DESTROI: 

214A 7404            293     DIGITO4: MOV A, #4h

214C BB012C          294                      CJNE R3, #1h, GRAVA_TECLADO_2

214F F7              295                      MOV @R1, A

2150 22              296                      RET

                     297     ;***************************************************************************

                     298     ;NOME: DIGITO5

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     6

                     299     ;DESCRICAO: Coloca o valor 5 em R1 e grava no dígito correspondente ao valor atual de R2

                     300     ;ENTRADA:

                     301     ;SAIDA:

                     302     ;DESTROI: 

2151 7405            303     DIGITO5: MOV A, #5h

2153 BB0125          304                      CJNE R3, #1h, GRAVA_TECLADO_2

2156 F7              305                      MOV @R1, A

2157 22              306                      RET

                     307     ;***************************************************************************

                     308     ;NOME: DIGITO6

                     309     ;DESCRICAO: Coloca o valor 6 em R1 e grava no dígito correspondente ao valor atual de R2

                     310     ;ENTRADA:

                     311     ;SAIDA:

                     312     ;DESTROI: 

2158 7406            313     DIGITO6: MOV A, #6h

215A BB011E          314                      CJNE R3, #1h, GRAVA_TECLADO_2

215D F7              315                      MOV @R1, A

215E 22              316                      RET

                     317     ;***************************************************************************

                     318     ;NOME: DIGITO7

                     319     ;DESCRICAO: Coloca o valor 7 em R1 e grava no dígito correspondente ao valor atual de R2

                     320     ;ENTRADA:

                     321     ;SAIDA:

                     322     ;DESTROI: 

215F 7407            323     DIGITO7: MOV A, #7h

2161 BB0117          324                      CJNE R3, #1h, GRAVA_TECLADO_2

2164 F7              325                      MOV @R1, A

2165 22              326                      RET

                     327     ;***************************************************************************

                     328     ;NOME: DIGITO8

                     329     ;DESCRICAO: Coloca o valor 8 em R1 e grava no dígito correspondente ao valor atual de R2

                     330     ;ENTRADA:

                     331     ;SAIDA:

                     332     ;DESTROI: 

2166 7408            333     DIGITO8: MOV A, #8h

2168 BB0110          334                      CJNE R3, #1h, GRAVA_TECLADO_2

216B F7              335                      MOV @R1, A

216C 22              336                      RET

                     337     ;***************************************************************************

                     338     ;NOME: DIGITO9

                     339     ;DESCRICAO: Coloca o valor 9 em R1 e grava no dígito correspondente ao valor atual de R2

                     340     ;ENTRADA:

                     341     ;SAIDA:

                     342     ;DESTROI: 

216D 7409            343     DIGITO9: MOV A, #9h

216F BB0109          344                      CJNE R3, #1h, GRAVA_TECLADO_2

2172 F7              345                      MOV @R1, A

2173 22              346                      RET

                     347     ;***************************************************************************

                     348     ;NOME: DIGITO0

                     349     ;DESCRICAO: Coloca o valor 0 em R1 e grava no dígito correspondente ao valor atual de R2

                     350     ;ENTRADA:

                     351     ;SAIDA:

                     352     ;DESTROI: 

2174 7400            353     DIGITO0: MOV A, #0h

2176 BB0102          354                      CJNE R3, #1h, GRAVA_TECLADO_2

2179 F7              355                      MOV @R1, A

217A 22              356                      RET

                     357                      

                     358     ;***************************************************************************

                     359     ;NOME: GRAVA_TECLADO_2

                     360     ;DESCRICAO: Grava o valor de R1 e no dígito 2 do teclado

                     361     ;ENTRADA: R1

                     362     ;SAIDA: TECLADO_2

                     363     ;DESTROI: 

217B                 364     GRAVA_TECLADO_2: 

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     7

217B BB0202          365                                      CJNE R3, #2h, GRAVA_TECLADO_3

217E F7              366                                      MOV @R1, A

217F 22              367                                      RET

                     368     ;***************************************************************************

                     369     ;NOME: GRAVA_TECLADO_3

                     370     ;DESCRICAO: Grava o valor de R1 e no dígito 3 do teclado

                     371     ;ENTRADA: R1

                     372     ;SAIDA: TECLADO_3

                     373     ;DESTROI: 

2180 BB0302          374     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

2183 F7              375                                      MOV @R1, A

2184 22              376                                      RET            

                     377     ;***************************************************************************

                     378     ;NOME: GRAVA_TECLADO_4

                     379     ;DESCRICAO: Grava o valor de R1 e no dígito 4 do teclado

                     380     ;ENTRADA: R1

                     381     ;SAIDA: TECLADO_4

                     382     ;DESTROI: 

2185 F7              383     GRAVA_TECLADO_4: MOV @R1, A

2186 22              384                                      RET

                     385     

                     386     

                     387     

                     388     

                     389             

                     390     

                     391     

                     392     

                     393     

                     394     

                     395     

                     396     

                     397     

                     398     

2187                 399     INIDISP:                       

2187 7838            400             MOV     R0,#38H          

2189 7A05            401             MOV     R2,#05           

218B 31A6            402             CALL    ESCINST          

                     403             

218D 7838            404                     MOV     R0,#38H          

218F 7A01            405             MOV     R2,#01           

2191 31A6            406             CALL    ESCINST          

                     407             

2193 7806            408                     MOV     R0,#06H          

2195 7A01            409             MOV     R2,#01           

2197 31A6            410             CALL    ESCINST          

                     411             

2199 780C            412                     MOV     R0,#0CH          

219B 7A01            413             MOV     R2,#01           

219D 31A6            414             CALL    ESCINST          

                     415             

219F 7801            416                     MOV     R0,#01H          

21A1 7A02            417             MOV     R2,#02           

21A3 31A6            418             CALL    ESCINST          

                     419             

21A5 22              420                     RET

                     421                     

                     422     

                     423     

                     424     

                     425     

                     426     

                     427     

                     428     

                     429     

                     430     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     8

21A6                 431     ESCINST:  

21A6 C2A6            432                     CLR             RW                               

21A8 C2A5            433                     CLR     RS               

21AA D2A7            434                     SETB    E_LCD            

                     435                     

21AC 8880            436                     MOV     P0,R0            

                     437                     

21AE C2A7            438                     CLR     E_LCD            

                     439                     

21B0 7580FF          440                     MOV             P0,#0xFF                 

                     441                     

21B3 D2A6            442                     SETB    RW                               

21B5 D2A7            443                     SETB    E_LCD            

                     444     

21B7 2087FD          445     ESCI1:  JB      BUSYF,ESCI1                      

                     446                     

21BA C2A7            447                     CLR     E_LCD            

                     448             

21BC 22              449                     RET

                     450                     

                     451     

                     452     

                     453     

                     454     

                     455     

                     456     

                     457     

                     458     

21BD                 459     GOTOXY: 

21BD C0E0            460                     PUSH    ACC

                     461             

21BF 7480            462                     MOV     A,#80H

21C1 B80102          463             CJNE    R0,#01,GT1       

                     464             

21C4 74C0            465                     MOV     A,#0C0H

                     466                     

21C6 49              467     GT1:    ORL     A,R1             

21C7 F8              468             MOV     R0,A

21C8 7A01            469             MOV     R2,#01           

                     470             

21CA 31A6            471                     CALL    ESCINST          

                     472             

21CC D0E0            473                     POP     ACC

                     474             

21CE 22              475                     RET

                     476             

                     477     

                     478     

                     479     

                     480     

                     481     

                     482     

                     483     

                     484     

21CF                 485     CLR1L:    

21CF C0E0            486             PUSH   ACC

                     487             

21D1 7800            488                     MOV    R0,#00               

21D3 7900            489             MOV    R1,#00

                     490             

21D5 31BD            491                     CALL   GOTOXY

                     492             

21D7 7910            493                     MOV    R1,#16               

                     494     

21D9 7420            495     CLR1L1: MOV    A,#' '               

                     496             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE     9

21DB 5101            497                     CALL   ESCDADO

                     498             

21DD D9FA            499                     DJNZ   R1,CLR1L1

21DF 7800            500             MOV    R0,#00               

21E1 7900            501             MOV    R1,#00

                     502             

21E3 31BD            503                     CALL   GOTOXY

                     504             

21E5 D0E0            505                     POP    ACC

                     506             

21E7 22              507                     RET

                     508                     

                     509     

                     510     

                     511     

                     512     

                     513     

                     514     

                     515     

                     516     

21E8                 517     CLR2L:    

21E8 C0E0            518             PUSH   ACC

                     519             

21EA 7801            520                     MOV    R0,#01               

21EC 7900            521             MOV    R1,#00

                     522             

21EE 31BD            523                     CALL   GOTOXY

                     524             

21F0 7910            525                     MOV    R1,#16               

                     526     

21F2 7420            527     CLR2L1: MOV    A,#' '               

                     528             

21F4 5101            529                     CALL   ESCDADO

                     530             

21F6 D9FA            531                     DJNZ   R1,CLR2L1

21F8 7801            532             MOV    R0,#01               

21FA 7900            533             MOV    R1,#00

                     534             

21FC 31BD            535                     CALL   GOTOXY

                     536             

21FE D0E0            537                     POP    ACC

                     538             

2200 22              539                     RET

                     540                

                     541     

                     542     

                     543     

                     544     

                     545     

                     546     

                     547     

2201                 548     ESCDADO:  

2201 C2A6            549                     CLR             RW                               

2203 D2A5            550             SETB    RS               

2205 D2A7            551             SETB    E_LCD            

                     552                     

2207 F580            553             MOV     P0,A             

                     554             

2209 C2A7            555                     CLR     E_LCD            

                     556                     

220B 7580FF          557                     MOV             P0,#0xFF                 

                     558                     

220E D2A6            559                     SETB    RW                               

2210 C2A5            560                     CLR             RS                               

2212 D2A7            561                     SETB    E_LCD            

                     562     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    10

2214 2087FD          563     ESCD1:  JB              BUSYF,ESCD1              

                     564     

2217 C2A7            565                     CLR     E_LCD            

                     566     

2219 22              567             RET

                     568                     

                     569     

                     570     

                     571     

                     572     

                     573     

                     574     

                     575     

                     576     

                     577     

221A                 578     MSTRING:  

221A E4              579                       CLR    A

221B 93              580               MOVC   A,@A+DPTR       

                     581               

221C 6006            582                       JZ     MSTR1

                     583               

221E 122201          584                       LCALL  ESCDADO         

                     585               

2221 A3              586                       INC    DPTR

                     587               

2222 80F6            588                       SJMP   MSTRING

                     589                       

2224 22              590     MSTR1:    RET

                     591                

                     592     

                     593     

                     594     

                     595     

                     596     

                     597     

                     598     

                     599     

                     600     

2225                 601     MSTRINGX: 

2225 E0              602                       MOVX   A,@DPTR         

                     603               

2226 6006            604                       JZ     MSTR21

                     605               

2228 122201          606                       LCALL  ESCDADO         

                     607               

222B A3              608                       INC    DPTR

                     609               

222C 80F7            610                       SJMP   MSTRINGX

                     611     

222E 22              612     MSTR21:   RET

                     613     

                     614     

                     615     

                     616     

                     617     

                     618     

                     619     

                     620     

                     621     

                     622     

222F                 623     ESC_STR1: 

                     624                       

222F 7800            625                       MOV    R0,#00         

2231 7900            626               MOV    R1,#00

                     627               

2233 8004            628                       JMP    ESC_S

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    11

                     629               

                     630     

                     631     

                     632     

                     633     

                     634     

                     635     

                     636     

                     637     

                     638     

2235                 639     ESC_STR2: 

                     640                       

2235 7801            641                       MOV    R0,#01         

2237 7900            642               MOV    R1,#00

                     643                       

2239 1221BD          644     ESC_S:    LCALL  GOTOXY          

                     645               

223C 12221A          646                       LCALL  MSTRING

                     647               

223F 22              648                       RET

                     649     

                     650     

                     651     

                     652     

                     653     

                     654     

                     655     

                     656     ; DESTROI: R0,R2                                                                        //

                     657     

2240                 658     CUR_ON:   

2240 780F            659                       MOV    R0,#0FH               

2242 8002            660               SJMP   CUR1

                     661                       

2244                 662     CUR_OFF:  

2244 780C            663                       MOV    R0,#0CH               

                     664                       

2246 7A01            665     CUR1:     MOV    R2,#01

                     666               

2248 31A6            667                       CALL   ESCINST               

                     668               

224A 22              669                       RET

                     670                       

                     671     

                     672     

                     673     

                     674                       

224B                 675     TIMER_CONFIGURA_TIMER:

224B 758901          676             mov TMOD, #01h  

                     677             

224E 22              678             RET

                     679             

                     680     

                     681     

                     682     

                     683     

                     684     

                     685     

                     686     

224F                 687     TIMER_DELAY_50_MS:

224F 758C3C          688             mov TH0, #HIGH(65535 - 49987)

2252 758ABC          689             mov TL0, #LOW(65535 - 49987)

                     690             

2255 C28D            691             clr TF0

2257 D28C            692             setb TR0

                     693             

2259 308DFD          694             jnb TF0, $

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    12

                     695                     

225C C28D            696             clr TF0

225E C28C            697             clr TR0

                     698             

2260 D8ED            699             djnz R0, TIMER_DELAY_50_MS

                     700             

2262 22              701             RET

                     702             

                     703     ;***************************************************************************

                     704     ;NOME: Atraso

                     705     ;DESCRIÇÃO: Introduz um atraso (delay) de T = (60 x R0 + 48)/fosc

                     706     ;Para fosc =24MHz => R0=1 => T=4,5us a R0=0 => 0,642ms se R0= 199 => 0,5ms

                     707     ;P. ENTRADA: R0 = Valor que multiplica por 60 na fórmula (OBS.: R0 = 0 => 256)

                     708     ;P. SAIDA: -

                     709     ;Altera: R0

                     710     ;***************************************************************************

2263                 711     Atraso:

2263 00              712             NOP                     ;12

2264 00              713             NOP                     ;12

2265 00              714             NOP                     ;12

2266 D8FB            715             DJNZ            R0,Atraso       ;24

                     716             

2268 22              717             RET                     ;24

                     718     

                     719     

                     720     ;***************************************************************************

                     721     ;NOME: ATRASO_MS

                     722     ;DESCRICAO: INTRODUZ UM ATRASO DE 1ms A 256ms

                     723     ;P.ENTRADA: R2 = 1 => 1ms  A R2 = 0 => 256ms

                     724     ;P.SAIDA: -

                     725     ;ALTERA: R0,R2

2269                 726     ATRASO_MS:

2269 78C7            727             MOV             R0,#199         ;VALOR PARA ATRASO DE 0,5ms

226B 5163            728             CALL    Atraso

226D 78C7            729             MOV             R0,#199         ;VALOR PARA ATRASO DE 0,5ms

226F 5163            730             CALL    Atraso

2271 DAF6            731             DJNZ    R2,ATRASO_MS

                     732             

2273 22              733             RET

                     734     

                     735     

                     736     

                     737     

                     738     

                     739     

                     740     

                     741     

2274                 742     INT_INT0:

2274 32              743             RETI

                     744     

                     745     

                     746     

                     747     

2275                 748     INT_TIMER0:

2275 32              749             RETI

                     750             

                     751     

                     752     

                     753     

2276                 754     INT_INT1:

2276 32              755             RETI

                     756     

                     757     

                     758     

                     759     

2277                 760     INT_TIMER1:

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    13

2277 32              761             RETI

                     762             

                     763     

                     764     

                     765     

2278                 766     INT_SERIAL:

2278 32              767             RETI

                     768             

2279                 769     FIM:

                     770             END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    14

SYMBOL TABLE LISTING
------ ----- -------


N A M E                T Y P E  V A L U E   ATTRIBUTES

ACC . . . . . . . . .  D ADDR   00E0H   A   
ASTERISCO . . . . . .  N NUMB   0050H   A   
ATRASO. . . . . . . .  C ADDR   2263H   A   
ATRASO_2_S. . . . . .  C ADDR   20BCH   A   
ATRASO_MS . . . . . .  C ADDR   2269H   A   
BUSYF . . . . . . . .  B ADDR   0080H.7 A   
CLR1L . . . . . . . .  C ADDR   21CFH   A   
CLR1L1. . . . . . . .  C ADDR   21D9H   A   
CLR2L . . . . . . . .  C ADDR   21E8H   A   
CLR2L1. . . . . . . .  C ADDR   21F2H   A   
COL1. . . . . . . . .  B ADDR   00B0H.0 A   
COL2. . . . . . . . .  B ADDR   00B0H.1 A   
COL3. . . . . . . . .  B ADDR   00B0H.2 A   
COL4. . . . . . . . .  B ADDR   00B0H.3 A   
CONV_ASCII_TO_NUMBER.  C ADDR   20F0H   A   
COUNTER . . . . . . .  N NUMB   0037H   A   
CUR1. . . . . . . . .  C ADDR   2246H   A   
CUR_OFF . . . . . . .  C ADDR   2244H   A   
CUR_ON. . . . . . . .  C ADDR   2240H   A   
DIGITO0 . . . . . . .  C ADDR   2174H   A   
DIGITO1 . . . . . . .  C ADDR   2135H   A   
DIGITO2 . . . . . . .  C ADDR   213CH   A   
DIGITO3 . . . . . . .  C ADDR   2143H   A   
DIGITO4 . . . . . . .  C ADDR   214AH   A   
DIGITO5 . . . . . . .  C ADDR   2151H   A   
DIGITO6 . . . . . . .  C ADDR   2158H   A   
DIGITO7 . . . . . . .  C ADDR   215FH   A   
DIGITO8 . . . . . . .  C ADDR   2166H   A   
DIGITO9 . . . . . . .  C ADDR   216DH   A   
ESCD1 . . . . . . . .  C ADDR   2214H   A   
ESCDADO . . . . . . .  C ADDR   2201H   A   
ESCI1 . . . . . . . .  C ADDR   21B7H   A   
ESCINST . . . . . . .  C ADDR   21A6H   A   
ESCREVE_ASTERISCO . .  C ADDR   20F5H   A   
ESC_S . . . . . . . .  C ADDR   2239H   A   
ESC_STR1. . . . . . .  C ADDR   222FH   A   
ESC_STR2. . . . . . .  C ADDR   2235H   A   
E_LCD . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . .  C ADDR   2279H   A   
GOTOXY. . . . . . . .  C ADDR   21BDH   A   
GRAVA_TECLADO_2 . . .  C ADDR   217BH   A   
GRAVA_TECLADO_3 . . .  C ADDR   2180H   A   
GRAVA_TECLADO_4 . . .  C ADDR   2185H   A   
GT1 . . . . . . . . .  C ADDR   21C6H   A   
INIDISP . . . . . . .  C ADDR   2187H   A   
INT_INT0. . . . . . .  C ADDR   2274H   A   
INT_INT1. . . . . . .  C ADDR   2276H   A   
INT_SERIAL. . . . . .  C ADDR   2278H   A   
INT_TIMER0. . . . . .  C ADDR   2275H   A   
INT_TIMER1. . . . . .  C ADDR   2277H   A   
LED1. . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . .  C ADDR   20D5H   A   
LE_SENHA. . . . . . .  C ADDR   20E3H   A   
LE_SENHA_ROM. . . . .  C ADDR   20E9H   A   
LIN1. . . . . . . . .  B ADDR   00B0H.4 A   
LIN2. . . . . . . . .  B ADDR   00B0H.5 A   
LIN3. . . . . . . . .  B ADDR   00B0H.6 A   
LIN4. . . . . . . . .  B ADDR   00B0H.7 A   
MAIN. . . . . . . . .  C ADDR   20B3H   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 03/24/2017 22:01:07 PAGE    15

MSTR1 . . . . . . . .  C ADDR   2224H   A   
MSTR21. . . . . . . .  C ADDR   222EH   A   
MSTRING . . . . . . .  C ADDR   221AH   A   
MSTRINGX. . . . . . .  C ADDR   2225H   A   
P0. . . . . . . . . .  D ADDR   0080H   A   
P2. . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . .  D ADDR   00B0H   A   
RS. . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . .  N NUMB   0041H   A   
SENHA1_2. . . . . . .  N NUMB   0042H   A   
SENHA1_3. . . . . . .  N NUMB   0043H   A   
SENHA1_4. . . . . . .  N NUMB   0044H   A   
SENHA2_1. . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . .  C ADDR   2035H   A   
STR_ENTER . . . . . .  C ADDR   204BH   A   
STR_ERRO. . . . . . .  C ADDR   2086H   A   
STR_LIBERA. . . . . .  C ADDR   2064H   A   
STR_LOGO. . . . . . .  C ADDR   203AH   A   
STR_SENHA . . . . . .  C ADDR   205CH   A   
STR_TRANCA. . . . . .  C ADDR   2075H   A   
TECLADO_1 . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . .  N NUMB   0049H   A   
TF0 . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER  C ADDR   224BH   A   
TIMER_DELAY_50_MS . .  C ADDR   224FH   A   
TL0 . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . .  B ADDR   0088H.4 A   
VARREDURA_TECLADO . .  C ADDR   20FAH   A   
__STARTUP__ . . . . .  C ADDR   2097H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
