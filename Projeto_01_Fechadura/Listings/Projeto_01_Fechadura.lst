A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220EC           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223C4           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223C5           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223C6           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223C7           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223C8           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     COL1                    EQU P1.0

  0091                52     COL2                    EQU P1.1

  0092                53     COL3                    EQU P1.2

  0093                54     COL4                    EQU P1.3

                      55     

  0094                56     LIN1                    EQU P1.4

  0095                57     LIN2                    EQU P1.5

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     2

  0096                58     LIN3                    EQU P1.6

  0097                59     LIN4                    EQU P1.7

                      60             

                      61     

  00B0                62     BUZZER                  EQU P3.0        

                      63     

                      64     

  00B1                65     ESTADO_UM               EQU P3.1

  00B2                66     ESTADO_DOIS     EQU P3.2

  00B3                67     ESTADO_TRES     EQU P3.3

  00B4                68     ESTADO_QUATRO   EQU P3.4

                      69             

                      70     

  0031                71     TECLADO_1               EQU 31h

  0032                72     TECLADO_2               EQU 32h

  0033                73     TECLADO_3               EQU 33h

  0034                74     TECLADO_4               EQU 34h

                      75     

                      76     

  0035                77     SENHA1_1                EQU 35h

  0036                78     SENHA1_2                EQU 36h

  0037                79     SENHA1_3                EQU 37h

  0038                80     SENHA1_4                EQU 38h

                      81     

  0045                82     SENHA2_1                EQU 45h

  0046                83     SENHA2_2                EQU 46h

  0047                84     SENHA2_3                EQU 47h

  0048                85     SENHA2_4                EQU 48h

                      86     

  0050                87     TENTATIVAS      EQU 50h

                      88                     

                      89     

                      90     

                      91     

                      92     

2030                  93     org 2030h

2030                  94     SENHA_PADRAO_1:

2030 32383132         95                     db      '2812', 00H

2034 00                      
2035                  96     SENHA_PADRAO_2:

2035 30393132         97                     db      '0912', 00H

2039 00                      
203A                  98     STR_LOGO:

203A 2050524F         99             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 100     STR_LEONARDO_PEREIRA:

204B 4C656F6E        101             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 102     STR_RODRIGO_ENDO:

205C 2020526F        103             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 104     STR_SENHA:

206D 53454E48        105             DB      'SENHA: ',00H

2071 413A2000                
2075                 106     STR_PRESSIONE_ENTER:

2075 50524553        107             DB      'PRESSIONE ENTER ',00H

2079 53494F4E                
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     3

207D 4520454E                
2081 54455220                
2085 00                      
2086                 108     STR_SENHA_VALIDA:

2086 20205345        109             DB      '  SENHA VALIDA  ',00H

208A 4E484120                
208E 56414C49                
2092 44412020                
2096 00                      
2097                 110     STR_SENHA_INVALIDA:

2097 2053454E        111             DB      ' SENHA INVALIDA ',00H

209B 48412049                
209F 4E56414C                
20A3 49444120                
20A7 00                      
20A8                 112     STR_LIBERANDO_PORTA:

20A8 4C494245        113             DB      'LIBERANDO PORTA ',00H

20AC 52414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 114     STR_TRANCANDO_PORTA:

20B9 5452414E        115             DB      'TRANCANDO PORTA ',00H          

20BD 43414E44                
20C1 4F20504F                
20C5 52544120                
20C9 00                      
20CA                 116     STR_SISTEMA_BLOQUEADO:

20CA 504F5254        117             DB      'PORTA BLOQUEADA ',00H

20CE 4120424C                
20D2 4F515545                
20D6 41444120                
20DA 00                      
20DB                 118     STR_TIMEOUT:

20DB 20202020        119             DB      '    TIMEOUT     ',00H                  

20DF 54494D45                
20E3 4F555420                
20E7 20202020                
20EB 00                      
                     120                     

                     121     

                     122     

                     123     

                     124     

20EC                 125     __STARTUP__:

20EC 71A5            126                     CALL    TIMER_CONFIGURA_TIMER

                     127     

20EE 780F            128                     MOV     R0, #0Fh                 

20F0 122274          129                     LCALL   ACIONA_BUZZER

                     130     

20F3 902030          131                     MOV     DPTR, #2030h     

20F6 7800            132                     MOV     R0, #00h             

20F8 7935            133                     MOV     R1, #SENHA1_1    

20FA 7A04            134                     MOV     R2, #04h                 

20FC 3150            135                     CALL    LE_SENHA

                     136             

20FE 902035          137                     MOV     DPTR, #2035h     

2101 7800            138                     MOV     R0, #00h                 

2103 7945            139                     MOV     R1, #SENHA2_1    

2105 7A04            140                     MOV     R2, #04h                 

2107 3150            141                     CALL    LE_SENHA

                     142             

2109 755003          143                     MOV     TENTATIVAS, #3h  

                     144             

210C                 145     MAIN:

210C 51E1            146                     CALL    INIDISP                  

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     4

210E 90203A          147                     MOV     DPTR,#STR_LOGO   

2111 7189            148                     CALL    ESC_STR1                 

                     149                     

                     150                     

2113 7901            151                     MOV             R1, #01h

2115 71BD            152                     CALL    TIMER_DELAY_1_S

                     153                     

2117 7129            154                     CALL    CLR1L    

                     155                     

2119 90204B          156                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

211C 7189            157                     CALL    ESC_STR1                                         

                     158                     

211E 90205C          159                     MOV     DPTR, #STR_RODRIGO_ENDO          

2121 718F            160                     CALL    ESC_STR2                                         

                     161                     

                     162                     

2123 7901            163                     MOV             R1, #01h

2125 71BD            164                     CALL    TIMER_DELAY_1_S

                     165     

2127                 166     LIMPA_LCD_E_INICIA_SISTEMA:

                     167                     

2127 7129            168                     CALL    CLR1L

2129 7142            169                     CALL    CLR2L

                     170                     

212B 90206D          171                     MOV     DPTR,#STR_SENHA  

212E 7189            172                     CALL    ESC_STR1                 

                     173                     

                     174                     

2130 7800            175                     MOV     R0, #00h         

2132 7907            176                     MOV     R1, #07h         

2134 7117            177                     CALL    GOTOXY

                     178                     

2136 7931            179                     MOV     R1, #TECLADO_1   

2138 7B01            180                     MOV     R3, #1h                  

213A 7F04            181                     MOV     R7, #04h                 

213C                 182     LE_4_DIGITOS:

213C 780A            183                     MOV     R0, #0Ah                 

213E 71A9            184                     ACALL   TIMER_DELAY_20_MS

                     185                     

2140 3187            186                     ACALL   VARREDURA_TECLADO        

2142 3162            187                     CALL    ESCREVE_ASTERISCO        

                     188                     

2144 09              189                     INC R1   

2145 0B              190                     INC R3  

                     191                     

2146 DFF4            192                     DJNZ R7, LE_4_DIGITOS

                     193                     

                     194                     

2148 780A            195                     MOV     R0, #0Ah                 

214A 71A9            196                     ACALL   TIMER_DELAY_20_MS

                     197                     

214C 316C            198                     ACALL   PRESS_ENT                

                     199                     

214E 80D7            200                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     201     

                     202     

                     203     

                     204     

                     205     

                     206     

                     207     

                     208     

                     209     

                     210     

                     211     

2150                 212     LE_SENHA:

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     5

2150 3156            213             call LE_SENHA_ROM

                     214             

2152 09              215             INC R1

                     216             

2153 DAFB            217             djnz R2, LE_SENHA

                     218             

2155 22              219             RET

                     220     

2156                 221     LE_SENHA_ROM:

2156 E8              222             mov A, R0

2157 93              223             movc A, @A + DPTR

2158 F7              224             mov @R1, A

                     225             

2159 08              226             inc R0

                     227             

215A 315D            228             call CONV_ASCII_TO_NUMBER

                     229             

215C 22              230             RET

                     231             

                     232     

                     233     

                     234     

                     235     

                     236     

                     237     

                     238     

                     239     

215D                 240     CONV_ASCII_TO_NUMBER:

215D E7              241                     MOV     A, @R1

                     242             

215E 24D0            243                     ADD     A, #-30h

                     244             

2160 F7              245                     MOV     @R1, A

                     246             

2161 22              247                     RET

                     248             

                     249     

                     250     

                     251     

                     252     

                     253     

                     254     

                     255     

2162                 256     ESCREVE_ASTERISCO:              

2162 7805            257                     MOV     R0, #05h

2164 122274          258                     LCALL   ACIONA_BUZZER

                     259                     

2167 742A            260                     MOV     A, #2Ah

2169 715B            261                     CALL    ESCDADO

                     262             

216B 22              263                     RET

                     264                     

                     265     

                     266     

                     267     

                     268     

                     269     

                     270     

                     271     

                     272     

216C                 273     PRESS_ENT:

216C D294            274                     SETB    LIN1

216E D295            275                     SETB    LIN2

2170 D296            276                     SETB    LIN3

2172 C297            277                     CLR     LIN4

2174 309105          278                     JNB     COL2, CLEAR                      

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     6

2177 309372          279                     JNB     COL4, TESTA_SENHA1       

217A 80F0            280                     JMP     PRESS_ENT

                     281     

                     282     

                     283     

                     284     

                     285     

                     286     

                     287     

                     288     

                     289     

                     290     

217C                 291     CLEAR: 

217C 7805            292                     MOV     R0, #05h

217E 122274          293                     LCALL   ACIONA_BUZZER

                     294                     

2181 D0E0            295                     POP             ACC

2183 D0E0            296                     POP             ACC

2185 80A0            297                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     298                     

                     299     

                     300     

                     301     

                     302     

                     303     

                     304     

                     305     

2187                 306     VARREDURA_TECLADO:

2187 C294            307                     CLR  LIN1

2189 D295            308                     SETB LIN2

218B D296            309                     SETB LIN3

218D D297            310                     SETB LIN4

218F 30912D          311                     JNB  COL2, DIGITO1

2192 30922E          312                     JNB  COL3, DIGITO2

2195 30932F          313                     JNB  COL4, DIGITO3

                     314                     

2198 C295            315                     CLR  LIN2

219A D294            316                     SETB LIN1

219C 30912C          317                     JNB  COL2, DIGITO4

219F 30922D          318                     JNB  COL3, DIGITO5

21A2 30932E          319                     JNB  COL4, DIGITO6

                     320                     

21A5 C296            321                     CLR  LIN3

21A7 D295            322                     SETB LIN2

21A9 30912B          323                     JNB  COL2, DIGITO7

21AC 30922C          324                     JNB  COL3, DIGITO8

21AF 30932D          325                     JNB  COL4, DIGITO9

                     326                     

21B2 C297            327                     CLR  LIN4

21B4 D296            328                     SETB LIN3

21B6 3091C3          329                     JNB  COL2, CLEAR

21B9 309227          330                     JNB  COL3, DIGITO0

21BC 80C9            331                     JMP  VARREDURA_TECLADO

                     332                     

21BE 22              333                     RET

                     334                     

                     335     

                     336     

                     337     

                     338     

                     339     

                     340     

                     341     

                     342     

21BF 7401            343     DIGITO1: MOV A, #1h

21C1 21E7            344                      AJMP GRAVA_DIGITO

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     7

21C3 7402            345     DIGITO2: MOV A, #2h

21C5 21E7            346                      AJMP GRAVA_DIGITO

21C7 7403            347     DIGITO3: MOV A, #3h

21C9 21E7            348                      AJMP GRAVA_DIGITO

21CB 7404            349     DIGITO4: MOV A, #4h

21CD 21E7            350                      AJMP GRAVA_DIGITO

21CF 7405            351     DIGITO5: MOV A, #5h

21D1 21E7            352                      AJMP GRAVA_DIGITO

21D3 7406            353     DIGITO6: MOV A, #6h

21D5 21E7            354                      AJMP GRAVA_DIGITO

21D7 7407            355     DIGITO7: MOV A, #7h

21D9 21E7            356                      AJMP GRAVA_DIGITO

21DB 7408            357     DIGITO8: MOV A, #8h

21DD 21E7            358                      AJMP GRAVA_DIGITO

21DF 7409            359     DIGITO9: MOV A, #9h

21E1 21E7            360                      AJMP GRAVA_DIGITO

21E3 7400            361     DIGITO0: MOV A, #0h

21E5 21E7            362                      AJMP GRAVA_DIGITO

                     363                      

21E7                 364     GRAVA_DIGITO:

21E7 BB017C          365                     CJNE R3, #1h, GRAVA_TECLADO_2

21EA F7              366                     MOV @R1, A

                     367             

21EB 22              368                     RET

                     369     

                     370     

                     371     

                     372     

                     373     

                     374     

                     375     

                     376     

                     377     

21EC                 378     TESTA_SENHA1:

21EC 7805            379                     MOV     R0, #05h

21EE 122274          380                     LCALL   ACIONA_BUZZER

                     381                     

21F1 E535            382                     MOV             A, SENHA1_1

21F3 B53111          383                     CJNE    A, TECLADO_1, TESTA_SENHA2

21F6 E536            384                     MOV             A, SENHA1_2

21F8 B5320C          385                     CJNE    A, TECLADO_2, TESTA_SENHA2

21FB E537            386                     MOV             A, SENHA1_3

21FD B53307          387                     CJNE    A, TECLADO_3, TESTA_SENHA2

2200 E538            388                     MOV             A, SENHA1_4

2202 B53402          389                     CJNE    A, TECLADO_4, TESTA_SENHA2

2205 8035            390                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     391             

2207                 392     TESTA_SENHA2:

2207 E545            393                     MOV             A, SENHA2_1

2209 B53111          394                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

220C E546            395                     MOV             A, SENHA2_2

220E B5320C          396                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2211 E547            397                     MOV             A, SENHA2_3

2213 B53307          398                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2216 E548            399                     MOV             A, SENHA2_4

2218 B53402          400                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221B 801F            401                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     402                     

221D                 403     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     404                     

221D 7129            405                     CALL    CLR1L

221F 7142            406                     CALL    CLR2L

                     407                     

2221 902097          408                     MOV     DPTR,#STR_SENHA_INVALIDA         

2224 7189            409                     CALL    ESC_STR1                                         

                     410                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     8

                     411                     

2226 7864            412                     MOV     R0, #064h

2228 122274          413                     LCALL   ACIONA_BUZZER

                     414                     

                     415                     

222B 7901            416                     MOV             R1, #01h

222D 71BD            417                     CALL    TIMER_DELAY_1_S

                     418                     

222F D55009          419                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     420                     

2232 7129            421                     CALL    CLR1L

2234 9020CA          422                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

2237 7189            423                     CALL    ESC_STR1                                         

                     424                     

2239 61C9            425                     JMP     FIM

                     426     

223B                 427     REINICIA_SISTEMA:

223B 22              428                     RET

                     429                     

223C                 430     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

223C 755003          431                     MOV     TENTATIVAS, #3h  

                     432                     

                     433                     

223F 7129            434                     CALL    CLR1L

2241 7142            435                     CALL    CLR2L

                     436                     

2243 902086          437                     MOV     DPTR,#STR_SENHA_VALIDA   

2246 7189            438                     CALL    ESC_STR1                                 

                     439                     

                     440                     

2248 7832            441                     MOV     R0, #032h

224A 122274          442                     LCALL   ACIONA_BUZZER

                     443                     

224D 9020A8          444                     MOV     DPTR, #STR_LIBERANDO_PORTA       

2250 718F            445                     CALL    ESC_STR2                                         

                     446                     

2252 7D1A            447                     MOV     R5, #1Ah

2254 12227B          448                     LCALL   ABRE_FECHADURA

                     449                     

                     450                     

2257 7903            451                     MOV             R1, #03h

2259 71BD            452                     CALL    TIMER_DELAY_1_S

                     453                     

225B 9020B9          454                     MOV     DPTR, #STR_TRANCANDO_PORTA       

225E 718F            455                     CALL    ESC_STR2                                         

                     456                     

2260 7D1A            457                     MOV     R5, #1Ah

2262 1222AE          458                     LCALL   TRANCA_FECHADURA

                     459                     

2265 22              460                     RET

                     461                      

                     462     

                     463     

                     464     

                     465     

                     466     

                     467     

                     468     

2266 BB0202          469     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

2269 4172            470                                      AJMP GRAVA_TECLADO_X

226B BB0302          471     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

226E 4172            472                                      AJMP GRAVA_TECLADO_X           

2270 4172            473     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X

                     474     

2272                 475     GRAVA_TECLADO_X:

2272 F7              476                      MOV @R1, A

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE     9

                     477                      

2273 22              478                      RET

                     479                      

                     480     

                     481     

                     482     

                     483     

2274                 484     ACIONA_BUZZER:

2274 D2B0            485                     SETB    BUZZER

2276 71A9            486                     ACALL   TIMER_DELAY_20_MS

2278 C2B0            487                     CLR     BUZZER

                     488                     

227A 22              489                     RET

                     490                     

                     491     

                     492     

                     493     

227B                 494     ABRE_FECHADURA:

227B C2B2            495                     CLR             ESTADO_DOIS

227D C2B3            496                     CLR             ESTADO_TRES

227F C2B4            497                     CLR             ESTADO_QUATRO

2281 D2B1            498                     SETB    ESTADO_UM

                     499                     

2283 7805            500                     MOV     R0, #05h

2285 71A9            501                     ACALL   TIMER_DELAY_20_MS

                     502                     

2287 D2B2            503                     SETB    ESTADO_DOIS

2289 C2B3            504                     CLR             ESTADO_TRES

228B C2B4            505                     CLR             ESTADO_QUATRO

228D C2B1            506                     CLR             ESTADO_UM

                     507                     

228F 7805            508                     MOV     R0, #05h

2291 71A9            509                     ACALL   TIMER_DELAY_20_MS

                     510                     

2293 C2B2            511                     CLR             ESTADO_DOIS

2295 D2B3            512                     SETB    ESTADO_TRES

2297 C2B4            513                     CLR             ESTADO_QUATRO

2299 C2B1            514                     CLR             ESTADO_UM

                     515                     

229B 7805            516                     MOV     R0, #05h

229D 71A9            517                     ACALL   TIMER_DELAY_20_MS

                     518                     

229F C2B2            519                     CLR             ESTADO_DOIS

22A1 C2B3            520                     CLR             ESTADO_TRES

22A3 D2B4            521                     SETB    ESTADO_QUATRO

22A5 C2B1            522                     CLR             ESTADO_UM

                     523                     

22A7 7805            524                     MOV     R0, #05h

22A9 71A9            525                     ACALL   TIMER_DELAY_20_MS

                     526                     

22AB DDCE            527                     DJNZ    R5, ABRE_FECHADURA

                     528                     

22AD 22              529                     RET

                     530                     

22AE                 531     TRANCA_FECHADURA:

22AE C2B2            532                     CLR             ESTADO_DOIS

22B0 C2B3            533                     CLR             ESTADO_TRES

22B2 D2B4            534                     SETB    ESTADO_QUATRO

22B4 C2B1            535                     CLR             ESTADO_UM

                     536                     

22B6 7805            537                     MOV     R0, #05h

22B8 71A9            538                     ACALL   TIMER_DELAY_20_MS

                     539                     

22BA C2B2            540                     CLR             ESTADO_DOIS

22BC D2B3            541                     SETB    ESTADO_TRES

22BE C2B4            542                     CLR             ESTADO_QUATRO

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    10

22C0 C2B1            543                     CLR             ESTADO_UM

                     544                     

22C2 7805            545                     MOV     R0, #05h

22C4 71A9            546                     ACALL   TIMER_DELAY_20_MS

                     547                     

22C6 D2B2            548                     SETB    ESTADO_DOIS

22C8 C2B3            549                     CLR             ESTADO_TRES

22CA C2B4            550                     CLR             ESTADO_QUATRO

22CC C2B1            551                     CLR             ESTADO_UM

                     552                     

22CE 7805            553                     MOV     R0, #05h

22D0 71A9            554                     ACALL   TIMER_DELAY_20_MS

                     555                     

22D2 C2B2            556                     CLR             ESTADO_DOIS

22D4 C2B3            557                     CLR             ESTADO_TRES

22D6 C2B4            558                     CLR             ESTADO_QUATRO

22D8 D2B1            559                     SETB    ESTADO_UM

                     560                     

22DA 7805            561                     MOV     R0, #05h

22DC 71A9            562                     ACALL   TIMER_DELAY_20_MS

                     563                     

22DE DDCE            564                     DJNZ    R5, TRANCA_FECHADURA

                     565     

22E0 22              566                     RET

                     567     

                     568     

                     569     

                     570             

                     571     

                     572     

                     573     

                     574     

                     575     

                     576     

                     577     

                     578     

                     579     

22E1                 580     INIDISP:                       

22E1 7838            581             MOV     R0,#38H          

22E3 7A05            582             MOV     R2,#05           

22E5 7100            583             CALL    ESCINST          

                     584             

22E7 7838            585                     MOV     R0,#38H          

22E9 7A01            586             MOV     R2,#01           

22EB 7100            587             CALL    ESCINST          

                     588             

22ED 7806            589                     MOV     R0,#06H          

22EF 7A01            590             MOV     R2,#01           

22F1 7100            591             CALL    ESCINST          

                     592             

22F3 780C            593                     MOV     R0,#0CH          

22F5 7A01            594             MOV     R2,#01           

22F7 7100            595             CALL    ESCINST          

                     596             

22F9 7801            597                     MOV     R0,#01H          

22FB 7A02            598             MOV     R2,#02           

22FD 7100            599             CALL    ESCINST          

                     600             

22FF 22              601                     RET

                     602                     

                     603     

                     604     

                     605     

                     606     

                     607     

                     608     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    11

                     609     

                     610     

                     611     

2300                 612     ESCINST:  

2300 C2A6            613                     CLR             RW                               

2302 C2A5            614                     CLR     RS               

2304 D2A7            615                     SETB    E_LCD            

                     616                     

2306 8880            617                     MOV     P0,R0            

                     618                     

2308 C2A7            619                     CLR     E_LCD            

                     620                     

230A 7580FF          621                     MOV             P0,#0xFF                 

                     622                     

230D D2A6            623                     SETB    RW                               

230F D2A7            624                     SETB    E_LCD            

                     625     

2311 2087FD          626     ESCI1:  JB      BUSYF,ESCI1                      

                     627                     

2314 C2A7            628                     CLR     E_LCD            

                     629             

2316 22              630                     RET

                     631                     

                     632     

                     633     

                     634     

                     635     

                     636     

                     637     

                     638     

                     639     

2317                 640     GOTOXY: 

2317 C0E0            641                     PUSH    ACC

                     642             

2319 7480            643                     MOV     A,#80H

231B B80102          644             CJNE    R0,#01,GT1       

                     645             

231E 74C0            646                     MOV     A,#0C0H

                     647                     

2320 49              648     GT1:    ORL     A,R1             

2321 F8              649             MOV     R0,A

2322 7A01            650             MOV     R2,#01           

                     651             

2324 7100            652                     CALL    ESCINST          

                     653             

2326 D0E0            654                     POP     ACC

                     655             

2328 22              656                     RET

                     657             

                     658     

                     659     

                     660     

                     661     

                     662     

                     663     

                     664     

                     665     

2329                 666     CLR1L:    

2329 C0E0            667             PUSH   ACC

                     668             

232B 7800            669                     MOV    R0,#00               

232D 7900            670             MOV    R1,#00

                     671             

232F 7117            672                     CALL   GOTOXY

                     673             

2331 7910            674                     MOV    R1,#16               

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    12

                     675     

2333 7420            676     CLR1L1: MOV    A,#' '               

                     677             

2335 715B            678                     CALL   ESCDADO

                     679             

2337 D9FA            680                     DJNZ   R1,CLR1L1

2339 7800            681             MOV    R0,#00               

233B 7900            682             MOV    R1,#00

                     683             

233D 7117            684                     CALL   GOTOXY

                     685             

233F D0E0            686                     POP    ACC

                     687             

2341 22              688                     RET

                     689                     

                     690     

                     691     

                     692     

                     693     

                     694     

                     695     

                     696     

                     697     

2342                 698     CLR2L:    

2342 C0E0            699             PUSH   ACC

                     700             

2344 7801            701                     MOV    R0,#01               

2346 7900            702             MOV    R1,#00

                     703             

2348 7117            704                     CALL   GOTOXY

                     705             

234A 7910            706                     MOV    R1,#16               

                     707     

234C 7420            708     CLR2L1: MOV    A,#' '               

                     709             

234E 715B            710                     CALL   ESCDADO

                     711             

2350 D9FA            712                     DJNZ   R1,CLR2L1

2352 7801            713             MOV    R0,#01               

2354 7900            714             MOV    R1,#00

                     715             

2356 7117            716                     CALL   GOTOXY

                     717             

2358 D0E0            718                     POP    ACC

                     719             

235A 22              720                     RET

                     721                

                     722     

                     723     

                     724     

                     725     

                     726     

                     727     

                     728     

235B                 729     ESCDADO:  

235B C2A6            730                     CLR             RW                               

235D D2A5            731             SETB    RS               

235F D2A7            732             SETB    E_LCD            

                     733                     

2361 F580            734             MOV     P0,A             

                     735             

2363 C2A7            736                     CLR     E_LCD            

                     737                     

2365 7580FF          738                     MOV             P0,#0xFF                 

                     739                     

2368 D2A6            740                     SETB    RW                               

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    13

236A C2A5            741                     CLR             RS                               

236C D2A7            742                     SETB    E_LCD            

                     743     

236E 2087FD          744     ESCD1:  JB              BUSYF,ESCD1              

                     745     

2371 C2A7            746                     CLR     E_LCD            

                     747     

2373 22              748             RET

                     749                     

                     750     

                     751     

                     752     

                     753     

                     754     

                     755     

                     756     

                     757     

                     758     

2374                 759     MSTRING:  

2374 E4              760                       CLR    A

2375 93              761               MOVC   A,@A+DPTR       

                     762               

2376 6006            763                       JZ     MSTR1

                     764               

2378 12235B          765                       LCALL  ESCDADO         

                     766               

237B A3              767                       INC    DPTR

                     768               

237C 80F6            769                       SJMP   MSTRING

                     770                       

237E 22              771     MSTR1:    RET

                     772                

                     773     

                     774     

                     775     

                     776     

                     777     

                     778     

                     779     

                     780     

                     781     

237F                 782     MSTRINGX: 

237F E0              783                       MOVX   A,@DPTR         

                     784               

2380 6006            785                       JZ     MSTR21

                     786               

2382 12235B          787                       LCALL  ESCDADO         

                     788               

2385 A3              789                       INC    DPTR

                     790               

2386 80F7            791                       SJMP   MSTRINGX

                     792     

2388 22              793     MSTR21:   RET

                     794     

                     795     

                     796     

                     797     

                     798     

                     799     

                     800     

                     801     

                     802     

                     803     

2389                 804     ESC_STR1: 

                     805                       

2389 7800            806                       MOV    R0,#00         

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    14

238B 7900            807               MOV    R1,#00

                     808               

238D 8004            809                       JMP    ESC_S

                     810               

                     811     

                     812     

                     813     

                     814     

                     815     

                     816     

                     817     

                     818     

                     819     

238F                 820     ESC_STR2: 

                     821                       

238F 7801            822                       MOV    R0,#01         

2391 7900            823               MOV    R1,#00

                     824                       

2393 122317          825     ESC_S:    LCALL  GOTOXY          

                     826               

2396 122374          827                       LCALL  MSTRING

                     828               

2399 22              829                       RET

                     830     

                     831     

                     832     

                     833     

                     834     

                     835     

                     836     

                     837     ; DESTROI: R0,R2                                                                        //

                     838     

239A                 839     CUR_ON:   

239A 780F            840                       MOV    R0,#0FH               

239C 8002            841               SJMP   CUR1

                     842                       

239E                 843     CUR_OFF:  

239E 780C            844                       MOV    R0,#0CH               

                     845                       

23A0 7A01            846     CUR1:     MOV    R2,#01

                     847               

23A2 7100            848                       CALL   ESCINST               

                     849               

23A4 22              850                       RET

                     851                       

                     852     

                     853     

                     854     

                     855                       

23A5                 856     TIMER_CONFIGURA_TIMER:

23A5 758901          857                     MOV TMOD, #01h  

                     858             

23A8 22              859                     RET

                     860             

                     861     

                     862     

                     863     

                     864     

                     865     

                     866     

                     867     

23A9                 868     TIMER_DELAY_20_MS:

23A9 758C56          869                     MOV TH0, #HIGH(65535 - 43350)

23AC 758AA9          870                     MOV TL0, #LOW(65535 - 43350)

                     871             

23AF C28D            872                     CLR TF0

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    15

23B1 D28C            873                     SETB TR0

                     874             

23B3 308DFD          875                     JNB TF0, $

                     876                     

23B6 C28D            877                     CLR TF0

23B8 C28C            878                     CLR TR0

                     879             

23BA D8ED            880                     DJNZ R0, TIMER_DELAY_20_MS

                     881             

23BC 22              882                     RET

                     883             

                     884     

                     885     

                     886     

                     887     

                     888     

                     889     

                     890     

23BD                 891     TIMER_DELAY_1_S:

23BD 7832            892                     MOV             R0, #50d

23BF 71A9            893                     CALL    TIMER_DELAY_20_MS

                     894                     

23C1 D9FA            895                     DJNZ    R1, TIMER_DELAY_1_S

                     896             

23C3 22              897                     RET

                     898     

                     899     

                     900     

                     901     

                     902     

                     903     

                     904     

                     905     

23C4                 906     INT_INT0:

23C4 32              907                     RETI

                     908     

                     909     

                     910     

                     911     

23C5                 912     INT_TIMER0:

23C5 32              913                     RETI

                     914             

                     915     

                     916     

                     917     

23C6                 918     INT_INT1:

23C6 32              919                     RETI

                     920     

                     921     

                     922     

                     923     

23C7                 924     INT_TIMER1:

23C7 32              925                     RETI

                     926             

                     927     

                     928     

                     929     

23C8                 930     INT_SERIAL:

23C8 32              931                     RETI

                     932             

23C9                 933     FIM:

                     934                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    16

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   227BH   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   2274H   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   217CH   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   2329H   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   2333H   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   2342H   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   234CH   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   215DH   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   23A0H   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   239EH   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   239AH   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21E3H   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   21BFH   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21C3H   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21C7H   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21CBH   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21CFH   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21D3H   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21D7H   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21DBH   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21DFH   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   236EH   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   235BH   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   2311H   A   
ESCINST . . . . . . . . . . . . .  C ADDR   2300H   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   2162H   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   2393H   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   2389H   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   238FH   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23C9H   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   2317H   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21E7H   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   2266H   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   226BH   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   2270H   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   2272H   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   2320H   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22E1H   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23C4H   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23C6H   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23C8H   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23C5H   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23C7H   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   213CH   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   2150H   A   
LE_SENHA_ROM. . . . . . . . . . .  C ADDR   2156H   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:47:44 PAGE    17

LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2127H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   221DH   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   223CH   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   210CH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   237EH   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   2388H   A   
MSTRING . . . . . . . . . . . . .  C ADDR   2374H   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   237FH   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   216CH   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   223BH   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_PRESSIONE_ENTER . . . . . . .  C ADDR   2075H   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2097H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2086H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20CAH   A   
STR_TIMEOUT . . . . . . . . . . .  C ADDR   20DBH   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20B9H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21ECH   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   2207H   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   23A5H   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   23BDH   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   23A9H   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   22AEH   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   2187H   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20ECH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
