A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220EC           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223CD           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223CE           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223CF           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223D0           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223D1           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     COL1                    EQU P1.0

  0091                52     COL2                    EQU P1.1

  0092                53     COL3                    EQU P1.2

  0093                54     COL4                    EQU P1.3

                      55     

  0094                56     LIN1                    EQU P1.4

  0095                57     LIN2                    EQU P1.5

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     2

  0096                58     LIN3                    EQU P1.6

  0097                59     LIN4                    EQU P1.7

                      60             

                      61     

  00B0                62     BUZZER                  EQU P3.0        

                      63     

                      64     

  00B1                65     ESTADO_UM               EQU P3.1

  00B2                66     ESTADO_DOIS     EQU P3.2

  00B3                67     ESTADO_TRES     EQU P3.3

  00B4                68     ESTADO_QUATRO   EQU P3.4

                      69             

                      70     

  0031                71     TECLADO_1               EQU 31h

  0032                72     TECLADO_2               EQU 32h

  0033                73     TECLADO_3               EQU 33h

  0034                74     TECLADO_4               EQU 34h

                      75     

                      76     

  0035                77     SENHA1_1                EQU 35h

  0036                78     SENHA1_2                EQU 36h

  0037                79     SENHA1_3                EQU 37h

  0038                80     SENHA1_4                EQU 38h

                      81     

  0045                82     SENHA2_1                EQU 45h

  0046                83     SENHA2_2                EQU 46h

  0047                84     SENHA2_3                EQU 47h

  0048                85     SENHA2_4                EQU 48h

                      86     

  0050                87     TENTATIVAS      EQU 50h

                      88                     

                      89     

                      90     

                      91     

                      92     

2030                  93     org 2030h

2030                  94     SENHA_PADRAO_1:

2030 32383132         95                     db      '2812', 00H

2034 00                      
2035                  96     SENHA_PADRAO_2:

2035 30393132         97                     db      '0912', 00H

2039 00                      
203A                  98     STR_LOGO:

203A 2050524F         99             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 100     STR_LEONARDO_PEREIRA:

204B 4C656F6E        101             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 102     STR_RODRIGO_ENDO:

205C 2020526F        103             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 104     STR_SENHA:

206D 53454E48        105             DB      'SENHA: ',00H

2071 413A2000                
2075                 106     STR_PRESSIONE_ENTER:

2075 50524553        107             DB      'PRESSIONE ENTER ',00H

2079 53494F4E                
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     3

207D 4520454E                
2081 54455220                
2085 00                      
2086                 108     STR_SENHA_VALIDA:

2086 20205345        109             DB      '  SENHA VALIDA  ',00H

208A 4E484120                
208E 56414C49                
2092 44412020                
2096 00                      
2097                 110     STR_SENHA_INVALIDA:

2097 2053454E        111             DB      ' SENHA INVALIDA ',00H

209B 48412049                
209F 4E56414C                
20A3 49444120                
20A7 00                      
20A8                 112     STR_LIBERANDO_PORTA:

20A8 4C494245        113             DB      'LIBERANDO PORTA ',00H

20AC 52414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 114     STR_TRANCANDO_PORTA:

20B9 5452414E        115             DB      'TRANCANDO PORTA ',00H          

20BD 43414E44                
20C1 4F20504F                
20C5 52544120                
20C9 00                      
20CA                 116     STR_SISTEMA_BLOQUEADO:

20CA 504F5254        117             DB      'PORTA BLOQUEADA ',00H

20CE 4120424C                
20D2 4F515545                
20D6 41444120                
20DA 00                      
20DB                 118     STR_TIMEOUT:

20DB 20202020        119             DB      '    TIMEOUT     ',00H                  

20DF 54494D45                
20E3 4F555420                
20E7 20202020                
20EB 00                      
                     120                     

                     121     

                     122     

                     123     

                     124     

20EC                 125     __STARTUP__:

20EC 71AE            126                     CALL    TIMER_CONFIGURA_TIMER

                     127     

20EE 780F            128                     MOV     R0, #0Fh                 

20F0 12227D          129                     LCALL   ACIONA_BUZZER

                     130     

20F3 902030          131                     MOV     DPTR, #2030h     

20F6 7800            132                     MOV     R0, #00h             

20F8 7935            133                     MOV     R1, #SENHA1_1    

20FA 7A04            134                     MOV     R2, #04h                 

20FC 3159            135                     CALL    LE_SENHA

                     136             

20FE 902035          137                     MOV     DPTR, #2035h     

2101 7800            138                     MOV     R0, #00h                 

2103 7945            139                     MOV     R1, #SENHA2_1    

2105 7A04            140                     MOV     R2, #04h                 

2107 3159            141                     CALL    LE_SENHA

                     142             

2109 755003          143                     MOV     TENTATIVAS, #3h  

                     144             

210C                 145     MAIN:

210C 51EA            146                     CALL    INIDISP                  

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     4

210E 90203A          147                     MOV     DPTR,#STR_LOGO   

2111 7192            148                     CALL    ESC_STR1                 

                     149                     

                     150                     

2113 7901            151                     MOV             R1, #01h

2115 71C6            152                     CALL    TIMER_DELAY_1_S

                     153                     

2117 7132            154                     CALL    CLR1L    

                     155                     

2119 90204B          156                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

211C 7192            157                     CALL    ESC_STR1                                         

                     158                     

211E 90205C          159                     MOV     DPTR, #STR_RODRIGO_ENDO          

2121 7198            160                     CALL    ESC_STR2                                         

                     161                     

                     162                     

2123 7901            163                     MOV             R1, #01h

2125 71C6            164                     CALL    TIMER_DELAY_1_S

                     165     

2127                 166     LIMPA_LCD_E_INICIA_SISTEMA:

                     167                     

2127 7132            168                     CALL    CLR1L

2129 714B            169                     CALL    CLR2L

                     170                     

                     171                     

212B 902075          172                     MOV     DPTR,#STR_PRESSIONE_ENTER        

212E 7192            173                     CALL    ESC_STR1                                         

                     174                     

2130 3175            175                     ACALL   PRESS_ENT                

                     176                     

2132 7132            177                     CALL    CLR1L

                     178                     

                     179                     

2134 90206D          180                     MOV     DPTR,#STR_SENHA  

2137 7192            181                     CALL    ESC_STR1                 

                     182                     

                     183                     

2139 7800            184                     MOV     R0, #00h         

213B 7907            185                     MOV     R1, #07h         

213D 7120            186                     CALL    GOTOXY

                     187                     

213F 7931            188                     MOV     R1, #TECLADO_1   

2141 7B01            189                     MOV     R3, #1h                  

2143 7F04            190                     MOV     R7, #04h                 

2145                 191     LE_4_DIGITOS:

2145 780A            192                     MOV     R0, #0Ah                 

2147 71B2            193                     ACALL   TIMER_DELAY_20_MS

                     194                     

2149 3190            195                     ACALL   VARREDURA_TECLADO        

214B 316B            196                     CALL    ESCREVE_ASTERISCO        

                     197                     

214D 09              198                     INC R1   

214E 0B              199                     INC R3  

                     200                     

214F DFF4            201                     DJNZ R7, LE_4_DIGITOS  

                     202                     

                     203                     

2151 780A            204                     MOV     R0, #0Ah                 

2153 71B2            205                     ACALL   TIMER_DELAY_20_MS

                     206                     

2155 3175            207                     ACALL   PRESS_ENT                

                     208                     

2157 80CE            209                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     210     

                     211     

                     212     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     5

                     213     

                     214     

                     215     

                     216     

                     217     

                     218     

                     219     

                     220     

2159                 221     LE_SENHA:

2159 315F            222                     CALL    LE_SENHA_ROM

                     223             

215B 09              224                     INC     R1

                     225             

215C DAFB            226                     DJNZ    R2, LE_SENHA

                     227             

215E 22              228                     RET

                     229     

215F                 230     LE_SENHA_ROM:

215F E8              231                     MOV     A, R0

2160 93              232                     MOVC    A, @A + DPTR

2161 F7              233                     MOV             @R1, A

                     234             

2162 08              235                     INC             R0

                     236             

2163 3166            237                     CALL    CONV_ASCII_TO_NUMBER

                     238             

2165 22              239                     RET

                     240             

                     241     

                     242     

                     243     

                     244     

                     245     

                     246     

                     247     

                     248     

2166                 249     CONV_ASCII_TO_NUMBER:

2166 E7              250                     MOV     A, @R1

                     251             

2167 24D0            252                     ADD     A, #-30h

                     253             

2169 F7              254                     MOV     @R1, A

                     255             

216A 22              256                     RET

                     257             

                     258     

                     259     

                     260     

                     261     

                     262     

                     263     

                     264     

216B                 265     ESCREVE_ASTERISCO:              

216B 7805            266                     MOV     R0, #05h

216D 12227D          267                     LCALL   ACIONA_BUZZER

                     268                     

2170 742A            269                     MOV     A, #2Ah  

2172 7164            270                     CALL    ESCDADO

                     271             

2174 22              272                     RET

                     273                     

                     274     

                     275     

                     276     

                     277     

                     278     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     6

                     279     

                     280     

                     281     

2175                 282     PRESS_ENT:

2175 D294            283                     SETB    LIN1

2177 D295            284                     SETB    LIN2

2179 D296            285                     SETB    LIN3

217B C297            286                     CLR     LIN4

217D 309105          287                     JNB     COL2, CLEAR                      

2180 309372          288                     JNB     COL4, TESTA_SENHA1       

2183 80F0            289                     JMP     PRESS_ENT

                     290     

                     291     

                     292     

                     293     

                     294     

                     295     

                     296     

                     297     

                     298     

                     299     

2185                 300     CLEAR: 

2185 7805            301                     MOV     R0, #05h

2187 12227D          302                     LCALL   ACIONA_BUZZER

                     303                     

218A D0E0            304                     POP             ACC

218C D0E0            305                     POP             ACC

218E 8097            306                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     307                     

                     308     

                     309     

                     310     

                     311     

                     312     

                     313     

                     314     

2190                 315     VARREDURA_TECLADO:

2190 C294            316                     CLR  LIN1

2192 D295            317                     SETB LIN2

2194 D296            318                     SETB LIN3

2196 D297            319                     SETB LIN4

2198 30912D          320                     JNB  COL2, DIGITO1

219B 30922E          321                     JNB  COL3, DIGITO2

219E 30932F          322                     JNB  COL4, DIGITO3

                     323                     

21A1 C295            324                     CLR  LIN2

21A3 D294            325                     SETB LIN1

21A5 30912C          326                     JNB  COL2, DIGITO4

21A8 30922D          327                     JNB  COL3, DIGITO5

21AB 30932E          328                     JNB  COL4, DIGITO6

                     329                     

21AE C296            330                     CLR  LIN3

21B0 D295            331                     SETB LIN2

21B2 30912B          332                     JNB  COL2, DIGITO7

21B5 30922C          333                     JNB  COL3, DIGITO8

21B8 30932D          334                     JNB  COL4, DIGITO9

                     335                     

21BB C297            336                     CLR  LIN4

21BD D296            337                     SETB LIN3

21BF 3091C3          338                     JNB  COL2, CLEAR

21C2 309227          339                     JNB  COL3, DIGITO0

21C5 80C9            340                     JMP  VARREDURA_TECLADO

                     341                     

21C7 22              342                     RET

                     343                     

                     344     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     7

                     345     

                     346     

                     347     

                     348     

                     349     

                     350     

                     351     

21C8 7401            352     DIGITO1: MOV A, #1h

21CA 21F0            353                      AJMP GRAVA_DIGITO

21CC 7402            354     DIGITO2: MOV A, #2h

21CE 21F0            355                      AJMP GRAVA_DIGITO

21D0 7403            356     DIGITO3: MOV A, #3h

21D2 21F0            357                      AJMP GRAVA_DIGITO

21D4 7404            358     DIGITO4: MOV A, #4h

21D6 21F0            359                      AJMP GRAVA_DIGITO

21D8 7405            360     DIGITO5: MOV A, #5h

21DA 21F0            361                      AJMP GRAVA_DIGITO

21DC 7406            362     DIGITO6: MOV A, #6h

21DE 21F0            363                      AJMP GRAVA_DIGITO

21E0 7407            364     DIGITO7: MOV A, #7h

21E2 21F0            365                      AJMP GRAVA_DIGITO

21E4 7408            366     DIGITO8: MOV A, #8h

21E6 21F0            367                      AJMP GRAVA_DIGITO

21E8 7409            368     DIGITO9: MOV A, #9h

21EA 21F0            369                      AJMP GRAVA_DIGITO

21EC 7400            370     DIGITO0: MOV A, #0h

21EE 21F0            371                      AJMP GRAVA_DIGITO

                     372                      

21F0                 373     GRAVA_DIGITO:

21F0 BB017C          374                     CJNE R3, #1h, GRAVA_TECLADO_2

21F3 F7              375                     MOV @R1, A

                     376             

21F4 22              377                     RET

                     378     

                     379     

                     380     

                     381     

                     382     

                     383     

                     384     

                     385     

                     386     

21F5                 387     TESTA_SENHA1:

21F5 7805            388                     MOV     R0, #05h

21F7 12227D          389                     LCALL   ACIONA_BUZZER

                     390                     

21FA E535            391                     MOV             A, SENHA1_1

21FC B53111          392                     CJNE    A, TECLADO_1, TESTA_SENHA2

21FF E536            393                     MOV             A, SENHA1_2

2201 B5320C          394                     CJNE    A, TECLADO_2, TESTA_SENHA2

2204 E537            395                     MOV             A, SENHA1_3

2206 B53307          396                     CJNE    A, TECLADO_3, TESTA_SENHA2

2209 E538            397                     MOV             A, SENHA1_4

220B B53402          398                     CJNE    A, TECLADO_4, TESTA_SENHA2

220E 8035            399                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     400             

2210                 401     TESTA_SENHA2:

2210 E545            402                     MOV             A, SENHA2_1

2212 B53111          403                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2215 E546            404                     MOV             A, SENHA2_2

2217 B5320C          405                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221A E547            406                     MOV             A, SENHA2_3

221C B53307          407                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221F E548            408                     MOV             A, SENHA2_4

2221 B53402          409                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2224 801F            410                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     8

                     411                     

2226                 412     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     413                     

2226 7132            414                     CALL    CLR1L

2228 714B            415                     CALL    CLR2L

                     416                     

222A 902097          417                     MOV     DPTR,#STR_SENHA_INVALIDA         

222D 7192            418                     CALL    ESC_STR1                                         

                     419                     

                     420                     

222F 7864            421                     MOV     R0, #064h

2231 12227D          422                     LCALL   ACIONA_BUZZER

                     423                     

                     424                     

2234 7901            425                     MOV             R1, #01h

2236 71C6            426                     CALL    TIMER_DELAY_1_S

                     427                     

2238 D55009          428                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     429                     

223B 7132            430                     CALL    CLR1L

223D 9020CA          431                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

2240 7192            432                     CALL    ESC_STR1                                         

                     433                     

2242 61D2            434                     JMP     FIM

                     435     

2244                 436     REINICIA_SISTEMA:

2244 22              437                     RET

                     438                     

2245                 439     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

2245 755003          440                     MOV     TENTATIVAS, #3h  

                     441                     

                     442                     

2248 7132            443                     CALL    CLR1L

224A 714B            444                     CALL    CLR2L

                     445                     

224C 902086          446                     MOV     DPTR,#STR_SENHA_VALIDA   

224F 7192            447                     CALL    ESC_STR1                                 

                     448                     

                     449                     

2251 7832            450                     MOV     R0, #032h

2253 12227D          451                     LCALL   ACIONA_BUZZER

                     452                     

2256 9020A8          453                     MOV     DPTR, #STR_LIBERANDO_PORTA       

2259 7198            454                     CALL    ESC_STR2                                         

                     455                     

225B 7D1A            456                     MOV     R5, #1Ah

225D 122284          457                     LCALL   ABRE_FECHADURA

                     458                     

                     459                     

2260 7903            460                     MOV             R1, #03h

2262 71C6            461                     CALL    TIMER_DELAY_1_S

                     462                     

2264 9020B9          463                     MOV     DPTR, #STR_TRANCANDO_PORTA       

2267 7198            464                     CALL    ESC_STR2                                         

                     465                     

2269 7D1A            466                     MOV     R5, #1Ah

226B 1222B7          467                     LCALL   TRANCA_FECHADURA

                     468                     

226E 22              469                     RET

                     470                      

                     471     

                     472     

                     473     

                     474     

                     475     

                     476     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE     9

                     477     

226F BB0202          478     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

2272 417B            479                                      AJMP GRAVA_TECLADO_X

2274 BB0302          480     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

2277 417B            481                                      AJMP GRAVA_TECLADO_X           

2279 417B            482     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X

                     483     

227B                 484     GRAVA_TECLADO_X:

227B F7              485                      MOV @R1, A

                     486                      

227C 22              487                      RET

                     488                      

                     489     

                     490     

                     491     

                     492     

227D                 493     ACIONA_BUZZER:

227D D2B0            494                     SETB    BUZZER

227F 71B2            495                     ACALL   TIMER_DELAY_20_MS

2281 C2B0            496                     CLR     BUZZER

                     497                     

2283 22              498                     RET

                     499                     

                     500     

                     501     

                     502     

2284                 503     ABRE_FECHADURA:

2284 C2B2            504                     CLR             ESTADO_DOIS

2286 C2B3            505                     CLR             ESTADO_TRES

2288 C2B4            506                     CLR             ESTADO_QUATRO

228A D2B1            507                     SETB    ESTADO_UM

                     508                     

228C 7805            509                     MOV     R0, #05h

228E 71B2            510                     ACALL   TIMER_DELAY_20_MS

                     511                     

2290 D2B2            512                     SETB    ESTADO_DOIS

2292 C2B3            513                     CLR             ESTADO_TRES

2294 C2B4            514                     CLR             ESTADO_QUATRO

2296 C2B1            515                     CLR             ESTADO_UM

                     516                     

2298 7805            517                     MOV     R0, #05h

229A 71B2            518                     ACALL   TIMER_DELAY_20_MS

                     519                     

229C C2B2            520                     CLR             ESTADO_DOIS

229E D2B3            521                     SETB    ESTADO_TRES

22A0 C2B4            522                     CLR             ESTADO_QUATRO

22A2 C2B1            523                     CLR             ESTADO_UM

                     524                     

22A4 7805            525                     MOV     R0, #05h

22A6 71B2            526                     ACALL   TIMER_DELAY_20_MS

                     527                     

22A8 C2B2            528                     CLR             ESTADO_DOIS

22AA C2B3            529                     CLR             ESTADO_TRES

22AC D2B4            530                     SETB    ESTADO_QUATRO

22AE C2B1            531                     CLR             ESTADO_UM

                     532                     

22B0 7805            533                     MOV     R0, #05h

22B2 71B2            534                     ACALL   TIMER_DELAY_20_MS

                     535                     

22B4 DDCE            536                     DJNZ    R5, ABRE_FECHADURA

                     537                     

22B6 22              538                     RET

                     539                     

22B7                 540     TRANCA_FECHADURA:

22B7 C2B2            541                     CLR             ESTADO_DOIS

22B9 C2B3            542                     CLR             ESTADO_TRES

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    10

22BB D2B4            543                     SETB    ESTADO_QUATRO

22BD C2B1            544                     CLR             ESTADO_UM

                     545                     

22BF 7805            546                     MOV     R0, #05h

22C1 71B2            547                     ACALL   TIMER_DELAY_20_MS

                     548                     

22C3 C2B2            549                     CLR             ESTADO_DOIS

22C5 D2B3            550                     SETB    ESTADO_TRES

22C7 C2B4            551                     CLR             ESTADO_QUATRO

22C9 C2B1            552                     CLR             ESTADO_UM

                     553                     

22CB 7805            554                     MOV     R0, #05h

22CD 71B2            555                     ACALL   TIMER_DELAY_20_MS

                     556                     

22CF D2B2            557                     SETB    ESTADO_DOIS

22D1 C2B3            558                     CLR             ESTADO_TRES

22D3 C2B4            559                     CLR             ESTADO_QUATRO

22D5 C2B1            560                     CLR             ESTADO_UM

                     561                     

22D7 7805            562                     MOV     R0, #05h

22D9 71B2            563                     ACALL   TIMER_DELAY_20_MS

                     564                     

22DB C2B2            565                     CLR             ESTADO_DOIS

22DD C2B3            566                     CLR             ESTADO_TRES

22DF C2B4            567                     CLR             ESTADO_QUATRO

22E1 D2B1            568                     SETB    ESTADO_UM

                     569                     

22E3 7805            570                     MOV     R0, #05h

22E5 71B2            571                     ACALL   TIMER_DELAY_20_MS

                     572                     

22E7 DDCE            573                     DJNZ    R5, TRANCA_FECHADURA

                     574     

22E9 22              575                     RET

                     576     

                     577     

                     578     

                     579             

                     580     

                     581     

                     582     

                     583     

                     584     

                     585     

                     586     

                     587     

                     588     

22EA                 589     INIDISP:                       

22EA 7838            590             MOV     R0,#38H          

22EC 7A05            591             MOV     R2,#05           

22EE 7109            592             CALL    ESCINST          

                     593             

22F0 7838            594                     MOV     R0,#38H          

22F2 7A01            595             MOV     R2,#01           

22F4 7109            596             CALL    ESCINST          

                     597             

22F6 7806            598                     MOV     R0,#06H          

22F8 7A01            599             MOV     R2,#01           

22FA 7109            600             CALL    ESCINST          

                     601             

22FC 780C            602                     MOV     R0,#0CH          

22FE 7A01            603             MOV     R2,#01           

2300 7109            604             CALL    ESCINST          

                     605             

2302 7801            606                     MOV     R0,#01H          

2304 7A02            607             MOV     R2,#02           

2306 7109            608             CALL    ESCINST          

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    11

                     609             

2308 22              610                     RET

                     611                     

                     612     

                     613     

                     614     

                     615     

                     616     

                     617     

                     618     

                     619     

                     620     

2309                 621     ESCINST:  

2309 C2A6            622                     CLR             RW                               

230B C2A5            623                     CLR     RS               

230D D2A7            624                     SETB    E_LCD            

                     625                     

230F 8880            626                     MOV     P0,R0            

                     627                     

2311 C2A7            628                     CLR     E_LCD            

                     629                     

2313 7580FF          630                     MOV             P0,#0xFF                 

                     631                     

2316 D2A6            632                     SETB    RW                               

2318 D2A7            633                     SETB    E_LCD            

                     634     

231A 2087FD          635     ESCI1:  JB      BUSYF,ESCI1                      

                     636                     

231D C2A7            637                     CLR     E_LCD            

                     638             

231F 22              639                     RET

                     640                     

                     641     

                     642     

                     643     

                     644     

                     645     

                     646     

                     647     

                     648     

2320                 649     GOTOXY: 

2320 C0E0            650                     PUSH    ACC

                     651             

2322 7480            652                     MOV     A,#80H

2324 B80102          653             CJNE    R0,#01,GT1       

                     654             

2327 74C0            655                     MOV     A,#0C0H

                     656                     

2329 49              657     GT1:    ORL     A,R1             

232A F8              658             MOV     R0,A

232B 7A01            659             MOV     R2,#01           

                     660             

232D 7109            661                     CALL    ESCINST          

                     662             

232F D0E0            663                     POP     ACC

                     664             

2331 22              665                     RET

                     666             

                     667     

                     668     

                     669     

                     670     

                     671     

                     672     

                     673     

                     674     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    12

2332                 675     CLR1L:    

2332 C0E0            676             PUSH   ACC

                     677             

2334 7800            678                     MOV    R0,#00               

2336 7900            679             MOV    R1,#00

                     680             

2338 7120            681                     CALL   GOTOXY

                     682             

233A 7910            683                     MOV    R1,#16               

                     684     

233C 7420            685     CLR1L1: MOV    A,#' '               

                     686             

233E 7164            687                     CALL   ESCDADO

                     688             

2340 D9FA            689                     DJNZ   R1,CLR1L1

2342 7800            690             MOV    R0,#00               

2344 7900            691             MOV    R1,#00

                     692             

2346 7120            693                     CALL   GOTOXY

                     694             

2348 D0E0            695                     POP    ACC

                     696             

234A 22              697                     RET

                     698                     

                     699     

                     700     

                     701     

                     702     

                     703     

                     704     

                     705     

                     706     

234B                 707     CLR2L:    

234B C0E0            708             PUSH   ACC

                     709             

234D 7801            710                     MOV    R0,#01               

234F 7900            711             MOV    R1,#00

                     712             

2351 7120            713                     CALL   GOTOXY

                     714             

2353 7910            715                     MOV    R1,#16               

                     716     

2355 7420            717     CLR2L1: MOV    A,#' '               

                     718             

2357 7164            719                     CALL   ESCDADO

                     720             

2359 D9FA            721                     DJNZ   R1,CLR2L1

235B 7801            722             MOV    R0,#01               

235D 7900            723             MOV    R1,#00

                     724             

235F 7120            725                     CALL   GOTOXY

                     726             

2361 D0E0            727                     POP    ACC

                     728             

2363 22              729                     RET

                     730                

                     731     

                     732     

                     733     

                     734     

                     735     

                     736     

                     737     

2364                 738     ESCDADO:  

2364 C2A6            739                     CLR             RW                               

2366 D2A5            740             SETB    RS               

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    13

2368 D2A7            741             SETB    E_LCD            

                     742                     

236A F580            743             MOV     P0,A             

                     744             

236C C2A7            745                     CLR     E_LCD            

                     746                     

236E 7580FF          747                     MOV             P0,#0xFF                 

                     748                     

2371 D2A6            749                     SETB    RW                               

2373 C2A5            750                     CLR             RS                               

2375 D2A7            751                     SETB    E_LCD            

                     752     

2377 2087FD          753     ESCD1:  JB              BUSYF,ESCD1              

                     754     

237A C2A7            755                     CLR     E_LCD            

                     756     

237C 22              757             RET

                     758                     

                     759     

                     760     

                     761     

                     762     

                     763     

                     764     

                     765     

                     766     

                     767     

237D                 768     MSTRING:  

237D E4              769                       CLR    A

237E 93              770               MOVC   A,@A+DPTR       

                     771               

237F 6006            772                       JZ     MSTR1

                     773               

2381 122364          774                       LCALL  ESCDADO         

                     775               

2384 A3              776                       INC    DPTR

                     777               

2385 80F6            778                       SJMP   MSTRING

                     779                       

2387 22              780     MSTR1:    RET

                     781                

                     782     

                     783     

                     784     

                     785     

                     786     

                     787     

                     788     

                     789     

                     790     

2388                 791     MSTRINGX: 

2388 E0              792                       MOVX   A,@DPTR         

                     793               

2389 6006            794                       JZ     MSTR21

                     795               

238B 122364          796                       LCALL  ESCDADO         

                     797               

238E A3              798                       INC    DPTR

                     799               

238F 80F7            800                       SJMP   MSTRINGX

                     801     

2391 22              802     MSTR21:   RET

                     803     

                     804     

                     805     

                     806     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    14

                     807     

                     808     

                     809     

                     810     

                     811     

                     812     

2392                 813     ESC_STR1: 

                     814                       

2392 7800            815                       MOV    R0,#00         

2394 7900            816               MOV    R1,#00

                     817               

2396 8004            818                       JMP    ESC_S

                     819               

                     820     

                     821     

                     822     

                     823     

                     824     

                     825     

                     826     

                     827     

                     828     

2398                 829     ESC_STR2: 

                     830                       

2398 7801            831                       MOV    R0,#01         

239A 7900            832               MOV    R1,#00

                     833                       

239C 122320          834     ESC_S:    LCALL  GOTOXY          

                     835               

239F 12237D          836                       LCALL  MSTRING

                     837               

23A2 22              838                       RET

                     839     

                     840     

                     841     

                     842     

                     843     

                     844     

                     845     

                     846     ; DESTROI: R0,R2                                                                        //

                     847     

23A3                 848     CUR_ON:   

23A3 780F            849                       MOV    R0,#0FH               

23A5 8002            850               SJMP   CUR1

                     851                       

23A7                 852     CUR_OFF:  

23A7 780C            853                       MOV    R0,#0CH               

                     854                       

23A9 7A01            855     CUR1:     MOV    R2,#01

                     856               

23AB 7109            857                       CALL   ESCINST               

                     858               

23AD 22              859                       RET

                     860                       

                     861     

                     862     

                     863     

                     864                       

23AE                 865     TIMER_CONFIGURA_TIMER:

23AE 758901          866                     MOV TMOD, #01h  

                     867             

23B1 22              868                     RET

                     869             

                     870     

                     871     

                     872     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    15

                     873     

                     874     

                     875     

                     876     

23B2                 877     TIMER_DELAY_20_MS:

23B2 758C56          878                     MOV TH0, #HIGH(65535 - 43350)

23B5 758AA9          879                     MOV TL0, #LOW(65535 - 43350)

                     880             

23B8 C28D            881                     CLR TF0

23BA D28C            882                     SETB TR0

                     883             

23BC 308DFD          884                     JNB TF0, $

                     885                     

23BF C28D            886                     CLR TF0

23C1 C28C            887                     CLR TR0

                     888             

23C3 D8ED            889                     DJNZ R0, TIMER_DELAY_20_MS

                     890             

23C5 22              891                     RET

                     892             

                     893     

                     894     

                     895     

                     896     

                     897     

                     898     

                     899     

23C6                 900     TIMER_DELAY_1_S:

23C6 7832            901                     MOV             R0, #50d

23C8 71B2            902                     CALL    TIMER_DELAY_20_MS

                     903                     

23CA D9FA            904                     DJNZ    R1, TIMER_DELAY_1_S

                     905             

23CC 22              906                     RET

                     907     

                     908     

                     909     

                     910     

                     911     

                     912     

                     913     

                     914     

23CD                 915     INT_INT0:

23CD 32              916                     RETI

                     917     

                     918     

                     919     

                     920     

23CE                 921     INT_TIMER0:

23CE 32              922                     RETI

                     923             

                     924     

                     925     

                     926     

23CF                 927     INT_INT1:

23CF 32              928                     RETI

                     929     

                     930     

                     931     

                     932     

23D0                 933     INT_TIMER1:

23D0 32              934                     RETI

                     935             

                     936     

                     937     

                     938     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    16

23D1                 939     INT_SERIAL:

23D1 32              940                     RETI

                     941             

23D2                 942     FIM:

                     943                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    17

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   2284H   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   227DH   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   2185H   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   2332H   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   233CH   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   234BH   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   2355H   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   2166H   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   23A9H   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   23A7H   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   23A3H   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21ECH   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   21C8H   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21CCH   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21D0H   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21D4H   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21D8H   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21DCH   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21E0H   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21E4H   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21E8H   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   2377H   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   2364H   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   231AH   A   
ESCINST . . . . . . . . . . . . .  C ADDR   2309H   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   216BH   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   239CH   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   2392H   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   2398H   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23D2H   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   2320H   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21F0H   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   226FH   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   2274H   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   2279H   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   227BH   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   2329H   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22EAH   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23CDH   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23CFH   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23D1H   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23CEH   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23D0H   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   2145H   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   2159H   A   
LE_SENHA_ROM. . . . . . . . . . .  C ADDR   215FH   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 21:58:38 PAGE    18

LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2127H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   2226H   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   2245H   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   210CH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   2387H   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   2391H   A   
MSTRING . . . . . . . . . . . . .  C ADDR   237DH   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   2388H   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   2175H   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   2244H   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_PRESSIONE_ENTER . . . . . . .  C ADDR   2075H   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2097H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2086H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20CAH   A   
STR_TIMEOUT . . . . . . . . . . .  C ADDR   20DBH   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20B9H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21F5H   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   2210H   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   23AEH   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   23C6H   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   23B2H   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   22B7H   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   2190H   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20ECH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
