A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220EC           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223B0           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223B1           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223B2           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223B3           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223B4           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     TECLADO                 EQU     P1

                      52     

  0090                53     COL1                    EQU P1.0

  0091                54     COL2                    EQU P1.1

  0092                55     COL3                    EQU P1.2

  0093                56     COL4                    EQU P1.3

                      57     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     2

  0094                58     LIN1                    EQU P1.4

  0095                59     LIN2                    EQU P1.5

  0096                60     LIN3                    EQU P1.6

  0097                61     LIN4                    EQU P1.7

                      62             

                      63     

  00B0                64     BUZZER                  EQU P3.0        

                      65     

                      66     

  00B1                67     ESTADO_UM               EQU P3.1

  00B2                68     ESTADO_DOIS     EQU P3.2

  00B3                69     ESTADO_TRES     EQU P3.3

  00B4                70     ESTADO_QUATRO   EQU P3.4

                      71             

                      72     

  0031                73     TECLADO_1               EQU 31h

  0032                74     TECLADO_2               EQU 32h

  0033                75     TECLADO_3               EQU 33h

  0034                76     TECLADO_4               EQU 34h

                      77     

                      78     

  0035                79     SENHA1_1                EQU 35h

  0036                80     SENHA1_2                EQU 36h

  0037                81     SENHA1_3                EQU 37h

  0038                82     SENHA1_4                EQU 38h

                      83     

  0045                84     SENHA2_1                EQU 45h

  0046                85     SENHA2_2                EQU 46h

  0047                86     SENHA2_3                EQU 47h

  0048                87     SENHA2_4                EQU 48h

                      88     

  0050                89     TENTATIVAS      EQU 50h

                      90                     

                      91     

                      92     

                      93     

                      94     

2030                  95     org 2030h

2030                  96     SENHA_PADRAO_1:

2030 32383132         97                     db      '2812', 00H

2034 00                      
2035                  98     SENHA_PADRAO_2:

2035 30393132         99                     db      '0912', 00H

2039 00                      
203A                 100     STR_LOGO:

203A 2050524F        101             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 102     STR_LEONARDO_PEREIRA:

204B 4C656F6E        103             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 104     STR_RODRIGO_ENDO:

205C 2020526F        105             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 106     STR_SENHA:

206D 53454E48        107             DB      'SENHA: ',00H

2071 413A2000                
2075                 108     STR_PRESSIONE_ENTER:

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     3

2075 50524553        109             DB      'PRESSIONE ENTER ',00H

2079 53494F4E                
207D 4520454E                
2081 54455220                
2085 00                      
2086                 110     STR_SENHA_VALIDA:

2086 20205345        111             DB      '  SENHA VALIDA  ',00H

208A 4E484120                
208E 56414C49                
2092 44412020                
2096 00                      
2097                 112     STR_SENHA_INVALIDA:

2097 2053454E        113             DB      ' SENHA INVALIDA ',00H

209B 48412049                
209F 4E56414C                
20A3 49444120                
20A7 00                      
20A8                 114     STR_LIBERANDO_PORTA:

20A8 4C494245        115             DB      'LIBERANDO PORTA ',00H

20AC 52414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 116     STR_TRANCANDO_PORTA:

20B9 5452414E        117             DB      'TRANCANDO PORTA ',00H          

20BD 43414E44                
20C1 4F20504F                
20C5 52544120                
20C9 00                      
20CA                 118     STR_SISTEMA_BLOQUEADO:

20CA 504F5254        119             DB      'PORTA BLOQUEADA ',00H

20CE 4120424C                
20D2 4F515545                
20D6 41444120                
20DA 00                      
20DB                 120     STR_TIMEOUT:

20DB 20202020        121             DB      '    TIMEOUT     ',00H                  

20DF 54494D45                
20E3 4F555420                
20E7 20202020                
20EB 00                      
                     122                     

                     123     

                     124     

                     125     

                     126     

20EC                 127     __STARTUP__:

20EC 7191            128                     CALL    TIMER_CONFIGURA_TIMER

                     129     

20EE 780F            130                     MOV     R0, #0Fh                 

20F0 122278          131                     LCALL   ACIONA_BUZZER

                     132     

20F3 902030          133                     MOV     DPTR, #2030h     

20F6 7800            134                     MOV     R0, #00h             

20F8 7935            135                     MOV     R1, #SENHA1_1    

20FA 7A04            136                     MOV     R2, #04h                 

20FC 3159            137                     CALL    LE_SENHA

                     138             

20FE 902035          139                     MOV     DPTR, #2035h     

2101 7800            140                     MOV     R0, #00h                 

2103 7945            141                     MOV     R1, #SENHA2_1    

2105 7A04            142                     MOV     R2, #04h                 

2107 3159            143                     CALL    LE_SENHA

                     144             

2109 755003          145                     MOV     TENTATIVAS, #3h  

                     146             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     4

210C                 147     MAIN:

210C 51CD            148                     CALL    INIDISP                  

210E 90203A          149                     MOV     DPTR,#STR_LOGO   

2111 7175            150                     CALL    ESC_STR1                 

                     151                     

                     152                     

2113 7901            153                     MOV             R1, #01h

2115 71A9            154                     CALL    TIMER_DELAY_1_S

                     155                     

2117 7115            156                     CALL    CLR1L    

                     157                     

2119 90204B          158                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

211C 7175            159                     CALL    ESC_STR1                                         

                     160                     

211E 90205C          161                     MOV     DPTR, #STR_RODRIGO_ENDO          

2121 717B            162                     CALL    ESC_STR2                                         

                     163                     

                     164                     

2123 7901            165                     MOV             R1, #01h

2125 71A9            166                     CALL    TIMER_DELAY_1_S

                     167     

2127                 168     LIMPA_LCD_E_INICIA_SISTEMA:

                     169                     

2127 7115            170                     CALL    CLR1L

2129 712E            171                     CALL    CLR2L

                     172                     

                     173                     

212B 902075          174                     MOV     DPTR,#STR_PRESSIONE_ENTER        

212E 7175            175                     CALL    ESC_STR1                                         

                     176                     

2130 3175            177                     ACALL   PRESS_ENT                

                     178                     

2132 7115            179                     CALL    CLR1L

                     180                     

                     181                     

2134 90206D          182                     MOV     DPTR,#STR_SENHA  

2137 7175            183                     CALL    ESC_STR1                 

                     184                     

                     185                     

2139 7800            186                     MOV     R0, #00h         

213B 7907            187                     MOV     R1, #07h         

213D 7103            188                     CALL    GOTOXY

                     189                     

213F 7931            190                     MOV     R1, #TECLADO_1   

2141 7B01            191                     MOV     R3, #1h                  

2143 7F04            192                     MOV     R7, #04h                 

2145                 193     LE_4_DIGITOS:

2145 780A            194                     MOV     R0, #0Ah                 

2147 7195            195                     ACALL   TIMER_DELAY_20_MS

                     196                     

2149 318B            197                     ACALL   VARREDURA_TECLADO        

214B 316B            198                     CALL    ESCREVE_ASTERISCO        

                     199                     

214D 09              200                     INC R1   

214E 0B              201                     INC R3  

                     202                     

214F DFF4            203                     DJNZ R7, LE_4_DIGITOS  

                     204                     

                     205                     

2151 780A            206                     MOV     R0, #0Ah                 

2153 7195            207                     ACALL   TIMER_DELAY_20_MS

                     208                     

2155 3175            209                     ACALL   PRESS_ENT                

                     210                     

2157 80CE            211                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     212     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     5

                     213     

                     214     

                     215     

                     216     

                     217     

                     218     

                     219     

                     220     

                     221     

                     222     

2159                 223     LE_SENHA:

2159 315F            224                     CALL    LE_SENHA_ROM

                     225             

215B 09              226                     INC     R1

                     227             

215C DAFB            228                     DJNZ    R2, LE_SENHA

                     229             

215E 22              230                     RET

                     231     

215F                 232     LE_SENHA_ROM:

215F E8              233                     MOV     A, R0

2160 93              234                     MOVC    A, @A + DPTR

2161 F7              235                     MOV             @R1, A

                     236             

2162 08              237                     INC             R0

                     238             

2163 3166            239                     CALL    CONV_ASCII_TO_NUMBER

                     240             

2165 22              241                     RET

                     242             

                     243     

                     244     

                     245     

                     246     

                     247     

                     248     

                     249     

                     250     

2166                 251     CONV_ASCII_TO_NUMBER:

2166 E7              252                     MOV     A, @R1

                     253             

2167 24D0            254                     ADD     A, #-30h

                     255             

2169 F7              256                     MOV     @R1, A

                     257             

216A 22              258                     RET

                     259             

                     260     

                     261     

                     262     

                     263     

                     264     

                     265     

                     266     

216B                 267     ESCREVE_ASTERISCO:              

216B 7805            268                     MOV     R0, #05h

216D 122278          269                     LCALL   ACIONA_BUZZER

                     270                     

2170 742A            271                     MOV     A, #2Ah  

2172 7147            272                     CALL    ESCDADO

                     273             

2174 22              274                     RET

                     275                     

                     276     

                     277     

                     278     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     6

                     279     

                     280     

                     281     

                     282     

                     283     

2175                 284     PRESS_ENT:

                     285                     

2175 75907F          286                     MOV             TECLADO, #01111111b

                     287                     

2178                 288     VARRE_ENT:

2178 309105          289                     JNB     COL2, CLEAR                      

217B 309372          290                     JNB     COL4, TESTA_SENHA1       

                     291                     

217E 80F8            292                     JMP     VARRE_ENT

                     293     

                     294     

                     295     

                     296     

                     297     

                     298     

                     299     

                     300     

                     301     

                     302     

2180                 303     CLEAR: 

2180 7805            304                     MOV     R0, #05h

2182 122278          305                     LCALL   ACIONA_BUZZER

                     306                     

2185 D0E0            307                     POP             ACC

2187 D0E0            308                     POP             ACC

2189 809C            309                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     310                     

                     311     

                     312     

                     313     

                     314     

                     315     

                     316     

                     317     

218B                 318     VARREDURA_TECLADO:

218B C294            319                     CLR  LIN1

218D D295            320                     SETB LIN2

218F D296            321                     SETB LIN3

2191 D297            322                     SETB LIN4

2193 30912D          323                     JNB  COL2, DIGITO1

2196 30922E          324                     JNB  COL3, DIGITO2

2199 30932F          325                     JNB  COL4, DIGITO3

                     326                     

219C C295            327                     CLR  LIN2

219E D294            328                     SETB LIN1

21A0 30912C          329                     JNB  COL2, DIGITO4

21A3 30922D          330                     JNB  COL3, DIGITO5

21A6 30932E          331                     JNB  COL4, DIGITO6

                     332                     

21A9 C296            333                     CLR  LIN3

21AB D295            334                     SETB LIN2

21AD 30912B          335                     JNB  COL2, DIGITO7

21B0 30922C          336                     JNB  COL3, DIGITO8

21B3 30932D          337                     JNB  COL4, DIGITO9

                     338                     

21B6 C297            339                     CLR  LIN4

21B8 D296            340                     SETB LIN3

21BA 3091C3          341                     JNB  COL2, CLEAR

21BD 309227          342                     JNB  COL3, DIGITO0

21C0 80C9            343                     JMP  VARREDURA_TECLADO

                     344                     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     7

21C2 22              345                     RET

                     346                     

                     347     

                     348     

                     349     

                     350     

                     351     

                     352     

                     353     

                     354     

21C3 7401            355     DIGITO1: MOV A, #1h

21C5 21EB            356                      AJMP GRAVA_DIGITO

21C7 7402            357     DIGITO2: MOV A, #2h

21C9 21EB            358                      AJMP GRAVA_DIGITO

21CB 7403            359     DIGITO3: MOV A, #3h

21CD 21EB            360                      AJMP GRAVA_DIGITO

21CF 7404            361     DIGITO4: MOV A, #4h

21D1 21EB            362                      AJMP GRAVA_DIGITO

21D3 7405            363     DIGITO5: MOV A, #5h

21D5 21EB            364                      AJMP GRAVA_DIGITO

21D7 7406            365     DIGITO6: MOV A, #6h

21D9 21EB            366                      AJMP GRAVA_DIGITO

21DB 7407            367     DIGITO7: MOV A, #7h

21DD 21EB            368                      AJMP GRAVA_DIGITO

21DF 7408            369     DIGITO8: MOV A, #8h

21E1 21EB            370                      AJMP GRAVA_DIGITO

21E3 7409            371     DIGITO9: MOV A, #9h

21E5 21EB            372                      AJMP GRAVA_DIGITO

21E7 7400            373     DIGITO0: MOV A, #0h

21E9 21EB            374                      AJMP GRAVA_DIGITO

                     375                      

21EB                 376     GRAVA_DIGITO:

21EB BB017E          377                     CJNE R3, #1h, GRAVA_TECLADO_2

21EE F7              378                     MOV @R1, A

                     379             

21EF 22              380                     RET

                     381     

                     382     

                     383     

                     384     

                     385     

                     386     

                     387     

                     388     

                     389     

21F0                 390     TESTA_SENHA1:

21F0 7805            391                     MOV     R0, #05h

21F2 122278          392                     LCALL   ACIONA_BUZZER

                     393                     

21F5 E535            394                     MOV             A, SENHA1_1

21F7 B53111          395                     CJNE    A, TECLADO_1, TESTA_SENHA2

21FA E536            396                     MOV             A, SENHA1_2

21FC B5320C          397                     CJNE    A, TECLADO_2, TESTA_SENHA2

21FF E537            398                     MOV             A, SENHA1_3

2201 B53307          399                     CJNE    A, TECLADO_3, TESTA_SENHA2

2204 E538            400                     MOV             A, SENHA1_4

2206 B53402          401                     CJNE    A, TECLADO_4, TESTA_SENHA2

2209 8035            402                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     403             

220B                 404     TESTA_SENHA2:

220B E545            405                     MOV             A, SENHA2_1

220D B53111          406                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2210 E546            407                     MOV             A, SENHA2_2

2212 B5320C          408                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2215 E547            409                     MOV             A, SENHA2_3

2217 B53307          410                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     8

221A E548            411                     MOV             A, SENHA2_4

221C B53402          412                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221F 801F            413                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     414                     

2221                 415     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     416                     

2221 7115            417                     CALL    CLR1L

2223 712E            418                     CALL    CLR2L

                     419                     

2225 902097          420                     MOV     DPTR,#STR_SENHA_INVALIDA         

2228 7175            421                     CALL    ESC_STR1                                         

                     422                     

                     423                     

222A 7864            424                     MOV     R0, #064h

222C 122278          425                     LCALL   ACIONA_BUZZER

                     426                     

                     427                     

222F 7901            428                     MOV             R1, #01h

2231 71A9            429                     CALL    TIMER_DELAY_1_S

                     430                     

2233 D55009          431                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     432                     

2236 7115            433                     CALL    CLR1L

2238 9020CA          434                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

223B 7175            435                     CALL    ESC_STR1                                         

                     436                     

223D 61B5            437                     JMP     FIM

                     438     

223F                 439     REINICIA_SISTEMA:

223F 22              440                     RET

                     441                     

2240                 442     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

2240 755003          443                     MOV     TENTATIVAS, #3h  

                     444                     

                     445                     

2243 7115            446                     CALL    CLR1L

2245 712E            447                     CALL    CLR2L

                     448                     

2247 902086          449                     MOV     DPTR,#STR_SENHA_VALIDA   

224A 7175            450                     CALL    ESC_STR1                                 

                     451                     

                     452                     

224C 7832            453                     MOV     R0, #032h

224E 122278          454                     LCALL   ACIONA_BUZZER

                     455                     

2251 9020A8          456                     MOV     DPTR, #STR_LIBERANDO_PORTA       

2254 717B            457                     CALL    ESC_STR2                                         

                     458                     

                     459                     

2256 7D1A            460                     MOV     R5, #1Ah

2258 12227F          461                     LCALL   ABRE_FECHADURA

                     462                     

                     463                     

225B 7903            464                     MOV             R1, #03h

225D 71A9            465                     CALL    TIMER_DELAY_1_S

                     466                     

225F 712E            467                     CALL    CLR2L                                            

2261 9020B9          468                     MOV     DPTR, #STR_TRANCANDO_PORTA       

2264 717B            469                     CALL    ESC_STR2                                         

                     470                     

                     471                     

2266 7D1A            472                     MOV     R5, #1Ah

2268 1222A6          473                     LCALL   TRANCA_FECHADURA

                     474                     

226B 22              475                     RET

                     476                      

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE     9

                     477     

                     478     

                     479     

                     480     

                     481     

                     482     

                     483     

226C BB0202          484     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

226F 4176            485                                      AJMP GRAVA_TECLADO_X

2271 BB0300          486     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

2274 4176            487     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X           

                     488     

2276                 489     GRAVA_TECLADO_X:

2276 F7              490                      MOV @R1, A

                     491                      

2277 22              492                      RET

                     493                      

                     494     

                     495     

                     496     

                     497     

2278                 498     ACIONA_BUZZER:

2278 D2B0            499                     SETB    BUZZER

227A 7195            500                     ACALL   TIMER_DELAY_20_MS

227C C2B0            501                     CLR     BUZZER

                     502                     

227E 22              503                     RET

                     504                     

                     505     

                     506     

                     507     

227F                 508     ABRE_FECHADURA:

227F D2B1            509                     SETB    ESTADO_UM

2281 C2B2            510                     CLR             ESTADO_DOIS

2283 C2B3            511                     CLR             ESTADO_TRES

2285 C2B4            512                     CLR             ESTADO_QUATRO

                     513                     

2287 7805            514                     MOV     R0, #05h

2289 7195            515                     ACALL   TIMER_DELAY_20_MS

                     516                     

228B C2B1            517                     CLR             ESTADO_UM

228D D2B2            518                     SETB    ESTADO_DOIS

                     519                     

228F 7805            520                     MOV     R0, #05h

2291 7195            521                     ACALL   TIMER_DELAY_20_MS

                     522                     

2293 C2B2            523                     CLR             ESTADO_DOIS

2295 D2B3            524                     SETB    ESTADO_TRES

                     525                     

2297 7805            526                     MOV     R0, #05h

2299 7195            527                     ACALL   TIMER_DELAY_20_MS

                     528                     

229B C2B3            529                     CLR             ESTADO_TRES

229D D2B4            530                     SETB    ESTADO_QUATRO

                     531                     

229F 7805            532                     MOV     R0, #05h

22A1 7195            533                     ACALL   TIMER_DELAY_20_MS

                     534                     

22A3 DDDA            535                     DJNZ    R5, ABRE_FECHADURA

                     536                     

22A5 22              537                     RET

                     538                     

22A6                 539     TRANCA_FECHADURA:

22A6 C2B1            540                     CLR             ESTADO_UM

22A8 C2B2            541                     CLR             ESTADO_DOIS

22AA C2B3            542                     CLR             ESTADO_TRES

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    10

22AC D2B4            543                     SETB    ESTADO_QUATRO

                     544                     

22AE 7805            545                     MOV     R0, #05h

22B0 7195            546                     ACALL   TIMER_DELAY_20_MS

                     547                     

22B2 D2B3            548                     SETB    ESTADO_TRES

22B4 C2B4            549                     CLR             ESTADO_QUATRO

                     550                     

22B6 7805            551                     MOV     R0, #05h

22B8 7195            552                     ACALL   TIMER_DELAY_20_MS

                     553                     

22BA D2B2            554                     SETB    ESTADO_DOIS

22BC C2B3            555                     CLR             ESTADO_TRES

                     556                     

22BE 7805            557                     MOV     R0, #05h

22C0 7195            558                     ACALL   TIMER_DELAY_20_MS

                     559                     

22C2 D2B1            560                     SETB    ESTADO_UM

22C4 C2B2            561                     CLR             ESTADO_DOIS

                     562                     

22C6 7805            563                     MOV     R0, #05h

22C8 7195            564                     ACALL   TIMER_DELAY_20_MS

                     565                     

22CA DDDA            566                     DJNZ    R5, TRANCA_FECHADURA

                     567     

22CC 22              568                     RET

                     569     

                     570     

                     571     

                     572             

                     573     

                     574     

                     575     

                     576     

                     577     

                     578     

                     579     

                     580     

                     581     

22CD                 582     INIDISP:                       

22CD 7838            583             MOV     R0,#38H          

22CF 7A05            584             MOV     R2,#05           

22D1 51EC            585             CALL    ESCINST          

                     586             

22D3 7838            587                     MOV     R0,#38H          

22D5 7A01            588             MOV     R2,#01           

22D7 51EC            589             CALL    ESCINST          

                     590             

22D9 7806            591                     MOV     R0,#06H          

22DB 7A01            592             MOV     R2,#01           

22DD 51EC            593             CALL    ESCINST          

                     594             

22DF 780C            595                     MOV     R0,#0CH          

22E1 7A01            596             MOV     R2,#01           

22E3 51EC            597             CALL    ESCINST          

                     598             

22E5 7801            599                     MOV     R0,#01H          

22E7 7A02            600             MOV     R2,#02           

22E9 51EC            601             CALL    ESCINST          

                     602             

22EB 22              603                     RET

                     604                     

                     605     

                     606     

                     607     

                     608     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    11

                     609     

                     610     

                     611     

                     612     

                     613     

22EC                 614     ESCINST:  

22EC C2A6            615                     CLR             RW                               

22EE C2A5            616                     CLR     RS               

22F0 D2A7            617                     SETB    E_LCD            

                     618                     

22F2 8880            619                     MOV     P0,R0            

                     620                     

22F4 C2A7            621                     CLR     E_LCD            

                     622                     

22F6 7580FF          623                     MOV             P0,#0xFF                 

                     624                     

22F9 D2A6            625                     SETB    RW                               

22FB D2A7            626                     SETB    E_LCD            

                     627     

22FD 2087FD          628     ESCI1:  JB      BUSYF,ESCI1                      

                     629                     

2300 C2A7            630                     CLR     E_LCD            

                     631             

2302 22              632                     RET

                     633                     

                     634     

                     635     

                     636     

                     637     

                     638     

                     639     

                     640     

                     641     

2303                 642     GOTOXY: 

2303 C0E0            643                     PUSH    ACC

                     644             

2305 7480            645                     MOV     A,#80H

2307 B80102          646             CJNE    R0,#01,GT1       

                     647             

230A 74C0            648                     MOV     A,#0C0H

                     649                     

230C 49              650     GT1:    ORL     A,R1             

230D F8              651             MOV     R0,A

230E 7A01            652             MOV     R2,#01           

                     653             

2310 51EC            654                     CALL    ESCINST          

                     655             

2312 D0E0            656                     POP     ACC

                     657             

2314 22              658                     RET

                     659             

                     660     

                     661     

                     662     

                     663     

                     664     

                     665     

                     666     

                     667     

2315                 668     CLR1L:    

2315 C0E0            669             PUSH   ACC

                     670             

2317 7800            671                     MOV    R0,#00               

2319 7900            672             MOV    R1,#00

                     673             

231B 7103            674                     CALL   GOTOXY

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    12

                     675             

231D 7910            676                     MOV    R1,#16               

                     677     

231F 7420            678     CLR1L1: MOV    A,#' '               

                     679             

2321 7147            680                     CALL   ESCDADO

                     681             

2323 D9FA            682                     DJNZ   R1,CLR1L1

2325 7800            683             MOV    R0,#00               

2327 7900            684             MOV    R1,#00

                     685             

2329 7103            686                     CALL   GOTOXY

                     687             

232B D0E0            688                     POP    ACC

                     689             

232D 22              690                     RET

                     691                     

                     692     

                     693     

                     694     

                     695     

                     696     

                     697     

                     698     

                     699     

232E                 700     CLR2L:    

232E C0E0            701             PUSH   ACC

                     702             

2330 7801            703                     MOV    R0,#01               

2332 7900            704             MOV    R1,#00

                     705             

2334 7103            706                     CALL   GOTOXY

                     707             

2336 7910            708                     MOV    R1,#16               

                     709     

2338 7420            710     CLR2L1: MOV    A,#' '               

                     711             

233A 7147            712                     CALL   ESCDADO

                     713             

233C D9FA            714                     DJNZ   R1,CLR2L1

233E 7801            715             MOV    R0,#01               

2340 7900            716             MOV    R1,#00

                     717             

2342 7103            718                     CALL   GOTOXY

                     719             

2344 D0E0            720                     POP    ACC

                     721             

2346 22              722                     RET

                     723                

                     724     

                     725     

                     726     

                     727     

                     728     

                     729     

                     730     

2347                 731     ESCDADO:  

2347 C2A6            732                     CLR             RW                               

2349 D2A5            733             SETB    RS               

234B D2A7            734             SETB    E_LCD            

                     735                     

234D F580            736             MOV     P0,A             

                     737             

234F C2A7            738                     CLR     E_LCD            

                     739                     

2351 7580FF          740                     MOV             P0,#0xFF                 

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    13

                     741                     

2354 D2A6            742                     SETB    RW                               

2356 C2A5            743                     CLR             RS                               

2358 D2A7            744                     SETB    E_LCD            

                     745     

235A 2087FD          746     ESCD1:  JB              BUSYF,ESCD1              

                     747     

235D C2A7            748                     CLR     E_LCD            

                     749     

235F 22              750             RET

                     751                     

                     752     

                     753     

                     754     

                     755     

                     756     

                     757     

                     758     

                     759     

                     760     

2360                 761     MSTRING:  

2360 E4              762                       CLR    A

2361 93              763               MOVC   A,@A+DPTR       

                     764               

2362 6006            765                       JZ     MSTR1

                     766               

2364 122347          767                       LCALL  ESCDADO         

                     768               

2367 A3              769                       INC    DPTR

                     770               

2368 80F6            771                       SJMP   MSTRING

                     772                       

236A 22              773     MSTR1:    RET

                     774                

                     775     

                     776     

                     777     

                     778     

                     779     

                     780     

                     781     

                     782     

                     783     

236B                 784     MSTRINGX: 

236B E0              785                       MOVX   A,@DPTR         

                     786               

236C 6006            787                       JZ     MSTR21

                     788               

236E 122347          789                       LCALL  ESCDADO         

                     790               

2371 A3              791                       INC    DPTR

                     792               

2372 80F7            793                       SJMP   MSTRINGX

                     794     

2374 22              795     MSTR21:   RET

                     796     

                     797     

                     798     

                     799     

                     800     

                     801     

                     802     

                     803     

                     804     

                     805     

2375                 806     ESC_STR1: 

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    14

                     807                       

2375 7800            808                       MOV    R0,#00         

2377 7900            809               MOV    R1,#00

                     810               

2379 8004            811                       JMP    ESC_S

                     812               

                     813     

                     814     

                     815     

                     816     

                     817     

                     818     

                     819     

                     820     

                     821     

237B                 822     ESC_STR2: 

                     823                       

237B 7801            824                       MOV    R0,#01         

237D 7900            825               MOV    R1,#00

                     826                       

237F 122303          827     ESC_S:    LCALL  GOTOXY          

                     828               

2382 122360          829                       LCALL  MSTRING

                     830               

2385 22              831                       RET

                     832     

                     833     

                     834     

                     835     

                     836     

                     837     

                     838     

                     839     ; DESTROI: R0,R2                                                                        //

                     840     

2386                 841     CUR_ON:   

2386 780F            842                       MOV    R0,#0FH               

2388 8002            843               SJMP   CUR1

                     844                       

238A                 845     CUR_OFF:  

238A 780C            846                       MOV    R0,#0CH               

                     847                       

238C 7A01            848     CUR1:     MOV    R2,#01

                     849               

238E 51EC            850                       CALL   ESCINST               

                     851               

2390 22              852                       RET

                     853                       

                     854     

                     855     

                     856     

                     857                       

2391                 858     TIMER_CONFIGURA_TIMER:

2391 758901          859                     MOV TMOD, #00000001b  

                     860             

2394 22              861                     RET

                     862             

                     863     

                     864     

                     865     

                     866     

                     867     

                     868     

                     869     

2395                 870     TIMER_DELAY_20_MS:

2395 758C56          871                     MOV TH0, #HIGH(65535 - 43350)

2398 758AA9          872                     MOV TL0, #LOW(65535 - 43350)

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    15

                     873             

239B C28D            874                     CLR TF0

239D D28C            875                     SETB TR0

                     876             

239F 308DFD          877                     JNB TF0, $

                     878                     

23A2 C28D            879                     CLR TF0

23A4 C28C            880                     CLR TR0

                     881             

23A6 D8ED            882                     DJNZ R0, TIMER_DELAY_20_MS

                     883             

23A8 22              884                     RET

                     885             

                     886     

                     887     

                     888     

                     889     

                     890     

                     891     

                     892     

23A9                 893     TIMER_DELAY_1_S:

23A9 7832            894                     MOV             R0, #50d

23AB 7195            895                     CALL    TIMER_DELAY_20_MS

                     896                     

23AD D9FA            897                     DJNZ    R1, TIMER_DELAY_1_S

                     898             

23AF 22              899                     RET

                     900     

                     901     

                     902     

                     903     

                     904     

                     905     

                     906     

                     907     

23B0                 908     INT_INT0:

23B0 32              909                     RETI

                     910     

                     911     

                     912     

                     913     

23B1                 914     INT_TIMER0:

23B1 32              915                     RETI

                     916             

                     917     

                     918     

                     919     

23B2                 920     INT_INT1:

23B2 32              921                     RETI

                     922     

                     923     

                     924     

                     925     

23B3                 926     INT_TIMER1:

23B3 32              927                     RETI

                     928             

                     929     

                     930     

                     931     

23B4                 932     INT_SERIAL:

23B4 32              933                     RETI

                     934             

23B5                 935     FIM:

                     936                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    16

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   227FH   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   2278H   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   2180H   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   2315H   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   231FH   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   232EH   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   2338H   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   2166H   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   238CH   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   238AH   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   2386H   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21E7H   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   21C3H   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21C7H   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21CBH   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21CFH   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21D3H   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21D7H   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21DBH   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21DFH   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21E3H   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   235AH   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   2347H   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   22FDH   A   
ESCINST . . . . . . . . . . . . .  C ADDR   22ECH   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   216BH   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   237FH   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   2375H   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   237BH   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23B5H   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   2303H   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21EBH   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   226CH   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   2271H   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   2274H   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   2276H   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   230CH   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22CDH   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23B0H   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23B2H   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23B4H   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23B1H   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23B3H   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   2145H   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   2159H   A   
LE_SENHA_ROM. . . . . . . . . . .  C ADDR   215FH   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    17

LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2127H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   2221H   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   2240H   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   210CH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   236AH   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   2374H   A   
MSTRING . . . . . . . . . . . . .  C ADDR   2360H   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   236BH   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   2175H   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   223FH   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_PRESSIONE_ENTER . . . . . . .  C ADDR   2075H   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2097H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2086H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20CAH   A   
STR_TIMEOUT . . . . . . . . . . .  C ADDR   20DBH   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20B9H   A   
TECLADO . . . . . . . . . . . . .  D ADDR   0090H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21F0H   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   220BH   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   2391H   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   23A9H   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   2395H   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   22A6H   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   218BH   A   
VARRE_ENT . . . . . . . . . . . .  C ADDR   2178H   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20ECH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/04/2017 22:35:27 PAGE    18

