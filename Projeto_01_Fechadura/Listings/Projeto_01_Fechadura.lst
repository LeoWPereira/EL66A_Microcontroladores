A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     1


MACRO ASSEMBLER A51 V8.2.5.0
OBJECT MODULE PLACED IN .\Objects\Projeto_01_Fechadura.obj
ASSEMBLER INVOKED BY: C:\Keil_v5\C51\BIN\A51.EXE Projeto_01_Fechadura.a51 SET(SMALL) DEBUG PRINT(.\Listings\Projeto_01_F
                      echadura.lst) OBJECT(.\Objects\Projeto_01_Fechadura.obj) EP

LOC  OBJ            LINE     SOURCE

                       1     

                       2     

                       3     

                       4     

                       5     

                       6     

                       7     

                       8     

                       9     

                      10     

                      11     

                      12     

                      13     

                      14     

                      15     

                      16     

2000                  17     org 2000h  

2000 0220EC           18     ljmp __STARTUP__

                      19     

2003                  20     org 2003h  

2003 0223BE           21     ljmp INT_INT0

                      22     

200B                  23     org 200Bh  

200B 0223BF           24     ljmp INT_TIMER0

                      25     

2013                  26     org 2013h  

2013 0223C0           27     ljmp INT_INT1

                      28     

201B                  29     org 201Bh  

201B 0223C1           30     ljmp INT_TIMER1

                      31     

2023                  32     org 2023h  

2023 0223C2           33     ljmp INT_SERIAL

                      34     

                      35     

                      36     

                      37     

                      38     

                      39     

  00A5                40     RS                              EQU     P2.5                     

  00A6                41     RW                              EQU     P2.6                     

  00A7                42     E_LCD                   EQU     P2.7                     

                      43     

  0087                44     BUSYF                   EQU     P0.7                     

                      45     

                      46     

  00B6                47     LED_SEG                 EQU     P3.6

  00B7                48     LED1                    EQU     P3.7

                      49             

                      50     

  0090                51     TECLADO                 EQU     P1

                      52     

  0090                53     COL1                    EQU P1.0

  0091                54     COL2                    EQU P1.1

  0092                55     COL3                    EQU P1.2

  0093                56     COL4                    EQU P1.3

                      57     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     2

  0094                58     LIN1                    EQU P1.4

  0095                59     LIN2                    EQU P1.5

  0096                60     LIN3                    EQU P1.6

  0097                61     LIN4                    EQU P1.7

                      62             

                      63     

  00B0                64     BUZZER                  EQU P3.0        

                      65     

                      66     

  00B1                67     ESTADO_UM               EQU P3.1

  00B2                68     ESTADO_DOIS     EQU P3.2

  00B3                69     ESTADO_TRES     EQU P3.3

  00B4                70     ESTADO_QUATRO   EQU P3.4

                      71             

                      72     

  0031                73     TECLADO_1               EQU 31h

  0032                74     TECLADO_2               EQU 32h

  0033                75     TECLADO_3               EQU 33h

  0034                76     TECLADO_4               EQU 34h

                      77     

                      78     

  0035                79     SENHA1_1                EQU 35h

  0036                80     SENHA1_2                EQU 36h

  0037                81     SENHA1_3                EQU 37h

  0038                82     SENHA1_4                EQU 38h

                      83     

  0045                84     SENHA2_1                EQU 45h

  0046                85     SENHA2_2                EQU 46h

  0047                86     SENHA2_3                EQU 47h

  0048                87     SENHA2_4                EQU 48h

                      88     

  0050                89     TENTATIVAS      EQU 50h

                      90                     

                      91     

                      92     

                      93     

                      94     

2030                  95     org 2030h

2030                  96     SENHA_PADRAO_1:

2030 32383132         97                     db      '2812', 00H

2034 00                      
2035                  98     SENHA_PADRAO_2:

2035 30393132         99                     db      '0912', 00H

2039 00                      
203A                 100     STR_LOGO:

203A 2050524F        101             DB      ' PROFS. LINDOS! ',00H

203E 46532E20                
2042 4C494E44                
2046 4F532120                
204A 00                      
204B                 102     STR_LEONARDO_PEREIRA:

204B 4C656F6E        103             DB      'Leonardo Pereira',00H

204F 6172646F                
2053 20506572                
2057 65697261                
205B 00                      
205C                 104     STR_RODRIGO_ENDO:

205C 2020526F        105             DB      '  Rodrigo Endo  ',00H

2060 64726967                
2064 6F20456E                
2068 646F2020                
206C 00                      
206D                 106     STR_SENHA:

206D 53454E48        107             DB      'SENHA: ',00H

2071 413A2000                
2075                 108     STR_PRESSIONE_ENTER:

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     3

2075 50524553        109             DB      'PRESSIONE ENTER ',00H

2079 53494F4E                
207D 4520454E                
2081 54455220                
2085 00                      
2086                 110     STR_SENHA_VALIDA:

2086 20205345        111             DB      '  SENHA VALIDA  ',00H

208A 4E484120                
208E 56414C49                
2092 44412020                
2096 00                      
2097                 112     STR_SENHA_INVALIDA:

2097 2053454E        113             DB      ' SENHA INVALIDA ',00H

209B 48412049                
209F 4E56414C                
20A3 49444120                
20A7 00                      
20A8                 114     STR_LIBERANDO_PORTA:

20A8 4C494245        115             DB      'LIBERANDO PORTA ',00H

20AC 52414E44                
20B0 4F20504F                
20B4 52544120                
20B8 00                      
20B9                 116     STR_TRANCANDO_PORTA:

20B9 5452414E        117             DB      'TRANCANDO PORTA ',00H          

20BD 43414E44                
20C1 4F20504F                
20C5 52544120                
20C9 00                      
20CA                 118     STR_SISTEMA_BLOQUEADO:

20CA 504F5254        119             DB      'PORTA BLOQUEADA ',00H

20CE 4120424C                
20D2 4F515545                
20D6 41444120                
20DA 00                      
20DB                 120     STR_TIMEOUT:

20DB 20202020        121             DB      '    TIMEOUT     ',00H                  

20DF 54494D45                
20E3 4F555420                
20E7 20202020                
20EB 00                      
                     122                     

                     123     

                     124     

                     125     

                     126     

20EC                 127     __STARTUP__:

20EC 719F            128                     CALL    TIMER_CONFIGURA_TIMER

                     129     

20EE 780F            130                     MOV     R0, #0Fh                 

20F0 122286          131                     LCALL   ACIONA_BUZZER

                     132     

20F3 902030          133                     MOV     DPTR, #2030h     

20F6 7800            134                     MOV     R0, #00h             

20F8 7935            135                     MOV     R1, #SENHA1_1    

20FA 7A04            136                     MOV     R2, #04h                 

20FC 315E            137                     CALL    LE_SENHA

                     138             

20FE 902035          139                     MOV     DPTR, #2035h     

2101 7800            140                     MOV     R0, #00h                 

2103 7945            141                     MOV     R1, #SENHA2_1    

2105 7A04            142                     MOV     R2, #04h                 

2107 315E            143                     CALL    LE_SENHA

                     144             

2109 755003          145                     MOV     TENTATIVAS, #3h  

                     146             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     4

210C                 147     MAIN:

210C 51DB            148                     CALL    INIDISP                  

210E 90203A          149                     MOV     DPTR,#STR_LOGO   

2111 7183            150                     CALL    ESC_STR1                 

                     151                     

                     152                     

2113 7901            153                     MOV             R1, #01h

2115 71B7            154                     CALL    TIMER_DELAY_1_S

                     155                     

2117 7123            156                     CALL    CLR1L    

                     157                     

2119 90204B          158                     MOV     DPTR, #STR_LEONARDO_PEREIRA      

211C 7183            159                     CALL    ESC_STR1                                         

                     160                     

211E 90205C          161                     MOV     DPTR, #STR_RODRIGO_ENDO          

2121 7189            162                     CALL    ESC_STR2                                         

                     163                     

                     164                     

2123 7901            165                     MOV             R1, #01h

2125 71B7            166                     CALL    TIMER_DELAY_1_S

                     167     

                     168                     

2127 7123            169                     CALL    CLR1L

2129 713C            170                     CALL    CLR2L

                     171                     

                     172                     

212B 902075          173                     MOV     DPTR,#STR_PRESSIONE_ENTER        

212E 7183            174                     CALL    ESC_STR1                                         

                     175                     

2130 317A            176                     ACALL   PRESS_ENT                

                     177                     

2132 7805            178                     MOV     R0, #05h

2134 122286          179                     LCALL   ACIONA_BUZZER

                     180     

2137                 181     LIMPA_LCD_E_INICIA_SISTEMA:

2137 7123            182                     CALL    CLR1L

                     183                     

                     184                     

2139 90206D          185                     MOV     DPTR,#STR_SENHA  

213C 7183            186                     CALL    ESC_STR1                 

                     187                     

                     188                     

213E 7800            189                     MOV     R0, #00h         

2140 7907            190                     MOV     R1, #07h         

2142 7111            191                     CALL    GOTOXY

                     192                     

2144 7931            193                     MOV     R1, #TECLADO_1   

2146 7B01            194                     MOV     R3, #1h                  

2148 7F04            195                     MOV     R7, #04h                 

214A                 196     LE_4_DIGITOS:

214A 780A            197                     MOV     R0, #0Ah                 

214C 71A3            198                     ACALL   TIMER_DELAY_20_MS

                     199                     

214E 3199            200                     ACALL   VARREDURA_TECLADO        

2150 3170            201                     CALL    ESCREVE_ASTERISCO        

                     202                     

2152 09              203                     INC R1   

2153 0B              204                     INC R3  

                     205                     

2154 DFF4            206                     DJNZ R7, LE_4_DIGITOS  

                     207                     

                     208                     

2156 780A            209                     MOV     R0, #0Ah                 

2158 71A3            210                     ACALL   TIMER_DELAY_20_MS

                     211                     

215A 3183            212                     ACALL   PRESS_ENT_OU_CLR                 

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     5

                     213                     

215C 80D9            214                     JMP             LIMPA_LCD_E_INICIA_SISTEMA

                     215     

                     216     

                     217     

                     218     

                     219     

                     220     

                     221     

                     222     

                     223     

                     224     

                     225     

215E                 226     LE_SENHA:

215E 3164            227                     CALL    LE_SENHA_ROM

                     228             

2160 09              229                     INC     R1

                     230             

2161 DAFB            231                     DJNZ    R2, LE_SENHA

                     232             

2163 22              233                     RET

                     234     

2164                 235     LE_SENHA_ROM:

2164 E8              236                     MOV     A, R0

2165 93              237                     MOVC    A, @A + DPTR

2166 F7              238                     MOV             @R1, A

                     239             

2167 08              240                     INC             R0

                     241             

2168 316B            242                     CALL    CONV_ASCII_TO_NUMBER

                     243             

216A 22              244                     RET

                     245             

                     246     

                     247     

                     248     

                     249     

                     250     

                     251     

                     252     

                     253     

216B                 254     CONV_ASCII_TO_NUMBER:

216B E7              255                     MOV     A, @R1

                     256             

216C 24D0            257                     ADD     A, #-30h

                     258             

216E F7              259                     MOV     @R1, A

                     260             

216F 22              261                     RET

                     262             

                     263     

                     264     

                     265     

                     266     

                     267     

                     268     

                     269     

2170                 270     ESCREVE_ASTERISCO:              

2170 7805            271                     MOV     R0, #05h

2172 122286          272                     LCALL   ACIONA_BUZZER

                     273                     

2175 742A            274                     MOV     A, #2Ah  

2177 7155            275                     CALL    ESCDADO

                     276             

2179 22              277                     RET

                     278     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     6

                     279     

                     280     

                     281     

                     282     

                     283     

                     284     

                     285     

                     286     

217A                 287     PRESS_ENT:

                     288                     

217A 75907F          289                     MOV             TECLADO, #01111111b

                     290                     

217D                 291     VARRE_ENT:

217D 309302          292                     JNB     COL4, CONTINUA_PROG      

                     293                     

2180 80FB            294                     JMP     VARRE_ENT

2182                 295     CONTINUA_PROG:

2182 22              296                     RET

                     297                     

                     298     

                     299     

                     300     

                     301     

                     302     

                     303     

                     304     

                     305     

2183                 306     PRESS_ENT_OU_CLR:

                     307                     

2183 75907F          308                     MOV             TECLADO, #01111111b

                     309                     

2186                 310     VARRE_ENT_OU_CLR:

2186 309105          311                     JNB     COL2, CLEAR                      

2189 309372          312                     JNB     COL4, TESTA_SENHA1       

                     313                     

218C 80F8            314                     JMP     VARRE_ENT_OU_CLR

                     315     

                     316     

                     317     

                     318     

                     319     

                     320     

                     321     

                     322     

                     323     

                     324     

218E                 325     CLEAR: 

218E 7805            326                     MOV     R0, #05h

2190 122286          327                     LCALL   ACIONA_BUZZER

                     328                     

2193 D0E0            329                     POP             ACC

2195 D0E0            330                     POP             ACC

2197 809E            331                     JMP     LIMPA_LCD_E_INICIA_SISTEMA

                     332                     

                     333     

                     334     

                     335     

                     336     

                     337     

                     338     

                     339     

2199                 340     VARREDURA_TECLADO:

2199 C294            341                     CLR  LIN1

219B D295            342                     SETB LIN2

219D D296            343                     SETB LIN3

219F D297            344                     SETB LIN4

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     7

21A1 30912D          345                     JNB  COL2, DIGITO1

21A4 30922E          346                     JNB  COL3, DIGITO2

21A7 30932F          347                     JNB  COL4, DIGITO3

                     348                     

21AA C295            349                     CLR  LIN2

21AC D294            350                     SETB LIN1

21AE 30912C          351                     JNB  COL2, DIGITO4

21B1 30922D          352                     JNB  COL3, DIGITO5

21B4 30932E          353                     JNB  COL4, DIGITO6

                     354                     

21B7 C296            355                     CLR  LIN3

21B9 D295            356                     SETB LIN2

21BB 30912B          357                     JNB  COL2, DIGITO7

21BE 30922C          358                     JNB  COL3, DIGITO8

21C1 30932D          359                     JNB  COL4, DIGITO9

                     360                     

21C4 C297            361                     CLR  LIN4

21C6 D296            362                     SETB LIN3

21C8 3091C3          363                     JNB  COL2, CLEAR

21CB 309227          364                     JNB  COL3, DIGITO0

21CE 80C9            365                     JMP  VARREDURA_TECLADO

                     366                     

21D0 22              367                     RET

                     368                     

                     369     

                     370     

                     371     

                     372     

                     373     

                     374     

                     375     

                     376     

21D1 7401            377     DIGITO1: MOV A, #1h

21D3 21F9            378                      AJMP GRAVA_DIGITO

21D5 7402            379     DIGITO2: MOV A, #2h

21D7 21F9            380                      AJMP GRAVA_DIGITO

21D9 7403            381     DIGITO3: MOV A, #3h

21DB 21F9            382                      AJMP GRAVA_DIGITO

21DD 7404            383     DIGITO4: MOV A, #4h

21DF 21F9            384                      AJMP GRAVA_DIGITO

21E1 7405            385     DIGITO5: MOV A, #5h

21E3 21F9            386                      AJMP GRAVA_DIGITO

21E5 7406            387     DIGITO6: MOV A, #6h

21E7 21F9            388                      AJMP GRAVA_DIGITO

21E9 7407            389     DIGITO7: MOV A, #7h

21EB 21F9            390                      AJMP GRAVA_DIGITO

21ED 7408            391     DIGITO8: MOV A, #8h

21EF 21F9            392                      AJMP GRAVA_DIGITO

21F1 7409            393     DIGITO9: MOV A, #9h

21F3 21F9            394                      AJMP GRAVA_DIGITO

21F5 7400            395     DIGITO0: MOV A, #0h

21F7 21F9            396                      AJMP GRAVA_DIGITO

                     397                      

21F9                 398     GRAVA_DIGITO:

21F9 BB017E          399                     CJNE R3, #1h, GRAVA_TECLADO_2

21FC F7              400                     MOV @R1, A

                     401             

21FD 22              402                     RET

                     403     

                     404     

                     405     

                     406     

                     407     

                     408     

                     409     

                     410     

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     8

                     411     

21FE                 412     TESTA_SENHA1:

21FE 7805            413                     MOV     R0, #05h

2200 122286          414                     LCALL   ACIONA_BUZZER

                     415                     

2203 E535            416                     MOV             A, SENHA1_1

2205 B53111          417                     CJNE    A, TECLADO_1, TESTA_SENHA2

2208 E536            418                     MOV             A, SENHA1_2

220A B5320C          419                     CJNE    A, TECLADO_2, TESTA_SENHA2

220D E537            420                     MOV             A, SENHA1_3

220F B53307          421                     CJNE    A, TECLADO_3, TESTA_SENHA2

2212 E538            422                     MOV             A, SENHA1_4

2214 B53402          423                     CJNE    A, TECLADO_4, TESTA_SENHA2

2217 8035            424                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     425             

2219                 426     TESTA_SENHA2:

2219 E545            427                     MOV             A, SENHA2_1

221B B53111          428                     CJNE    A, TECLADO_1, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

221E E546            429                     MOV             A, SENHA2_2

2220 B5320C          430                     CJNE    A, TECLADO_2, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2223 E547            431                     MOV             A, SENHA2_3

2225 B53307          432                     CJNE    A, TECLADO_3, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

2228 E548            433                     MOV             A, SENHA2_4

222A B53402          434                     CJNE    A, TECLADO_4, LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA

222D 801F            435                     JMP     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA

                     436                     

222F                 437     LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA:

                     438                     

222F 7123            439                     CALL    CLR1L

2231 713C            440                     CALL    CLR2L

                     441                     

2233 902097          442                     MOV     DPTR,#STR_SENHA_INVALIDA         

2236 7183            443                     CALL    ESC_STR1                                         

                     444                     

                     445                     

2238 7864            446                     MOV     R0, #064h

223A 122286          447                     LCALL   ACIONA_BUZZER

                     448                     

                     449                     

223D 7901            450                     MOV             R1, #01h

223F 71B7            451                     CALL    TIMER_DELAY_1_S

                     452                     

2241 D55009          453                     DJNZ    TENTATIVAS, REINICIA_SISTEMA

                     454                     

2244 7123            455                     CALL    CLR1L

2246 9020CA          456                     MOV     DPTR,#STR_SISTEMA_BLOQUEADO      

2249 7183            457                     CALL    ESC_STR1                                         

                     458                     

224B 61C3            459                     JMP     FIM

                     460     

224D                 461     REINICIA_SISTEMA:

224D 22              462                     RET

                     463                     

224E                 464     LIMPA_LCD_E_MOSTRA_SENHA_VALIDA:

224E 755003          465                     MOV     TENTATIVAS, #3h  

                     466                     

                     467                     

2251 7123            468                     CALL    CLR1L

2253 713C            469                     CALL    CLR2L

                     470                     

2255 902086          471                     MOV     DPTR,#STR_SENHA_VALIDA   

2258 7183            472                     CALL    ESC_STR1                                 

                     473                     

                     474                     

225A 7832            475                     MOV     R0, #032h

225C 122286          476                     LCALL   ACIONA_BUZZER

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE     9

                     477                     

225F 9020A8          478                     MOV     DPTR, #STR_LIBERANDO_PORTA       

2262 7189            479                     CALL    ESC_STR2                                         

                     480                     

                     481                     

2264 7D1A            482                     MOV     R5, #1Ah

2266 12228D          483                     LCALL   ABRE_FECHADURA

                     484                     

                     485                     

2269 7903            486                     MOV             R1, #03h

226B 71B7            487                     CALL    TIMER_DELAY_1_S

                     488                     

226D 713C            489                     CALL    CLR2L                                            

226F 9020B9          490                     MOV     DPTR, #STR_TRANCANDO_PORTA       

2272 7189            491                     CALL    ESC_STR2                                         

                     492                     

                     493                     

2274 7D1A            494                     MOV     R5, #1Ah

2276 1222B4          495                     LCALL   TRANCA_FECHADURA

                     496                     

2279 22              497                     RET

                     498                      

                     499     

                     500     

                     501     

                     502     

                     503     

                     504     

                     505     

227A BB0202          506     GRAVA_TECLADO_2: CJNE R3, #2h, GRAVA_TECLADO_3

227D 4184            507                                      AJMP GRAVA_TECLADO_X

227F BB0300          508     GRAVA_TECLADO_3: CJNE R3, #3h, GRAVA_TECLADO_4

2282 4184            509     GRAVA_TECLADO_4: AJMP GRAVA_TECLADO_X           

                     510     

2284                 511     GRAVA_TECLADO_X:

2284 F7              512                      MOV @R1, A

                     513                      

2285 22              514                      RET

                     515                      

                     516     

                     517     

                     518     

                     519     

2286                 520     ACIONA_BUZZER:

2286 D2B0            521                     SETB    BUZZER

2288 71A3            522                     ACALL   TIMER_DELAY_20_MS

228A C2B0            523                     CLR     BUZZER

                     524                     

228C 22              525                     RET

                     526                     

                     527     

                     528     

                     529     

228D                 530     ABRE_FECHADURA:

228D D2B1            531                     SETB    ESTADO_UM

228F C2B2            532                     CLR             ESTADO_DOIS

2291 C2B3            533                     CLR             ESTADO_TRES

2293 C2B4            534                     CLR             ESTADO_QUATRO

                     535                     

2295 7805            536                     MOV     R0, #05h

2297 71A3            537                     ACALL   TIMER_DELAY_20_MS

                     538                     

2299 C2B1            539                     CLR             ESTADO_UM

229B D2B2            540                     SETB    ESTADO_DOIS

                     541                     

229D 7805            542                     MOV     R0, #05h

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    10

229F 71A3            543                     ACALL   TIMER_DELAY_20_MS

                     544                     

22A1 C2B2            545                     CLR             ESTADO_DOIS

22A3 D2B3            546                     SETB    ESTADO_TRES

                     547                     

22A5 7805            548                     MOV     R0, #05h

22A7 71A3            549                     ACALL   TIMER_DELAY_20_MS

                     550                     

22A9 C2B3            551                     CLR             ESTADO_TRES

22AB D2B4            552                     SETB    ESTADO_QUATRO

                     553                     

22AD 7805            554                     MOV     R0, #05h

22AF 71A3            555                     ACALL   TIMER_DELAY_20_MS

                     556                     

22B1 DDDA            557                     DJNZ    R5, ABRE_FECHADURA

                     558                     

22B3 22              559                     RET

                     560                     

22B4                 561     TRANCA_FECHADURA:

22B4 C2B1            562                     CLR             ESTADO_UM

22B6 C2B2            563                     CLR             ESTADO_DOIS

22B8 C2B3            564                     CLR             ESTADO_TRES

22BA D2B4            565                     SETB    ESTADO_QUATRO

                     566                     

22BC 7805            567                     MOV     R0, #05h

22BE 71A3            568                     ACALL   TIMER_DELAY_20_MS

                     569                     

22C0 D2B3            570                     SETB    ESTADO_TRES

22C2 C2B4            571                     CLR             ESTADO_QUATRO

                     572                     

22C4 7805            573                     MOV     R0, #05h

22C6 71A3            574                     ACALL   TIMER_DELAY_20_MS

                     575                     

22C8 D2B2            576                     SETB    ESTADO_DOIS

22CA C2B3            577                     CLR             ESTADO_TRES

                     578                     

22CC 7805            579                     MOV     R0, #05h

22CE 71A3            580                     ACALL   TIMER_DELAY_20_MS

                     581                     

22D0 D2B1            582                     SETB    ESTADO_UM

22D2 C2B2            583                     CLR             ESTADO_DOIS

                     584                     

22D4 7805            585                     MOV     R0, #05h

22D6 71A3            586                     ACALL   TIMER_DELAY_20_MS

                     587                     

22D8 DDDA            588                     DJNZ    R5, TRANCA_FECHADURA

                     589     

22DA 22              590                     RET

                     591     

                     592     

                     593     

                     594             

                     595     

                     596     

                     597     

                     598     

                     599     

                     600     

                     601     

                     602     

                     603     

22DB                 604     INIDISP:                       

22DB 7838            605             MOV     R0,#38H          

22DD 7A05            606             MOV     R2,#05           

22DF 51FA            607             CALL    ESCINST          

                     608             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    11

22E1 7838            609                     MOV     R0,#38H          

22E3 7A01            610             MOV     R2,#01           

22E5 51FA            611             CALL    ESCINST          

                     612             

22E7 7806            613                     MOV     R0,#06H          

22E9 7A01            614             MOV     R2,#01           

22EB 51FA            615             CALL    ESCINST          

                     616             

22ED 780C            617                     MOV     R0,#0CH          

22EF 7A01            618             MOV     R2,#01           

22F1 51FA            619             CALL    ESCINST          

                     620             

22F3 7801            621                     MOV     R0,#01H          

22F5 7A02            622             MOV     R2,#02           

22F7 51FA            623             CALL    ESCINST          

                     624             

22F9 22              625                     RET

                     626                     

                     627     

                     628     

                     629     

                     630     

                     631     

                     632     

                     633     

                     634     

                     635     

22FA                 636     ESCINST:  

22FA C2A6            637                     CLR             RW                               

22FC C2A5            638                     CLR     RS               

22FE D2A7            639                     SETB    E_LCD            

                     640                     

2300 8880            641                     MOV     P0,R0            

                     642                     

2302 C2A7            643                     CLR     E_LCD            

                     644                     

2304 7580FF          645                     MOV             P0,#0xFF                 

                     646                     

2307 D2A6            647                     SETB    RW                               

2309 D2A7            648                     SETB    E_LCD            

                     649     

230B 2087FD          650     ESCI1:  JB      BUSYF,ESCI1                      

                     651                     

230E C2A7            652                     CLR     E_LCD            

                     653             

2310 22              654                     RET

                     655                     

                     656     

                     657     

                     658     

                     659     

                     660     

                     661     

                     662     

                     663     

2311                 664     GOTOXY: 

2311 C0E0            665                     PUSH    ACC

                     666             

2313 7480            667                     MOV     A,#80H

2315 B80102          668             CJNE    R0,#01,GT1       

                     669             

2318 74C0            670                     MOV     A,#0C0H

                     671                     

231A 49              672     GT1:    ORL     A,R1             

231B F8              673             MOV     R0,A

231C 7A01            674             MOV     R2,#01           

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    12

                     675             

231E 51FA            676                     CALL    ESCINST          

                     677             

2320 D0E0            678                     POP     ACC

                     679             

2322 22              680                     RET

                     681             

                     682     

                     683     

                     684     

                     685     

                     686     

                     687     

                     688     

                     689     

2323                 690     CLR1L:    

2323 C0E0            691             PUSH   ACC

                     692             

2325 7800            693                     MOV    R0,#00               

2327 7900            694             MOV    R1,#00

                     695             

2329 7111            696                     CALL   GOTOXY

                     697             

232B 7910            698                     MOV    R1,#16               

                     699     

232D 7420            700     CLR1L1: MOV    A,#' '               

                     701             

232F 7155            702                     CALL   ESCDADO

                     703             

2331 D9FA            704                     DJNZ   R1,CLR1L1

2333 7800            705             MOV    R0,#00               

2335 7900            706             MOV    R1,#00

                     707             

2337 7111            708                     CALL   GOTOXY

                     709             

2339 D0E0            710                     POP    ACC

                     711             

233B 22              712                     RET

                     713                     

                     714     

                     715     

                     716     

                     717     

                     718     

                     719     

                     720     

                     721     

233C                 722     CLR2L:    

233C C0E0            723             PUSH   ACC

                     724             

233E 7801            725                     MOV    R0,#01               

2340 7900            726             MOV    R1,#00

                     727             

2342 7111            728                     CALL   GOTOXY

                     729             

2344 7910            730                     MOV    R1,#16               

                     731     

2346 7420            732     CLR2L1: MOV    A,#' '               

                     733             

2348 7155            734                     CALL   ESCDADO

                     735             

234A D9FA            736                     DJNZ   R1,CLR2L1

234C 7801            737             MOV    R0,#01               

234E 7900            738             MOV    R1,#00

                     739             

2350 7111            740                     CALL   GOTOXY

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    13

                     741             

2352 D0E0            742                     POP    ACC

                     743             

2354 22              744                     RET

                     745                

                     746     

                     747     

                     748     

                     749     

                     750     

                     751     

                     752     

2355                 753     ESCDADO:  

2355 C2A6            754                     CLR             RW                               

2357 D2A5            755             SETB    RS               

2359 D2A7            756             SETB    E_LCD            

                     757                     

235B F580            758             MOV     P0,A             

                     759             

235D C2A7            760                     CLR     E_LCD            

                     761                     

235F 7580FF          762                     MOV             P0,#0xFF                 

                     763                     

2362 D2A6            764                     SETB    RW                               

2364 C2A5            765                     CLR             RS                               

2366 D2A7            766                     SETB    E_LCD            

                     767     

2368 2087FD          768     ESCD1:  JB              BUSYF,ESCD1              

                     769     

236B C2A7            770                     CLR     E_LCD            

                     771     

236D 22              772             RET

                     773                     

                     774     

                     775     

                     776     

                     777     

                     778     

                     779     

                     780     

                     781     

                     782     

236E                 783     MSTRING:  

236E E4              784                       CLR    A

236F 93              785               MOVC   A,@A+DPTR       

                     786               

2370 6006            787                       JZ     MSTR1

                     788               

2372 122355          789                       LCALL  ESCDADO         

                     790               

2375 A3              791                       INC    DPTR

                     792               

2376 80F6            793                       SJMP   MSTRING

                     794                       

2378 22              795     MSTR1:    RET

                     796                

                     797     

                     798     

                     799     

                     800     

                     801     

                     802     

                     803     

                     804     

                     805     

2379                 806     MSTRINGX: 

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    14

2379 E0              807                       MOVX   A,@DPTR         

                     808               

237A 6006            809                       JZ     MSTR21

                     810               

237C 122355          811                       LCALL  ESCDADO         

                     812               

237F A3              813                       INC    DPTR

                     814               

2380 80F7            815                       SJMP   MSTRINGX

                     816     

2382 22              817     MSTR21:   RET

                     818     

                     819     

                     820     

                     821     

                     822     

                     823     

                     824     

                     825     

                     826     

                     827     

2383                 828     ESC_STR1: 

                     829                       

2383 7800            830                       MOV    R0,#00         

2385 7900            831               MOV    R1,#00

                     832               

2387 8004            833                       JMP    ESC_S

                     834               

                     835     

                     836     

                     837     

                     838     

                     839     

                     840     

                     841     

                     842     

                     843     

2389                 844     ESC_STR2: 

                     845                       

2389 7801            846                       MOV    R0,#01         

238B 7900            847               MOV    R1,#00

                     848                       

238D 122311          849     ESC_S:    LCALL  GOTOXY          

                     850               

2390 12236E          851                       LCALL  MSTRING

                     852               

2393 22              853                       RET

                     854     

                     855     

                     856     

                     857     

                     858     

                     859     

                     860     

                     861     ; DESTROI: R0,R2                                                                        //

                     862     

2394                 863     CUR_ON:   

2394 780F            864                       MOV    R0,#0FH               

2396 8002            865               SJMP   CUR1

                     866                       

2398                 867     CUR_OFF:  

2398 780C            868                       MOV    R0,#0CH               

                     869                       

239A 7A01            870     CUR1:     MOV    R2,#01

                     871               

239C 51FA            872                       CALL   ESCINST               

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    15

                     873               

239E 22              874                       RET

                     875                       

                     876     

                     877     

                     878     

                     879                       

239F                 880     TIMER_CONFIGURA_TIMER:

239F 758901          881                     MOV TMOD, #00000001b  

                     882             

23A2 22              883                     RET

                     884             

                     885     

                     886     

                     887     

                     888     

                     889     

                     890     

                     891     

23A3                 892     TIMER_DELAY_20_MS:

23A3 758C56          893                     MOV TH0, #HIGH(65535 - 43350)

23A6 758AA9          894                     MOV TL0, #LOW(65535 - 43350)

                     895             

23A9 C28D            896                     CLR TF0

23AB D28C            897                     SETB TR0

                     898             

23AD 308DFD          899                     JNB TF0, $

                     900                     

23B0 C28D            901                     CLR TF0

23B2 C28C            902                     CLR TR0

                     903             

23B4 D8ED            904                     DJNZ R0, TIMER_DELAY_20_MS

                     905             

23B6 22              906                     RET

                     907             

                     908     

                     909     

                     910     

                     911     

                     912     

                     913     

                     914     

23B7                 915     TIMER_DELAY_1_S:

23B7 7832            916                     MOV             R0, #50d

23B9 71A3            917                     CALL    TIMER_DELAY_20_MS

                     918                     

23BB D9FA            919                     DJNZ    R1, TIMER_DELAY_1_S

                     920             

23BD 22              921                     RET

                     922     

                     923     

                     924     

                     925     

                     926     

                     927     

                     928     

                     929     

23BE                 930     INT_INT0:

23BE 32              931                     RETI

                     932     

                     933     

                     934     

                     935     

23BF                 936     INT_TIMER0:

23BF 32              937                     RETI

                     938             

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    16

                     939     

                     940     

                     941     

23C0                 942     INT_INT1:

23C0 32              943                     RETI

                     944     

                     945     

                     946     

                     947     

23C1                 948     INT_TIMER1:

23C1 32              949                     RETI

                     950             

                     951     

                     952     

                     953     

23C2                 954     INT_SERIAL:

23C2 32              955                     RETI

                     956             

23C3                 957     FIM:

23C3 80FE            958                     JMP $

                     959                     END

A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    17

SYMBOL TABLE LISTING
------ ----- -------


N A M E                            T Y P E  V A L U E   ATTRIBUTES

ABRE_FECHADURA. . . . . . . . . .  C ADDR   228DH   A   
ACC . . . . . . . . . . . . . . .  D ADDR   00E0H   A   
ACIONA_BUZZER . . . . . . . . . .  C ADDR   2286H   A   
BUSYF . . . . . . . . . . . . . .  B ADDR   0080H.7 A   
BUZZER. . . . . . . . . . . . . .  B ADDR   00B0H.0 A   
CLEAR . . . . . . . . . . . . . .  C ADDR   218EH   A   
CLR1L . . . . . . . . . . . . . .  C ADDR   2323H   A   
CLR1L1. . . . . . . . . . . . . .  C ADDR   232DH   A   
CLR2L . . . . . . . . . . . . . .  C ADDR   233CH   A   
CLR2L1. . . . . . . . . . . . . .  C ADDR   2346H   A   
COL1. . . . . . . . . . . . . . .  B ADDR   0090H.0 A   
COL2. . . . . . . . . . . . . . .  B ADDR   0090H.1 A   
COL3. . . . . . . . . . . . . . .  B ADDR   0090H.2 A   
COL4. . . . . . . . . . . . . . .  B ADDR   0090H.3 A   
CONTINUA_PROG . . . . . . . . . .  C ADDR   2182H   A   
CONV_ASCII_TO_NUMBER. . . . . . .  C ADDR   216BH   A   
CUR1. . . . . . . . . . . . . . .  C ADDR   239AH   A   
CUR_OFF . . . . . . . . . . . . .  C ADDR   2398H   A   
CUR_ON. . . . . . . . . . . . . .  C ADDR   2394H   A   
DIGITO0 . . . . . . . . . . . . .  C ADDR   21F5H   A   
DIGITO1 . . . . . . . . . . . . .  C ADDR   21D1H   A   
DIGITO2 . . . . . . . . . . . . .  C ADDR   21D5H   A   
DIGITO3 . . . . . . . . . . . . .  C ADDR   21D9H   A   
DIGITO4 . . . . . . . . . . . . .  C ADDR   21DDH   A   
DIGITO5 . . . . . . . . . . . . .  C ADDR   21E1H   A   
DIGITO6 . . . . . . . . . . . . .  C ADDR   21E5H   A   
DIGITO7 . . . . . . . . . . . . .  C ADDR   21E9H   A   
DIGITO8 . . . . . . . . . . . . .  C ADDR   21EDH   A   
DIGITO9 . . . . . . . . . . . . .  C ADDR   21F1H   A   
ESCD1 . . . . . . . . . . . . . .  C ADDR   2368H   A   
ESCDADO . . . . . . . . . . . . .  C ADDR   2355H   A   
ESCI1 . . . . . . . . . . . . . .  C ADDR   230BH   A   
ESCINST . . . . . . . . . . . . .  C ADDR   22FAH   A   
ESCREVE_ASTERISCO . . . . . . . .  C ADDR   2170H   A   
ESC_S . . . . . . . . . . . . . .  C ADDR   238DH   A   
ESC_STR1. . . . . . . . . . . . .  C ADDR   2383H   A   
ESC_STR2. . . . . . . . . . . . .  C ADDR   2389H   A   
ESTADO_DOIS . . . . . . . . . . .  B ADDR   00B0H.2 A   
ESTADO_QUATRO . . . . . . . . . .  B ADDR   00B0H.4 A   
ESTADO_TRES . . . . . . . . . . .  B ADDR   00B0H.3 A   
ESTADO_UM . . . . . . . . . . . .  B ADDR   00B0H.1 A   
E_LCD . . . . . . . . . . . . . .  B ADDR   00A0H.7 A   
FIM . . . . . . . . . . . . . . .  C ADDR   23C3H   A   
GOTOXY. . . . . . . . . . . . . .  C ADDR   2311H   A   
GRAVA_DIGITO. . . . . . . . . . .  C ADDR   21F9H   A   
GRAVA_TECLADO_2 . . . . . . . . .  C ADDR   227AH   A   
GRAVA_TECLADO_3 . . . . . . . . .  C ADDR   227FH   A   
GRAVA_TECLADO_4 . . . . . . . . .  C ADDR   2282H   A   
GRAVA_TECLADO_X . . . . . . . . .  C ADDR   2284H   A   
GT1 . . . . . . . . . . . . . . .  C ADDR   231AH   A   
INIDISP . . . . . . . . . . . . .  C ADDR   22DBH   A   
INT_INT0. . . . . . . . . . . . .  C ADDR   23BEH   A   
INT_INT1. . . . . . . . . . . . .  C ADDR   23C0H   A   
INT_SERIAL. . . . . . . . . . . .  C ADDR   23C2H   A   
INT_TIMER0. . . . . . . . . . . .  C ADDR   23BFH   A   
INT_TIMER1. . . . . . . . . . . .  C ADDR   23C1H   A   
LED1. . . . . . . . . . . . . . .  B ADDR   00B0H.7 A   
LED_SEG . . . . . . . . . . . . .  B ADDR   00B0H.6 A   
LE_4_DIGITOS. . . . . . . . . . .  C ADDR   214AH   A   
LE_SENHA. . . . . . . . . . . . .  C ADDR   215EH   A   
A51 MACRO ASSEMBLER  PROJETO_01_FECHADURA                                                 04/05/2017 20:23:33 PAGE    18

LE_SENHA_ROM. . . . . . . . . . .  C ADDR   2164H   A   
LIMPA_LCD_E_INICIA_SISTEMA. . . .  C ADDR   2137H   A   
LIMPA_LCD_E_MOSTRA_SENHA_INVALIDA  C ADDR   222FH   A   
LIMPA_LCD_E_MOSTRA_SENHA_VALIDA .  C ADDR   224EH   A   
LIN1. . . . . . . . . . . . . . .  B ADDR   0090H.4 A   
LIN2. . . . . . . . . . . . . . .  B ADDR   0090H.5 A   
LIN3. . . . . . . . . . . . . . .  B ADDR   0090H.6 A   
LIN4. . . . . . . . . . . . . . .  B ADDR   0090H.7 A   
MAIN. . . . . . . . . . . . . . .  C ADDR   210CH   A   
MSTR1 . . . . . . . . . . . . . .  C ADDR   2378H   A   
MSTR21. . . . . . . . . . . . . .  C ADDR   2382H   A   
MSTRING . . . . . . . . . . . . .  C ADDR   236EH   A   
MSTRINGX. . . . . . . . . . . . .  C ADDR   2379H   A   
P0. . . . . . . . . . . . . . . .  D ADDR   0080H   A   
P1. . . . . . . . . . . . . . . .  D ADDR   0090H   A   
P2. . . . . . . . . . . . . . . .  D ADDR   00A0H   A   
P3. . . . . . . . . . . . . . . .  D ADDR   00B0H   A   
PRESS_ENT . . . . . . . . . . . .  C ADDR   217AH   A   
PRESS_ENT_OU_CLR. . . . . . . . .  C ADDR   2183H   A   
REINICIA_SISTEMA. . . . . . . . .  C ADDR   224DH   A   
RS. . . . . . . . . . . . . . . .  B ADDR   00A0H.5 A   
RW. . . . . . . . . . . . . . . .  B ADDR   00A0H.6 A   
SENHA1_1. . . . . . . . . . . . .  N NUMB   0035H   A   
SENHA1_2. . . . . . . . . . . . .  N NUMB   0036H   A   
SENHA1_3. . . . . . . . . . . . .  N NUMB   0037H   A   
SENHA1_4. . . . . . . . . . . . .  N NUMB   0038H   A   
SENHA2_1. . . . . . . . . . . . .  N NUMB   0045H   A   
SENHA2_2. . . . . . . . . . . . .  N NUMB   0046H   A   
SENHA2_3. . . . . . . . . . . . .  N NUMB   0047H   A   
SENHA2_4. . . . . . . . . . . . .  N NUMB   0048H   A   
SENHA_PADRAO_1. . . . . . . . . .  C ADDR   2030H   A   
SENHA_PADRAO_2. . . . . . . . . .  C ADDR   2035H   A   
STR_LEONARDO_PEREIRA. . . . . . .  C ADDR   204BH   A   
STR_LIBERANDO_PORTA . . . . . . .  C ADDR   20A8H   A   
STR_LOGO. . . . . . . . . . . . .  C ADDR   203AH   A   
STR_PRESSIONE_ENTER . . . . . . .  C ADDR   2075H   A   
STR_RODRIGO_ENDO. . . . . . . . .  C ADDR   205CH   A   
STR_SENHA . . . . . . . . . . . .  C ADDR   206DH   A   
STR_SENHA_INVALIDA. . . . . . . .  C ADDR   2097H   A   
STR_SENHA_VALIDA. . . . . . . . .  C ADDR   2086H   A   
STR_SISTEMA_BLOQUEADO . . . . . .  C ADDR   20CAH   A   
STR_TIMEOUT . . . . . . . . . . .  C ADDR   20DBH   A   
STR_TRANCANDO_PORTA . . . . . . .  C ADDR   20B9H   A   
TECLADO . . . . . . . . . . . . .  D ADDR   0090H   A   
TECLADO_1 . . . . . . . . . . . .  N NUMB   0031H   A   
TECLADO_2 . . . . . . . . . . . .  N NUMB   0032H   A   
TECLADO_3 . . . . . . . . . . . .  N NUMB   0033H   A   
TECLADO_4 . . . . . . . . . . . .  N NUMB   0034H   A   
TENTATIVAS. . . . . . . . . . . .  N NUMB   0050H   A   
TESTA_SENHA1. . . . . . . . . . .  C ADDR   21FEH   A   
TESTA_SENHA2. . . . . . . . . . .  C ADDR   2219H   A   
TF0 . . . . . . . . . . . . . . .  B ADDR   0088H.5 A   
TH0 . . . . . . . . . . . . . . .  D ADDR   008CH   A   
TIMER_CONFIGURA_TIMER . . . . . .  C ADDR   239FH   A   
TIMER_DELAY_1_S . . . . . . . . .  C ADDR   23B7H   A   
TIMER_DELAY_20_MS . . . . . . . .  C ADDR   23A3H   A   
TL0 . . . . . . . . . . . . . . .  D ADDR   008AH   A   
TMOD. . . . . . . . . . . . . . .  D ADDR   0089H   A   
TR0 . . . . . . . . . . . . . . .  B ADDR   0088H.4 A   
TRANCA_FECHADURA. . . . . . . . .  C ADDR   22B4H   A   
VARREDURA_TECLADO . . . . . . . .  C ADDR   2199H   A   
VARRE_ENT . . . . . . . . . . . .  C ADDR   217DH   A   
VARRE_ENT_OU_CLR. . . . . . . . .  C ADDR   2186H   A   
__STARTUP__ . . . . . . . . . . .  C ADDR   20ECH   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
